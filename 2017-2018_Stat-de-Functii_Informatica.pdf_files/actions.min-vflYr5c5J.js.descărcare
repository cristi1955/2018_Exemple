define(["require","exports","modules/clean/react/file_sidebar/store/file_activity/selectors","modules/clean/react/file_sidebar/store/file_activity/api","modules/clean/react/file_sidebar/file_sidebar_logger","modules/clean/react/file_sidebar/store/pass_adapter"],function(e,t,i,r,n,I){"use strict";function a(e){return{type:"FILE_ACTIVITY|RECEIVE_STREAM_ERROR",error:e}}function c(e){return{type:"FILE_ACTIVITY|RECEIVE_VIEW_ACTIVITY_ERROR",error:e}}function o(e,t){return{type:"FILE_ACTIVITY|RECEIVE_FILE_ACTIVITY",streamActivities:e,enabled:t}}function u(e){return{type:"FILE_ACTIVITY|RECEIVE_VIEW_ACTIVITY",viewActivities:e}}function E(e){var t=e.file,r=e.userId,n=e.data;return function(e,I){var a=I();if(!V({file:t,userId:r},i.getContext(a))){(i.getState(a).viewActivities.loading&&n.isFinished||n.error)&&(e(n.error?c(n.error):u(n.value)),e(s()))}}}function f(e,t){return{type:"FILE_ACTIVITY|LOADING_START",userId:e,file:t}}function _(e){return{type:"FILE_ACTIVITY|LOADING_END",state:e}}function d(){return{type:"FILE_ACTIVITY|VIEW_ACTIVITIES_LOADING_START"}}function s(){return{type:"FILE_ACTIVITY|VIEW_ACTIVITIES_LOADING_END"}}function T(){return{type:"FILE_ACTIVITY|RESET"}}function l(){return{type:"FILE_ACTIVITY|RESET_FILE_STATE"}}function A(){return{type:"FILE_ACTIVITY|FEEDBACK_SENT"}}function v(){return{type:"FILE_ACTIVITY|HIDE_FEEDBACK"}}function V(e,t){return(e.file?e.file.file_id:-1)!==(t.file?t.file.file_id:-1)||e.userId!==t.userId}function C(e,r){return function(c,u){if(V({file:r,userId:e},i.getContext(u()))){var s=t.api.create(e);c(l()),c(f(e,r)),c(d()),c(E(I.getViewActivities(e,r)));var T=Date.now(),A=++F,v=r.file_id;return s.getActivityStream(v).then(function(t){var I=t.enabled,a=t.activity;n.logGetActivityStreamTiming(Date.now()-T,!0),V({file:r,userId:e},i.getContext(u()))||c(o(a,I))}).catch(function(e){n.logGetActivityStreamTiming(Date.now()-T,!1),A===F&&c(a(e))}).then(function(){A===F&&c(_(i.getState(u())))})}}}function y(e,r,n,I){return function(a,c){var o=c(),u=i.getUserId(o);t.api.create(u).sendFeedback(e,r,n.id,I.id,n.file.ns_id,n.file.sjid),a(A()),setTimeout(function(){a(v())},5e3)}}Object.defineProperty(t,"__esModule",{value:!0});t.api={create:function(e){return new r.FileActivityStreamApi(e)}},t.receiveStreamError=a,t.receiveViewActivityError=c,t.receiveFileActivity=o,t.receiveViewActivity=u,t.handleDataFromPassStore=E,t.loadingStart=f,t.loadingEnd=_,t.viewActivitiesLoadingStart=d,t.viewActivitiesLoadingEnd=s,t.reset=T,t.resetFileState=l,t.feedbackSent=A,t.hideFeedback=v;var F=0;t.getActivityStream=C,t.sendFeedback=y});
//# sourceMappingURL=actions.min.js-vflXQIdAK.map