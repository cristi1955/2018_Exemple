define(["require","exports","tslib","modules/clean/react/file_sidebar/store/file_activity/activity_sorted_set","modules/constants/file_activity_stream","modules/clean/react/file_sidebar/store/file_activity/coalesce"],function(e,i,t,s,a,r){"use strict";function _(e){return e.filter(function(e){switch(e.type){case"file_settings_change":return a.IS_FILE_SETTINGS_CHANGE_CARD_ON;case"shared_link_change":return a.IS_SHARED_LINK_CHANGE_CARD_ON;case"view":return a.IS_VIEW_CARD_ON;default:return!0}})}function c(e,a){switch(void 0===e&&(e=i.INITIAL_STATE),a.type){case"FILE_ACTIVITY|RESET":return t.__assign({},i.INITIAL_STATE,{feedback:e.feedback});case"FILE_ACTIVITY|RESET_FILE_STATE":return t.__assign({},e,{streamActivities:i.INITIAL_STATE.streamActivities,viewActivities:i.INITIAL_STATE.viewActivities,activities:i.INITIAL_STATE.activities});case"FILE_ACTIVITY|LOADING_START":return t.__assign({},e,{streamActivities:t.__assign({},e.streamActivities,{error:void 0,loading:!0}),userId:a.userId,file:a.file});case"FILE_ACTIVITY|LOADING_END":return t.__assign({},e,{streamActivities:t.__assign({},e.streamActivities,{loaded:!0,loading:!1}),feedback:t.__assign({},e.feedback,{shouldShow:e.streamActivities.value.length>0&&!e.feedback.responded&&Math.random()<.1})});case"FILE_ACTIVITY|VIEW_ACTIVITIES_LOADING_START":return t.__assign({},e,{viewActivities:t.__assign({},e.viewActivities,{error:void 0,loaded:!1,loading:!0})});case"FILE_ACTIVITY|VIEW_ACTIVITIES_LOADING_END":return t.__assign({},e,{viewActivities:t.__assign({},e.viewActivities,{loaded:!0,loading:!1})});case"FILE_ACTIVITY|RECEIVE_FILE_ACTIVITY":var r=a.enabled,c=r?new s.ActivitySortedSet(e.streamActivities.value.concat(_(a.streamActivities))).toArray():[];return t.__assign({},e,{streamActivities:t.__assign({},e.streamActivities,{value:c}),enabled:a.enabled});case"FILE_ACTIVITY|RECEIVE_VIEW_ACTIVITY":var I=new s.ActivitySortedSet(e.viewActivities.value.concat(_(a.viewActivities))).toArray();return t.__assign({},e,{viewActivities:t.__assign({},e.viewActivities,{value:I})});case"FILE_ACTIVITY|RECEIVE_STREAM_ERROR":return t.__assign({},e,{streamActivities:t.__assign({},e.streamActivities,{error:a.error})});case"FILE_ACTIVITY|RECEIVE_VIEW_ACTIVITY_ERROR":return t.__assign({},e,{viewActivities:t.__assign({},e.viewActivities,{error:a.error})});case"FILE_ACTIVITY|FEEDBACK_SENT":return t.__assign({},e,{feedback:t.__assign({},e.feedback,{responded:!0})});case"FILE_ACTIVITY|HIDE_FEEDBACK":return t.__assign({},e,{feedback:t.__assign({},e.feedback,{shouldShow:!1})})}return e}function I(e,s){void 0===e&&(e=i.INITIAL_STATE);var a=c(e,s),_=a.streamActivities.loading||a.viewActivities.loading,I=a.streamActivities.loaded&&a.viewActivities.loaded,n=a.streamActivities.error||a.viewActivities.error,A=t.__assign({},a.activities);return A.loading=_,A.loaded=I,A.error=n,A.value=I&&!_&&a.enabled?r.coalesce(a.streamActivities.value.concat(a.viewActivities.value)):[],a.activities=A,a}Object.defineProperty(i,"__esModule",{value:!0}),i.INITIAL_STATE={streamActivities:{error:void 0,loaded:!1,loading:!1,value:[]},viewActivities:{error:void 0,loaded:!1,loading:!1,value:[]},activities:{error:void 0,loaded:!1,loading:!1,value:[]},enabled:!1,userId:-1,feedback:{shouldShow:!1,responded:a.FEEDBACK_RECEIVED}},i.filterActivitiesBasedOnStormcrows=_,i.reducer=I});
//# sourceMappingURL=reducer.min.js-vfl-gp5Va.map