define(["require","exports","modules/clean/react/pass/constants","modules/clean/react/pass/store","modules/clean/react/pass/utils","modules/core/exception"],function(e,s,t,a,i,n){"use strict";function r(e,s){var i={isFinished:!0,value:[]},n={data:i,file:s,userId:e};if(!s)return n;var r=a.passStore.passFetchingStatus(s.ns_id,s.sjid);if(t.fetchingStatusIsError(r))i.error=Error("Pass encountered an error");else if(t.fetchingStatusSeenStateIsComplete(r)){var c=a.passStore.seenStateInfo(s.ns_id,s.sjid);o(c,r);var l=a.passStore.getPassPermissions(s.file_id);l&&l.canReadSeenState&&(i.value=u(c))}else i.isFinished=!1;return n}function o(e,s){e||s===t.PASS_FETCHING_STATUS.CONCLUDED||n.reportStack("Pass adapter has encountered null seenStateInfo, but passFetchingStatus was not CONCLUDED",{severity:n.SEVERITY.NONCRITICAL,tags:["file_activity:pass_adapter"]})}function u(e){var s=[];return null==e?s:(e.seen_states.forEach(function(e){if(e.seen_events){var t=e.seen_state_user,a={id:t.user_id,display_name:t.display_name,email:t.email,photo_url:t.photo_circle_url,isGuest:i.AnonymousViewerUtils.isAnonymousSeenState(e)};e.seen_events.forEach(function(e){var i=new Date(1e3*e.ts);s.push({id:"view:"+t.user_id+"|"+e.ts,type:"view",timestamp:i,user:a,isGroup:!1})})}}),s.sort(function(e,s){return s.timestamp.getTime()-e.timestamp.getTime()}),s)}Object.defineProperty(s,"__esModule",{value:!0}),s.getViewActivities=r});
//# sourceMappingURL=pass_adapter.min.js-vflblfAVr.map