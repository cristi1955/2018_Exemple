define(["require","exports","tslib","external/react","external/spectrum/overflow_button","modules/clean/previews/util","external/spectrum/popover","modules/clean/react/file_action_button_type","modules/clean/react/file_viewer/actions","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/utils","modules/clean/react/file_viewer/more_dropdown/more_option_registry","modules/clean/react/file_viewer/more_dropdown/views","modules/clean/react/size_class/constants","modules/clean/react/title_bubble","modules/core/browser","modules/core/i18n"],function(e,t,o,n,r,i,s,a,l,c,u,m,p,_,d,v,h){"use strict";function g(e,t){return e(t)}Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state=t.getStateFromRegistry(),t.onRegistryUpdate=function(){t.setState(t.getStateFromRegistry())},t.handleDownloadClick=function(e){return e.preventDefault(),l.download(t.props.file),l.logUserAction(c.UserActionNames.DOWNLOAD,c.UserActionContextNames.TITLE_BAR_MORE)},t.handleRemoveLinkClick=function(e){e.preventDefault(),t.props.onRemoveShareLink&&(t.props.onRemoveShareLink(),l.logUserAction(c.UserActionNames.REMOVE_LINK,c.UserActionContextNames.TITLE_BAR_MORE))},t.handlePreviousVersionClick=function(e){if(e.preventDefault(),!t.props.user)throw new Error("User not specified");return i.redirectToVersionHistory(t.props.file,t.props.user),l.logUserAction(c.UserActionNames.VIEW_REVISIONS,c.UserActionContextNames.TITLE_BAR_MORE)},t.handleSignInClick=function(e){e.preventDefault(),l.logUserAction(c.UserActionNames.SIGN_IN,c.UserActionContextNames.TITLE_BAR_MORE),v.redirect(u.getSharedLinkLoginUrl())},t}return o.__extends(t,e),t.prototype.componentDidMount=function(){this.removeRegistryListener=m.moreOptionRegistry.addListener(this.onRegistryUpdate)},t.prototype.componentWillUnmount=function(){this.removeRegistryListener()},t.prototype.getStateFromRegistry=function(){return{registeredItems:m.moreOptionRegistry.getOptionItems()}},t.prototype.getPopoverContent=function(){var e=this.props,t=e.allowRemoveLink,o=e.isPrivate,r=e.onRemoveShareLink,i=e.renderSignIn,l=e.shareDownloadOptions,c=e.sizeClass,u=[],m=c===_.SizeClass.Small,d=c===_.SizeClass.Medium,v=c===_.SizeClass.Large;if(o&&d&&u.push(n.createElement(s.PopoverContentItem,{className:"more-button__share",key:"more-button__share",value:this.props.onClickShareLink},a.getFileActionButtonText(a.FileActionButtonType.SHARE))),null!=r&&t&&!m&&u.push(n.createElement(s.PopoverContentItem,{className:"more-button__remove",key:"more-button__remove",value:this.handleRemoveLinkClick},a.getFileActionButtonText(a.FileActionButtonType.REMOVE_LINK))),o&&u.push(n.createElement(s.PopoverContentItem,{className:"more-button__download",key:"more-button__download",value:this.handleDownloadClick},a.getFileActionButtonText(a.FileActionButtonType.DOWNLOAD))),l)for(var g=0,f=l;g<f.length;g++){var y=f[g];if(!y.isDisabled){var A="more-button-sl__"+y.userActionName;u.push(n.createElement(E,{handler:y.handler,key:A,text:y.text,userActionName:y.userActionName}))}}if(o&&!m&&u.push(n.createElement(s.PopoverContentItem,{className:"more-button__version-history",key:"more-button__version-history",value:this.handlePreviousVersionClick},a.getFileActionButtonText(a.FileActionButtonType.PREVIOUS_VERSIONS))),v&&u.length&&this.state.registeredItems.length&&u.push(n.createElement(s.PopoverContentSeparator,{key:"more_button__seperator"})),v){var C=p.getPopoverItemsForMoreOptions(this.state.registeredItems);u=u.concat(C)}return i&&u.push(n.createElement(s.PopoverContentItem,{className:"more-button__sign-in",key:"more-button__sign-in",value:this.handleSignInClick},h._("Sign in"))),u},t.prototype.render=function(){var e=this.getPopoverContent(),t=!e.length,i={"aria-label":"",className:"u-mar-left-xs more-button",disabled:t,tagName:"span",variant:"borderless"},a=v.is_mobile_or_tablet();return n.createElement(s.Popover,{className:"more-button-popover",onSelection:g},n.createElement(s.PopoverTrigger,{"aria-label":h._("More actions"),disabled:t},a?n.createElement(r.OverflowButton,o.__assign({},i)):n.createElement(d,{content:h._("More"),distanceFromTarget:10,isTargetPositionFixed:!0,position:d.POSITIONS.BOTTOM},n.createElement(r.OverflowButton,o.__assign({},i)))),n.createElement("div",{className:"react-file-viewer-dropdown"},n.createElement(s.PopoverContent,{attachment:"right"},e)))},t})(n.Component);t.MoreDropdown=f;var E=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(){var e=t.props,o=e.handler,n=e.userActionName;l.logUserAction(n,c.UserActionContextNames.TITLE_BAR_MORE),o()},t}return o.__extends(t,e),t.prototype.render=function(){var e=this.props.text;return n.createElement(s.PopoverContentItem,{value:this.handleClick},e)},t})(n.PureComponent)});
//# sourceMappingURL=more_dropdown.min.js-vflqIzQsG.map