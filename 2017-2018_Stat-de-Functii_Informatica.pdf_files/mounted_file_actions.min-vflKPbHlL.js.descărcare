define(["require","exports","tslib","external/react","modules/clean/react/file_viewer/actions","modules/constants/file_viewer","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/more_dropdown","modules/clean/react/file_viewer/open_button","modules/clean/react/paper/open_in_paper_button","modules/clean/react/file_viewer/share_helpers","modules/clean/react/title_bar/controls_container","modules/clean/react/user_notifications/constants","modules/clean/react/user_notifications/dropdown","modules/clean/react/paper/paper_log","modules/clean/sharing/api/client","modules/clean/sharing/delete_link_modal","modules/clean/react/size_class/constants","modules/core/i18n","modules/core/browser"],function(e,t,n,i,r,a,o,l,s,c,u,p,_,d,h,m,f,k,A,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={linkMetadata:null},t.cancelGetSharedLinkInfo=function(){},t.handleShareClick=function(){u.share(t.props.file,t.props.user,null,"PREVIEW_PAGE"),r.logUserAction(o.UserActionNames.SHARE,o.UserActionContextNames.TITLE_BAR_MAIN)},t.removeShareLink=function(){var e=new m.ShareApiClient({userId:t.props.user.id}),n=t.state.linkMetadata,i=n.name,r=n.url;f.deleteLinkWithConfirm({client:e,contentName:i,onCancel:null,onDeleteLink:function(){return t.setState({linkMetadata:null})},url:r})},t}return n.__extends(t,e),t.prototype.componentDidMount=function(){this.setupShare(this.props)},t.prototype.componentWillUnmount=function(){this.cancelGetSharedLinkInfo()},t.prototype.componentWillReceiveProps=function(e){e.file!==this.props.file&&(this.cancelGetSharedLinkInfo(),this.setState({linkMetadata:null}),this.setupShare(e))},t.prototype.setupShare=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,i,r;return n.__generator(this,function(n){switch(n.label){case 0:return t=!1,this.cancelGetSharedLinkInfo=function(){t=!0},i=new m.ShareApiClient({userId:e.user.id}),[4,i.sharedLinkInfo({fileIdOrPath:e.file.fq_path})];case 1:return r=n.sent(),t||this.setState({linkMetadata:r}),this.cancelGetSharedLinkInfo=function(){},[2]}})})},t.prototype.logUserActionInTitleBarFactory=function(e){return function(){return r.logUserAction(e,o.UserActionContextNames.TITLE_BAR_MAIN)}},t.prototype.render=function(){var e=!!this.state.linkMetadata&&this.state.linkMetadata.link_permissions.can_revoke,t=this.props,r=t.file,u=t.sizeClass,m=t.user,f={allowRemoveLink:e,isPrivate:!0,file:r,onClickShareLink:this.handleShareClick,onRemoveShareLink:this.removeShareLink,sizeClass:u,user:m};if(u!==k.SizeClass.Large)return i.createElement(p.TitleBarControlsContainer,null,I.is_mobile_or_tablet()||u===k.SizeClass.Small?null:i.createElement(s.OpenButton,{file:r,location:o.FileViewerPane.TITLE_BAR,user:m}),i.createElement(l.MoreDropdown,n.__assign({},f)));var S=a.OPEN_IN_PAPER_VARIANT in["VARIANT_A","ON"]&&!m.is_paper_disabled,C=S?i.createElement(c.OpenInPaperButton,{file:r}):null;return S&&h.default(h.PaperEventTypes.CTA_SEEN,{source:"mounted_file_actions",cta:"open_in_paper_button"}),i.createElement(p.TitleBarControlsContainer,null,i.createElement("button",{className:"share-button button-primary control__button",onClick:this.handleShareClick},A._("Share")),C,i.createElement(s.OpenButton,{file:r,location:o.FileViewerPane.TITLE_BAR,user:m}),i.createElement(l.MoreDropdown,n.__assign({},f)),i.createElement("div",{className:"react-title-bar__divider"}),i.createElement(d.UserNotificationsDropdown,{isPagelet:!1,isMaestroDesign:!0,onClick:this.logUserActionInTitleBarFactory(o.UserActionNames.CLICK_NOTIFICATIONS),bellDesign:_.BellDesignTypes.GRAY_ICON}))},t})(i.Component);t.MountedFileActions=S});
//# sourceMappingURL=mounted_file_actions.min.js-vflA-6vOz.map