define("modules/clean/react/browse/browse_drag_and_drop",["require","exports","jquery","modules/clean/react/browse/models"],function(e,t,o,n){"use strict";function i(e,t,n,i,r,a,s){o(document).on("dragenter."+e,function(e){(t()||n())&&!o(e.target).closest(r).length&&a()&&(s(null),i())})}function r(e){o(document).off("dragenter."+e)}function a(e,t,o,i,r,a,s,l){if(t||o){if(e.is_dir&&!(i&&o)){if(r)return;var c=a.isCurrentPathWriteable()&&!n.File.isReadOnlySharedFolder(e);s(e),l({path:e.fq_path,hasPermissionToUploadToFolder:c})}else s(null),l()}}Object.defineProperty(t,"__esModule",{value:!0}),t.setupExternalDragHandler=i,t.cleanupExternalDragHandler=r,t.onFileDragEnterItem=a}),define("modules/clean/react/browse/dispatcher",["require","exports","modules/clean/flux/dispatcher"],function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowseDispatcher=o}),define("modules/clean/react/browse/file_grouper",["require","exports","modules/core/i18n","modules/clean/datetime","modules/clean/react/browse/constants","modules/clean/react/browse/models"],function(e,t,o,n,i,r){"use strict";function a(e){return e instanceof r.File?r.File.getCategoryDescription(e,!0):i.ExtensionCategories.DOCUMENT}function s(e){return e instanceof r.File?e.is_dir?i.FileTypeCapitalizedCategoryTranslations.FOLDER:r.File.getExtension(e).toUpperCase():u}function l(e){return e instanceof r.File&&e.ts?1e3*e.ts:e instanceof r.Paper?Date.parse(e.last_modified_date):0}function c(e,t,r){var c=[],p=[],h=null;if(t===i.BrowseSortFields.CATEGORY)e.forEach(function(e,t){if(e){var o=a(e);o!==h&&(c.push(o),p.push(t),h=o)}});else if(t===i.BrowseSortFields.EXTENSION)e.forEach(function(e,t){if(e){var o=s(e);if(o!==h){var n=o;""===o&&(n=u),c.push(n),p.push(t),h=o}}});else if(t===i.BrowseSortFields.MODIFIED)if(r===i.SortDirections.DESCENDING){var m=n.getTimeBands(Date.now());e.forEach(function(e,t){if(e){var n,i=l(e);n=i>=m.today?o._("Today"):i>=m.yesterday?o._("Yesterday"):i>=m.thisWeek?o._("This week"):i>=m.lastWeek?o._("Last week"):i>=m.thisMonth?o._("This month"):i>=m.lastMonth?o._("Last month"):i>=m.lastThreeMonths?o._("Three months ago"):o._("Older"),n!==h&&(c.push(n),p.push(t),h=n)}})}else e.forEach(function(e,t){if(e){var o;if(l(e)){var i=new Date(l(e)),r=i.getMonth(),a=i.getFullYear();o=n.month_with_year(r,a)}else o=d;o!==h&&(c.push(o),p.push(t),h=o)}});return{sectionLabels:c,sectionStartIndices:p}}Object.defineProperty(t,"__esModule",{value:!0});var u=o._("Extensionless",{comment:"Label for files without extensions like .txt or .png"}),d=o._("Missing dates",{comment:"label for group of files without dates marking when they are created or modified"});t.getSections=c}),define("modules/clean/react/browse/file_jump",["require","exports","modules/clean/keycode","modules/clean/react/browse/constants","modules/clean/react/browse/dispatcher","modules/core/dom"],function(e,t,o,n,i,r){"use strict";function a(e,t){var a=null!=e.which?e.which:e.keyCode,c=String.fromCharCode(a);a<o.KeyCode.SPACE||s.includes(c)||r.focus_in_input()||e.metaKey||e.altKey||e.altGraphKey||e.ctrlKey||a===o.KeyCode.SPACE&&!t()||(a===o.KeyCode.SPACE&&t()&&e.preventDefault(),i.BrowseDispatcher.dispatch({type:n.BrowseActionTypes.ADD_FILE_JUMP_KEY_CODE,data:{keyChar:c}}),null!=l&&clearTimeout(l),l=setTimeout(function(){i.BrowseDispatcher.dispatch({type:n.BrowseActionTypes.RESET_FILE_JUMP})},1e3))}Object.defineProperty(t,"__esModule",{value:!0});var s=["/","\\",":","?","*","<",">","|"],l=null;t.handleKeyPress=a}),define("modules/clean/react/browse/file_list_empty_folder_table",["require","exports","tslib","external/react","external/spectrum/media_table","external/spectrum/table"],function(e,t,o,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.componentDidMount=function(){this.props.onTTI()},t.prototype._renderTitle=function(){return n.createElement("h3",{className:"u-font-strong empty-folder-table-title"},this.props.title)},t.prototype._renderSubtitle=function(){var e=this.props,t=e.subtitle,o=e.subtitleLink,i=e.subtitleOnClick;return t&&o?n.createElement("a",{className:"empty-folder-table-subtitle empty-folder-table-link",href:o,onClick:i},t):t?n.createElement("span",{className:"empty-folder-table-subtitle"},t):void 0},t.prototype.render=function(){for(var e=[],t=0;t<2;t++)e.push(n.createElement(i.MediaRow,{key:-t-1}));for(var o=[],t=0;t<11;t++)o.push(n.createElement(i.MediaRow,{key:t+1}));return n.createElement(r.Table,{className:"empty-folder-table"},n.createElement(r.TableHead,null),n.createElement(r.TableBody,null,e,n.createElement(i.MediaRow,{key:0},n.createElement(i.MediaCell,{className:"empty-folder-table-cell",title:this._renderTitle(),subtitle:this._renderSubtitle()})),o))},t})(n.PureComponent);t.EmptyFolderTable=a}),define("modules/clean/react/browse/files_view/tile_grid",["require","exports","tslib","external/classnames","external/immutable","external/react","external/spectrum/button","modules/clean/em_string","modules/clean/filepath","modules/clean/react/browse/browse_drag_and_drop","modules/clean/react/browse/constants","modules/clean/react/browse/file_grouper","modules/clean/react/browse/keyboard_shortcuts","modules/clean/react/browse/models","modules/clean/react/browse/overflow_menu","modules/clean/react/browse/tile_label_input","modules/clean/react/maestro/tile_grid","modules/clean/react/title_bubble","modules/clean/static_urls","modules/core/i18n","modules/core/uri","modules/clean/browse_interface"],function(e,t,o,n,i,r,a,s,l,c,u,d,p,h,m,f,g,_,T,b,w,v){"use strict";function S(e){var t;return e.thumbnail_url_tmpl&&(t=w.parse(e.thumbnail_url_tmpl),t=t.removeQuery("size").removeQuery("size_mode"),t=t.updateQuery({size:"256x256",size_mode:"2"}).toString()),t}Object.defineProperty(t,"__esModule",{value:!0}),t.getThumbnailUrlForItem=S;var E=["ai","au","fl","key","numbers","pages","pkg","pr","psd","sketch","txt","md"],y=["acrobat","code","compressed","excel","film","gear","picture","powerpoint","sound","word"],I=["folder","folder_app","folder_camera","folder_team","folder_team_locked","folder_user","folder_user_locked"],L=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={inSelectMode:!1,sectionLabels:i.List(),sectionStartIndices:i.List(),selectedIds:i.Set(),totalNumItems:0},t.handleFileViewerUnmount=function(){t.tileGrid&&t.tileGrid.getAndUpdateTileLayout()},t.setTileGridRef=function(e){t.tileGrid=e},t.getTileItem=function(e,n){var i,s=t.props,c=s.activeDropTarget,u=s.isCreateFolderUIActive,d=s.isPhotosPage,p=s.items,m=s.selection,f=s.user;if(u){if(0===e)return t.getCreateFolderTile();e-=1}var g=p.get(e);if(!g){var _="Placeholder "+e;return{altText:_,iconUrl:t.props.isPhotosPage?T.static_url("/static/images/maestro/tile-icons/picture-vflIDcp5T.svg"):T.static_url("/static/images/maestro/tile-icons/unknown-vflEPx1xQ.svg"),id:_,isViewOnly:!0,isDraggable:!1,isSelectable:!1}}var w=g instanceof h.File,E=g,y=g,I=t.createViewFileHandler(E),L=t.createToggleSelectHandler(E),N=I,C=!1,P=!1;w&&(i=t.renderTileOverflowMenu(E,n)),t.state.inSelectMode&&w&&(C=m.anchor===E.fq_path,P=m.selected.has(E.fq_path),N=L,w&&(i=r.createElement(a.Button,{className:"tile__action-button--view-file",variant:"secondary",size:"small","aria-label":b._("View File"),onClick:I})));var A=d?void 0:t.renderLabelElement(g),O=w?l.filename(E.fq_path):y.title,R=w?S(E):void 0,M=g===c,F=t.getSVGIconName(g),D=w?E.is_dir?E.href:v.preview_uri_for_fq_path(f,E.fq_path).toString():void 0,x={id:w?E.sjid.toString():y.pad_id,labelNode:A,altText:O,iconUrl:T.static_url("/static/images/maestro/tile-icons/"+F+".svg"),thumbnailUrl:R,actionNode:i,onTileAction:N,isDraggable:!1,isFocused:C,isSelectable:w,handleToggleSelect:L,checkboxAriaText:b._("Select tile"),href:D};return d||(x=o.__assign({},x,{isDraggable:!0,onDragEnter:t.createDragEnterHandler(E,P,M),onDragStart:t.createDragStartHandler(E,P,L)})),x},t}return o.__extends(t,e),t.prototype.componentWillMount=function(){this.setState({inSelectMode:this.props.selectedFiles.count()>0}),this.setTotalNumItems(this.props),this.setTileItemsSections(this.props),this.setSelectedTiles(this.props)},t.prototype.componentDidMount=function(){this.setupExternalDragHandler(),this.setupKeyboardShortcuts()},t.prototype.componentWillUnmount=function(){p.resetBrowseKeyboardShortcuts("BrowseTileGrid")},t.prototype.componentWillReceiveProps=function(e){e.items===this.props.items&&e.createNewFolderState===this.props.createNewFolderState||this.setTotalNumItems(e),e.selectedFiles!==this.props.selectedFiles&&(this.setSelectedTiles(e),this.setState({inSelectMode:e.selectedFiles.count()>0})),e.activeSortField===this.props.activeSortField&&e.activeSortDirection===this.props.activeSortDirection&&e.sections===this.props.sections&&e.items===this.props.items||this.setTileItemsSections(e)},t.prototype.componentDidUpdate=function(e){(e.createNewFolderState===u.NewFolderCreationStates.PENDING_INPUT&&this.props.createNewFolderState===u.NewFolderCreationStates.SAVING_INPUT||e.fileRename!==this.props.fileRename||e.items!==this.props.items)&&this.tileGrid.forceUpdate()},t.prototype.setTotalNumItems=function(e){var t=Math.max(e.items.size,e.totalNumItems);e.isCreateFolderUIActive&&(t+=1),this.setState({totalNumItems:t})},t.prototype.setTileItemsSections=function(e){var t;t=e.sections?e.sections:e.activeSortField?d.getSections(e.items,e.activeSortField,e.activeSortDirection):{sectionLabels:[],sectionStartIndices:[]},this.setState({sectionLabels:i.List(t.sectionLabels),sectionStartIndices:i.List(t.sectionStartIndices)})},t.prototype.createRenameCancelHandler=function(e){var t=this;return function(){t.props.onRenameCancel(e)}},t.prototype.createRenameSubmitHandler=function(e){var t=this;return function(o){t.props.onRenameSubmit(e,o)}},t.prototype.createToggleSelectHandler=function(e){var t=this,o=e.fq_path;return function(e){e.preventDefault(),e.stopPropagation();var n=t.props.selection;n=n.selected.has(o)?n.update("selected",function(e){return e.delete(o)}):n.update("selected",function(e){return e.add(o)}).set("anchor",o),t.props.onSelectionChange(n)}},t.prototype.renderTileOverflowMenu=function(e,t){var o=this.props.getFileActions(e),n=0===t?"left":"right";return r.createElement(m.BrowseOverflowMenu,{file:e,attachment:n,actionItems:o,size:m.OverflowMenuSize.Small,showBorders:!0})},t.prototype.renderLabelElement=function(e){var t,o=e instanceof h.File,n=e,i=e;if(t=o?l.filename(n.fq_path):i.title,o&&this.props.fileRename&&l.paths_are_equal(this.props.fileRename.file.fq_path,n.fq_path)){if(this.props.fileRename.state===u.RenameStates.PENDING_INPUT)return r.createElement(f.TileLabelInput,{defaultValue:t,label:t,onCancel:this.createRenameCancelHandler(n),onSubmit:this.createRenameSubmitHandler(n)});if(this.props.fileRename.state===u.RenameStates.SAVING_INPUT)return r.createElement(g.TileItemLabelText,{className:"tile-label__text--saving",label:b._("Renaming…")})}var a=s.em_snippet(t,16,.5),c=r.createElement(g.TileItemLabelText,{label:a});return t!==a?r.createElement(_,{content:t,position:_.POSITIONS.BOTTOM,className:"tile-label__title-bubble"},c):c},t.prototype.createViewFileHandler=function(e){var t=this;return function(o){e instanceof h.File?t.props.onOpenFile(o,e,t.handleFileViewerUnmount):e instanceof h.Paper&&t.props.onOpenPaper(o,e)}},t.prototype.getSVGIconName=function(e){var t=this.getSVGIconBaseName(e);return e instanceof h.File&&e.isDeleted&&(t+="-disabled"),t},t.prototype.getSVGIconBaseName=function(e){if(e instanceof h.Paper)return"paper";var t=e.icon;if(t&&("_32"===t.slice(-3)&&(t=t.slice(0,-3)),"page_white_"===t.slice(0,11)&&(t=t.slice(11)),"_gray"===t.slice(-5)&&(t=t.slice(0,-5))),e.is_dir)return I.includes(t)?t:"folder";var o=l.file_extension(l.filename(e.fq_path));return E.includes(o)?o:y.includes(t)?t:"unknown"},t.prototype.setSelectedTiles=function(e){var t=i.Set().withMutations(function(t){e.selectedFiles.forEach(function(e){t.add(e.sjid.toString())})});this.setState({selectedIds:t})},t.prototype.setupExternalDragHandler=function(){var e=this,t=function(){return!!e.props.isDraggingInternalFiles},o=function(){return!!e.props.isDraggingExternalFiles},n=function(){return e.props.activeDropTarget};c.setupExternalDragHandler("BrowseTileGrid",t,o,this.props.setFileUploaderPath,".tile",n,this.props.onSetDropTarget)},t.prototype.setupKeyboardShortcuts=function(){var e=this,t=this.props,o=t.actionHandlers,n=t.deselectAll,i=t.getIsCurrentPathWriteable,r=t.getIsFileJumping,a=t.onCopyToClipboard,s=t.onPasteFromClipboard,l=t.onSetDragCopyMode,c=t.selectAll,u=p.generateGetIsGlobalEvent(this),d=u,h=function(){return e.props.selectedFiles};p.setupGeneralBrowseKeyboardShortcuts({getIsFileJumping:r,getIsGlobalEvent:u,getIsItemEvent:d,getSelectedFiles:h,isItemList:!1,isCurrentPathWriteable:i,selectAllAction:c,deselectAllAction:n,onCopyToClipboard:a,onDelete:o.onDelete,onPasteFromClipboard:s,onSetDragCopyMode:l,onShowRename:o.onShowRename,scope:"BrowseTileGrid",onShowHelpMenu:function(){return e.props.onOpenKeyboardShortcutModal()}})},t.prototype.createDragEnterHandler=function(e,t,o){var n=this;return function(i){n.props.onDragEnter(i,e,t,o)}},t.prototype.createDragStartHandler=function(e,t,o){var n=this;return function(i){t?n.props.onDragStart(i):(o(i),n.props.onDragStart(i,[e]))}},t.prototype.getCreateFolderTile=function(){var e=b._("New folder"),t=r.createElement("div",null);return this.props.createNewFolderState===u.NewFolderCreationStates.PENDING_INPUT?(e=b._("Folder name"),t=r.createElement(f.TileLabelInput,{label:e,onCancel:this.props.onNewFolderCancel,onSubmit:this.props.onNewFolderSubmit})):this.props.createNewFolderState===u.NewFolderCreationStates.SAVING_INPUT&&(e=b._("Creating new folder…"),t=r.createElement(g.TileItemLabelText,{className:"tile-label__text--saving",label:e})),{altText:e,iconUrl:T.static_url("/static/images/maestro/tile-icons/folder-vflMFXe_s.svg"),id:"New folder tile",isDraggable:!1,isSelectable:!1,labelNode:t}},t.prototype.getTileGridRef=function(){return this.tileGrid},t.prototype.render=function(){var e=this.props.enableMaxHeightGrouping,t=n({"file-tile-grid-container":!0,"file-tile-grid-container--show-checkboxes":this.state.inSelectMode});return r.createElement("div",null,r.createElement(g.InfiniteTileGrid,{key:"tileGrid",ref:this.setTileGridRef,totalNumItems:this.state.totalNumItems,containerClass:t,rowClass:"file-tile-row",enableMaxHeightGrouping:e,delayRenderFullTile:!this.props.isCreateFolderUIActive,logTileLoading:!0,numThresholdRows:u.BrowseTileGridConstants.NUM_THRESHOLD_ROWS,scrollDeltaThreshold:u.BrowseTileGridConstants.SCROLL_DELTA_THRESHOLD,sectionStartIndices:this.state.sectionStartIndices,sectionLabels:this.state.sectionLabels,showLabels:!this.props.isPhotosPage,contentOffset:136,getTileItem:this.getTileItem,selectedIds:this.state.selectedIds,handleTTI:this.props.onTTI,thumbStore:this.props.thumbStore,onRangeInView:this.props.onRangeInView}))},t.defaultProps={enableMaxHeightGrouping:!1},t})(r.PureComponent);t.BrowseTileGrid=L}),define("modules/clean/react/browse/keyboard_shortcuts",["require","exports","jquery","external/keymaster","external/react-dom","modules/clean/keycode","modules/clean/react/browse/file_jump","modules/clean/undo","modules/core/browser","modules/core/i18n","modules/core/notify"],function(e,t,o,n,i,r,a,s,l,c,u){"use strict";function d(e){n.clearScope(e),n.setScope(b)}function p(e,t){return function(o){e(o)&&(o.preventDefault(),"function"==typeof t&&t(o))}}function h(e){return function(t){return!document.activeElement||document.activeElement===document.body||i.findDOMNode(e).contains(t.target)}}function m(e){var t=e.scope,n=e.onSetDragCopyMode,i=function(e,t){return function(o){o.keyCode!==r.KeyCode.CONTROL&&o.keyCode!==r.KeyCode.ALT||t(e)}};o(document).on("keydown."+t,i(!0,n)).on("keyup."+t,i(!1,n))}function f(e){var t=e.scope,i=e.getIsFileJumping,r=function(e){n.getScope()===t&&a.handleKeyPress(e,i)};o(document).on("keypress."+t,r)}function g(e){d(e),o(document).off("."+e)}function _(e){var t=e.getIsFileJumping,i=e.getIsGlobalEvent,r=e.getIsItemEvent,a=e.getSelectedFiles,d=e.isItemList,h=e.isCurrentPathWriteable,g=e.selectAllAction,_=e.deselectAllAction,T=e.onCopyToClipboard,w=e.onDelete,v=e.onPasteFromClipboard,S=e.onSetDragCopyMode,E=e.onShowRename,y=e.onShowHelpMenu,I=e.scope;f({scope:I,getIsFileJumping:t}),m({scope:I,onSetDragCopyMode:S}),b=n.getScope(),b!==I&&n.setScope(I);var L=function(){var e=a(),t=e.some(function(e){return e.read_only});if(1===e.size)if(h()&&!t){var o=e.first();o.isDeleted?u.error(c._("Deleted files can’t be renamed.")):E(o)}else u.warning(c._("You don’t have permission to rename files in this folder."))},N=function(){var e=a();e.size&&w(e.toArray())},C=function(){s.performUndo()},P=function(){return o(".search-bar__text-input").focus()};n("f2",I,p(r,L)),n("/",I,p(i,P)),n("shift+/",I,p(i,function(){return y(!!d)})),n("escape",I,p(i,_)),l.mac?(n("command+a",I,p(i,g)),n("command+c",I,p(r,T)),n("backspace",I,p(r,N)),n("command+v",I,p(i,v)),n("command+z",I,p(i,C))):(n("ctrl+a",I,p(i,g)),n("ctrl+c",I,p(r,T)),n("delete",I,p(r,N)),n("ctrl+v",I,p(i,v)),n("ctrl+z",I,p(i,C)))}function T(e){var t=e.getIsFileJumping,i=e.getIsGlobalEvent,r=e.getIsItemEvent,a=e.getSelectedFiles,s=e.isCurrentPathWriteable,l=e.enableContextMenu,c=e.selectAllAction,u=e.deselectAllAction,d=e.onCopyToClipboard,h=e.onDelete,m=e.onNavigateToFileOrFolder,f=e.onNavigateToParentFolder,g=e.onPasteFromClipboard,T=e.onSetDragCopyMode,b=e.onShowRename,w=e.onShowHelpMenu,v=e.openContextMenuAtPosition,S=e.scope;_({getIsFileJumping:t,getIsGlobalEvent:i,getIsItemEvent:r,getSelectedFiles:a,isItemList:!0,isCurrentPathWriteable:s,selectAllAction:c,deselectAllAction:u,onCopyToClipboard:d,onDelete:h,onPasteFromClipboard:g,onSetDragCopyMode:T,onShowRename:b,onShowHelpMenu:w,scope:S});var E=function(){var e=a();1===e.size&&m(e.first())},y=function(){var e=a(),t=e.first();1===e.size&&t.is_dir&&m(t)},I=function(e){if("function"==typeof v&&a().size){var t=o(e.target).closest(".browse-file-row--is-selected").first();if(t.length){v(t[0].offsetLeft+200,t[0].offsetTop+5,t.get(0))}}else v(10,10)};n("enter",S,p(r,E)),n("right",S,p(r,y)),n("left",S,p(i,f)),l()&&n("alt+a",S,p(i,I))}Object.defineProperty(t,"__esModule",{value:!0}),t.GENERAL_SHORTCUTS=[{windowsKey:"Enter",macKey:"return",desc:c._("Open file or folder")},{key:"/",desc:c._("Search")},{windowsKey:"Ctrl + a",macKey:"⌘ + a",desc:c._("Select all files")},{windowsKey:"Esc",macKey:"esc",desc:c._("Deselect all files")},{windowsKey:"Ctrl + c",macKey:"⌘ + c",desc:c._("Copy selected file(s)")},{windowsKey:"Ctrl + v",macKey:"⌘ + v",desc:c._("Paste selected file(s) into the current folder")},{key:"F2",desc:c._("Rename selected file")},{windowsKey:"Delete",macKey:"delete",desc:c._("Delete selected file(s)")},{windowsKey:"Ctrl + z",macKey:"⌘ + z",desc:c._("Undo recent move/copy/rename/delete")},{key:"?",desc:c._("Show keyboard shortcuts")}],t.ITEM_LIST_SHORTCUTS=[{key:"↑",desc:c._("Select previous file (hold shift to select range)",{comment:"Shift refers to the shift key"})},{key:"↓",desc:c._("Select next file (hold shift to select range)",{comment:"Shift refers to the shift key"})},{key:"←",desc:c._("Go up a folder")},{key:"→",desc:c._("Open folder")}].concat(t.GENERAL_SHORTCUTS);var b="";t.generateGetIsGlobalEvent=h,t.setupFileJumpKeyboardShortcuts=f,t.resetBrowseKeyboardShortcuts=g,t.setupGeneralBrowseKeyboardShortcuts=_,t.setupItemListKeyboardShortcuts=T}),define("modules/clean/react/browse/name_input",["require","exports","tslib","external/classnames","external/react","modules/clean/keycode"],function(e,t,o,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){};t.NameInputActionSources={ESC:"ESC",SUBMIT:"SUBMIT",BLUR:"BLUR"};var s=(function(e){function s(){var o=null!==e&&e.apply(this,arguments)||this;return o.setInputRef=function(e){o.inputRef=e},o.handleDragStart=function(e){e.stopPropagation()},o.handleSubmit=function(e){e.preventDefault(),o.submitIfChanged(t.NameInputActionSources.SUBMIT)},o.handleKeyDown=function(e){e.keyCode===r.KeyCode.ESC?(e.preventDefault(),o.props.onCancel({source:t.NameInputActionSources.ESC})):e.keyCode===r.KeyCode.ENTER&&o.handleSubmit(e)},o.handleBlur=function(e){o.submitIfChanged(t.NameInputActionSources.BLUR)},o.handleClick=function(e){o.props.onClick(e)},o}return o.__extends(s,e),s.prototype.componentDidMount=function(){var e=this;this.inputRef.focus(),window.requestAnimationFrame(function(){var t=e.inputRef.value,o=t.lastIndexOf(".");o<0&&(o=t.length),e.inputRef.setSelectionRange(0,o)})},s.prototype.submitIfChanged=function(e){var t=this.inputRef.value.trim();t===this.props.defaultValue?this.props.onCancel({source:e}):this.props.onSubmit(t)},s.prototype.render=function(){return i.createElement("form",{className:"u-pad-right-xs",onSubmit:this.handleSubmit},i.createElement("input",{ref:this.setInputRef,defaultValue:this.props.defaultValue,className:n("c-input",this.props.className),onBlur:this.handleBlur,onKeyDown:this.handleKeyDown,onDragStart:this.handleDragStart,"aria-label":this.props.label,onClick:this.handleClick}))},s.defaultProps={className:"",onCancel:a,onClick:a,onSubmit:a},s})(i.PureComponent);t.NameInput=s}),define("modules/clean/react/browse/overflow_menu",["require","exports","tslib","external/react","external/spectrum/overflow_button","external/spectrum/popover","modules/core/i18n"],function(e,t,o,n,i,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s;(function(e){e[e.Normal=0]="Normal",e[e.Small=1]="Small"})(s=t.OverflowMenuSize||(t.OverflowMenuSize={}));var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.preventDefaultAndStopPropagation=function(e){e.preventDefault(),e.stopPropagation()},t.handleSelection=function(e){e.performAction()},t}return o.__extends(t,e),t.prototype.renderOverflowButton=function(){return n.createElement(i.OverflowButton,{"aria-label":a._("More actions"),className:"browse-overflow-menu-trigger-button",tagName:"span",size:this.props.size===s.Small?"small":"default",variant:this.props.showBorders?"secondary":"borderless"})},t.prototype.render=function(){var e=this.props,t=e.actionItems,o=e.attachment,i=t.map(function(e){return n.createElement(r.PopoverContentItem,{className:e.className,key:e.label,value:e,disabled:e.disabled},e.label)});return n.createElement("div",{className:"browse-overflow-menu",onClick:this.preventDefaultAndStopPropagation,onDoubleClick:this.preventDefaultAndStopPropagation},n.createElement(r.Popover,{onSelection:this.handleSelection,closeOnSelection:!0},n.createElement(r.PopoverTrigger,{className:"browse-overflow-menu-trigger"},this.renderOverflowButton()),n.createElement(r.PopoverContent,{attachment:o,className:"browse-overflow-menu-content"},i)))},t.defaultProps={attachment:"right"},t})(n.PureComponent);t.BrowseOverflowMenu=l}),define("modules/clean/react/browse/tile_label_input",["require","exports","external/classnames","external/react","modules/clean/react/browse/name_input"],function(e,t,o,n,i){"use strict";function r(e){var t=o("tile-label-input",e.className),r=e.defaultValue||"",a=function(e){e.stopPropagation()};return n.createElement(i.NameInput,{className:t,defaultValue:r,label:e.label,onCancel:e.onCancel,onClick:a,onSubmit:e.onSubmit})}Object.defineProperty(t,"__esModule",{value:!0}),t.TileLabelInput=r}),define("modules/clean/react/browse/util",["require","exports","modules/clean/react/browse/models","modules/clean/em_string","modules/clean/filepath","modules/core/i18n"],function(e,t,o,n,i,r){"use strict";function a(e){if(1===e.count()){var t=e.first(),o=i.filename(t.fq_path);return n.em_snippet(o,13.5)}if(e.count()>1){var a=function(e){return e.isDeleted},s=e.some(a)&&!e.every(a),l=e.toArray().filter(function(e){return e.is_dir}),c=e.toArray().filter(function(e){return!e.is_dir});if(s)return r._("No available actions");var u=[];if(c.length){var d=r.ungettext("%(num_files)d file","%(num_files)d files",c.length).format({num_files:c.length});u.push(d)}if(l.length){var d=r.ungettext("%(num_folders)d folder","%(num_folders)d folders",l.length).format({num_folders:l.length});u.push(d)}return 2===u.length?r._("%(x)s and %(y)s",{comment:'\n            The whole string is a phrase like "2 files and 3 folders". \'x\' is\n            a string containing a phrase like "2 files" and \'y\' is a string\n            containing a phrase like "3 folders".\n          '}).format({x:u[0],y:u[1]}):u[0]}return""}function s(e,t){var n=e.count(),i=r._("You only have partial access");return n>0?1!==n||o.File.canViewFileMembers(e.first(),t)?r.ungettext("%(count)d item selected","%(count)d items selected",n).format({count:n}):o.File.isNoAccessSharedFolder(e.first())?r._("You don’t have access to this folder"):i:t&&!t.canViewContainingNSMembers?i:""}function l(e,t){if(e.length!==t.length)return!1;for(var o=0;o<e.length;o++)if(e[o].sortField!==t[o].sortField||e[o].label!==t[o].label)return!1;return!0}Object.defineProperty(t,"__esModule",{value:!0});t.describeFiles=a,t.getSelectedFilesText=s,t.compareColumns=l}),define("modules/clean/react/file_viewer/async_controller",["require","exports"],function(e,t){"use strict";function o(t){var o=t.containerId,n=t.files,i=t.fileViewAction,r=t.fileViewOrigin,a=t.fileViewTarget,s=t.indexOfPreviewFile,l=t.onFileViewerDidMount,c=t.onFileViewerUnmount,u=t.shouldFocusComment,d=void 0!==u&&u,p=t.updateBrowserLocation,h=void 0===p||p,m=t.user;e(["modules/clean/react/file_viewer/controller"],function(e){e.open(n,s,m,o,{fileViewTarget:a,fileViewOrigin:r,fileViewAction:i,shouldFocusCommentInput:d,disableRouting:!h,onComponentDidMount:l,onComponentWillUnmount:c})})}Object.defineProperty(t,"__esModule",{value:!0}),t.asyncOpenPreview=o}),define("modules/clean/react/home/home_access/home_access_util",["require","exports","modules/constants/starred"],function(e,t,o){"use strict";function n(){return o.HOME_ENABLED}Object.defineProperty(t,"__esModule",{value:!0}),t.isHomeEnabled=n}),define("modules/clean/react/maestro/checkbox",["require","exports","tslib","external/react","external/classnames"],function(e,t,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;(function(e){e[e.Checked=0]="Checked",e[e.PartiallyChecked=1]="PartiallyChecked",e[e.Unchecked=2]="Unchecked"})(r||(r={})),t.CheckboxState=r;var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.render=function(){var e=this.props.checkboxState,t=i({"checkbox-button":!0,"partial-checked":e===r.PartiallyChecked,checked:e===r.Checked});return n.createElement("button",{role:"checkbox","aria-checked":e===r.Checked,"aria-label":this.props.ariaLabel,className:t,onClick:this.props.onClick,onMouseDown:this.props.onMouseDown})},t})(n.PureComponent);t.Checkbox=a}),define("modules/clean/react/maestro/tile_element",["require","exports","tslib","external/classnames","external/react","modules/clean/keycode","modules/clean/react/maestro/checkbox","modules/clean/react/maestro/tile_grid_logger"],function(e,t,o,n,i,r,a,s){"use strict";function l(e){var t=e.leftOffset,o=e.tileHeight,n=e.tileWidth,r=e.thumbNode,a=e.labelNode,s={left:t,height:o,width:n,pointerEvents:"none"},l={height:n,width:n};return i.createElement("div",{className:"tile",style:s},i.createElement("div",{className:"tile__thumb-container",style:l},r||i.createElement("div",{className:"tile__preview--placeholder"})),a)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){return null};t.TilePlaceholder=l;var u=(function(e){function t(t){var o=e.call(this,t)||this;return o.animationRequestIds=[],o.focusTile=function(){if(!o.state.isFocused){var e=o.refs.tileThumbContainer;e&&e.focus()}},o.logTileInteractive=function(){var e=!!o.props.thumbnailUrl,t=o.state.thumbLoaded;if(o.props.onThumbnailLoad){var n=window.requestAnimationFrame(function(){var n=window.requestAnimationFrame(function(){o.props.onThumbnailLoad(o.props.tileIndex,e,t)});o.animationRequestIds.push(n)});o.animationRequestIds.push(n)}},o.toggleSelect=function(e){e.preventDefault(),e.stopPropagation(),o.props.handleToggleSelect(e)},o.handleThumbKeyPress=function(e){var t=e.keyCode;t!==r.KeyCode.SPACE&&t!==r.KeyCode.ENTER||(e.preventDefault(),o.props.onTileAction(e))},o.onBlur=function(e){o.setState({isFocused:!1})},o.onFocus=function(e){o.setState({isFocused:!0})},o.state={iconLoaded:!!t.thumbStore.get_thumb(t.iconUrl),thumbLoaded:!(!t.thumbnailUrl||!t.thumbStore.get_thumb(t.thumbnailUrl))},o}return o.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.delayRenderFullTile?this.renderCompleteTileTimeout=setTimeout(function(){e.renderCompleteTileTimeout=0,e.fetchThumbnail()},100):this.fetchThumbnail(),this.logTileInteractive()},t.prototype.componentDidUpdate=function(e,t){!e.isFocused&&this.props.isFocused&&this.focusTile()},t.prototype.componentWillUnmount=function(){this.thumbRequestId&&this.props.thumbStore.unbind_url(this.thumbRequestId),this.props.thumbStore.unbind_url(this.iconRequestId),this.renderCompleteTileTimeout&&clearTimeout(this.renderCompleteTileTimeout),this.animationRequestIds.forEach(function(e){window.cancelAnimationFrame(e)}),this.animationRequestIds=[]},t.prototype.fetchThumbnail=function(){var e=this;if(this.props.thumbnailUrl){var t=Date.now();this.thumbRequestId=this.props.thumbStore.bind_url(this.props.thumbnailUrl,{onSuccess:function(){e.setState({thumbLoaded:!0}),s.InfiniteTileGridLogger.logThumbRTT(Date.now()-t)},onError:function(){e.props.onThumbnailError&&e.props.onThumbnailError(e.props.tileIndex)}})}this.iconRequestId=this.props.thumbStore.bind_url(this.props.iconUrl,{onSuccess:function(){e.state.thumbLoaded||e.setState({iconLoaded:!0})}})},t.prototype.renderCheckbox=function(){var e=this.props.isSelected?a.CheckboxState.Checked:a.CheckboxState.Unchecked;return i.createElement("div",{key:"tile-select-checkbox",className:"tile-select-checkbox"},i.createElement(a.Checkbox,{ariaLabel:this.props.checkboxAriaText,checkboxState:e,onClick:this.toggleSelect}))},t.prototype.renderActionNode=function(){return i.createElement("div",{key:"tile-action-node",className:"tile__action-button"},this.props.actionNode)},t.prototype.renderThumbnail=function(){var e="tile__preview",t=null;return this.state.thumbLoaded&&(t=this.props.thumbStore.get_thumb(this.props.thumbnailUrl),t&&(e+=" tile__preview--thumb")),!t&&this.state.iconLoaded&&(t=this.props.thumbStore.get_thumb(this.props.iconUrl),t&&(e+=" tile__preview--icon")),t?i.createElement("img",{alt:this.props.altText,className:e,draggable:!1,src:t,style:{maxHeight:this.props.width,maxWidth:this.props.width}}):i.createElement("div",{className:"tile__preview--placeholder"})},t.prototype.render=function(){var e=null;this.props.labelNode&&(e=i.createElement("div",{className:"tile-label"},this.props.labelNode));var t=this.props.width+this.props.labelHeight;if(this.props.isViewOnly)return i.createElement(l,{leftOffset:this.props.leftOffset,tileHeight:t,tileWidth:this.props.width,thumbNode:this.renderThumbnail(),labelNode:e});var r={left:this.props.leftOffset,height:t,width:this.props.width},a={height:this.props.width,width:this.props.width},s={className:n("tile",{"tile--is-selected":this.props.isSelected,"tile--focused-in":this.state.isFocused}),style:r,draggable:this.props.isDraggable,href:this.props.href,onBlur:this.onBlur,onClick:this.props.onTileAction,onDragEnter:this.props.onDragEnter,onDragStart:this.props.onDragStart,onFocus:this.onFocus},c=i.createElement("div",{ref:"tileThumbContainer",className:"tile__thumb-container",style:a,tabIndex:0,onKeyDown:this.handleThumbKeyPress},this.renderThumbnail());return i.createElement("a",o.__assign({},s),c,this.props.isSelectable&&this.renderCheckbox(),this.renderActionNode(),e)},t.defaultProps={checkboxAriaText:"",delayRenderFullTile:!0,handleToggleSelect:c,isFocused:!1,isSelected:!1,isViewOnly:!1,
onDragEnter:c,onDragStart:c,onTileAction:c},t})(i.PureComponent);t.TileElement=u}),define("modules/clean/react/maestro/tile_grid",["require","exports","tslib","external/react","external/react-dom","external/classnames","modules/clean/js_client_stopwatch","external/spectrum/culled_list","modules/clean/react/maestro/tile_element","modules/clean/react/maestro/tile_grid_logger","modules/clean/photos/thumb_loading/generic_thumb_store"],function(e,t,o,n,i,r,a,s,l,c,u){"use strict";function d(e){var t=null;return function(){for(var o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];if(!t||t.length!==o.length||!t.every(function(e,t){return e===o[t]}))return t=o,e.apply(void 0,o)}}function p(e){var t=e.className,o=e.label;return t=r("tile-label__text",t),n.createElement("div",{className:t},o)}Object.defineProperty(t,"__esModule",{value:!0});t.memoizeCallback=d,t.TileItemLabelText=p;var h=(function(e){function t(t){var o=e.call(this,t)||this;if(o.ttiReported=!1,o.itemRangeByRow=[],o.scrollTileIntoView=function(e,t){var n=o.props.contentOffset||0,i=document.documentElement.scrollTop||document.body.scrollTop,r=Math.floor(t/o.state.tilesPerRow),a=e-n,s=o.getRowHeight(),l=r*s,c=l+s;i<=l&&c<=a+i||(l<i?window.scrollTo(0,l):window.scrollTo(0,c-a))},o.updateOnResize=function(){window.requestAnimationFrame(function(){o.getAndUpdateTileLayout()})},o.handleTTI=function(){o.ttiReported=!0;var e=o.props.handleTTI;e&&e()},o.setLastViewedPage=function(e){var t=document.documentElement.scrollTop||document.body.scrollTop,n=Math.round(t/e);if(o.tileLoadLogger.pruneTrackedPages(),o.tileLoadLogger.logCompletedPages(),!o.tileLoadLogger.pagesCompletedLogging.has(n)&&!o.tileLoadLogger.pagesToLog.has(n))if(n!==o.tileLoadLogger.lastViewedPage){if(o.tileLoadLogger.lastViewedPage=n,o.tileLoadLogger.pageChangeTime=o.tileLoadLogger.getTimeNow(),!o.tileLoadLogger.startTimeByPage.get(n)){var i=o.tileLoadLogger.getTimeNow(),r=o.tileLoadLogger.startTimeByPage.set(n,i);o.tileLoadLogger.startTimeByPage=r}}else{var i=o.tileLoadLogger.getTimeNow();if(i-o.tileLoadLogger.pageChangeTime>1e3){var a=o.tileLoadLogger.pagesToLog.add(n);o.tileLoadLogger.pagesToLog=a}}},o.logTileError=function(e){o.tileLoadLogger&&o.tileLoadLogger.recordTileError(e),o.props.logTileLoading&&c.InfiniteTileGridLogger.logThumbLoadError()},o.logTileLoaded=function(e,t,n){o.tileLoadLogger&&o.tileLoadLogger.recordTileLoaded(e,t,n)},o.renderTileElement=function(e,t,i){if(e<0||e>o.props.totalNumItems)return null;var r=o.props.getTileItem(e,i);if(!r)return n.createElement(l.TilePlaceholder,{leftOffset:t,tileHeight:o.state.tileWidth,tileWidth:o.state.tileWidth});var a=o.ttiReported&&o.props.delayRenderFullTile,s=r.isSelectable&&!!o.props.selectedIds&&o.props.selectedIds.has(r.id);return n.createElement(l.TileElement,{key:r.id,onTileAction:r.onTileAction,width:o.state.tileWidth,leftOffset:t,tileIndex:e,labelHeight:r.labelNode?o.props.labelHeight:0,delayRenderFullTile:a,actionNode:r.actionNode,iconUrl:r.iconUrl,thumbnailUrl:r.thumbnailUrl,labelNode:r.labelNode,altText:r.altText,onThumbnailError:o.props.logTileLoading?o.logTileError:void 0,onThumbnailLoad:o.props.logTileLoading?o.logTileLoaded:void 0,isDraggable:r.isDraggable,onDragEnter:r.onDragEnter,onDragStart:r.onDragStart,isFocused:r.isFocused,isSelectable:r.isSelectable,isSelected:s,isViewOnly:r.isViewOnly,handleToggleSelect:r.handleToggleSelect,checkboxAriaText:r.checkboxAriaText,thumbStore:o.thumbStore,scrollTileIntoView:o.scrollTileIntoView,href:r.href})},o.renderRow=function(e,t,i){var r=o.rowHeights?o.rowHeights[t]:o.getRowHeight();if(!e)return n.createElement(s.CulledItem,{className:o.props.rowClass,height:r,key:t,tagName:"li",topOffset:i});if(!Array.isArray(e))return n.createElement(s.CulledItem,{className:o.props.rowClass,height:r,key:t,tagName:"li",topOffset:i},e);for(var a=e,l=a[0],c=a[1],u=o.state.tileWidth+o.props.tilePadding,d=[],p=4,h=l;h<c;h++)d.push(o.renderTileElement(h,p,d.length)),p+=u;return n.createElement(s.CulledItem,{className:o.props.rowClass,height:r,key:t,tagName:"li",topOffset:i},d)},o.handleRangeInView=d(function(e,t){var n=o.props.onRangeInView;if(n){var i=o.translateRowRangeToItemRange(e,t);n(i[0],i[1])}}),o.props.sectionLabels||o.props.sectionStartIndices){if(!o.props.sectionLabels||!o.props.sectionStartIndices)throw new Error("Included only one of `sectionLabels` or `sectionStartIndices`.");if(o.props.sectionLabels.count()!==o.props.sectionStartIndices.count())throw new Error("sectionLabels and sectionStartIndices must be of same length.")}return o.state={tilesPerRow:3,tileWidth:o.props.maxTileWidth},o.props.thumbStore?o.thumbStore=o.props.thumbStore:o.thumbStore=new u.GenericThumbStore,a.JSStopwatch.create_stopwatch_if_not_exist("infinite_tile_grid_logging"),o}return o.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;window.addEventListener("resize",this.updateOnResize),this.animationFrameRequestId=window.requestAnimationFrame(function(){var t=e.getAndUpdateTileLayout();e.props.logTileLoading&&e.setupTileLogging(e.getRowHeight(),t.tilesPerRow)})},t.prototype.componentWillReceiveProps=function(e){this.tileLoadLogger&&this.tileLoadLogger.updateNumTiles(e.totalNumItems)},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.updateOnResize),this.animationFrameRequestId&&window.cancelAnimationFrame(this.animationFrameRequestId),this.tileLoadLogger&&(clearInterval(this.logTrackingInterval),delete this.tileLoadLogger)},t.prototype.getRowHeight=function(){var e=this.props.tileHeight+this.props.tilePadding;return this.props.showLabels&&(e+=this.props.labelHeight+4),e},t.prototype.getPageHeight=function(){var e=document.documentElement.clientHeight||window.outerHeight,t=this.props.contentOffset||0,o=e-t,n=this.getRowHeight(),i=n*Math.ceil(o/n);return Math.max(i,n)},t.prototype.getAndUpdateTileLayout=function(){var e=this.props.maxTileWidth+this.props.tilePadding,t=i.findDOMNode(this);if(!t||0===t.clientWidth)return{tileWidth:this.state.tileWidth,tilesPerRow:this.state.tilesPerRow};var o=t.clientWidth,n=Math.max(1,Math.floor(o/e)),r=this.props.maxTileWidth;return o%e>1&&(n++,r=o/n-this.props.tilePadding),this.state.tileWidth===r&&this.state.tilesPerRow===n||this.setState({tileWidth:r,tilesPerRow:n}),{tileWidth:r,tilesPerRow:n}},t.prototype.setupTileLogging=function(e,t){var o=this.getPageHeight(),n=t*Math.ceil(o/e);this.tileLoadLogger=new c.InfiniteTileGridLogger(this.props.totalNumItems,n,t,this.handleTTI);var i=this.tileLoadLogger.pagesToLog.add(0);this.tileLoadLogger.pagesToLog=i;var r=this.tileLoadLogger.getTimeNow(),a=this.tileLoadLogger.startTimeByPage.set(0,r);this.tileLoadLogger.startTimeByPage=a,this.logTrackingInterval=setInterval(this.setLastViewedPage,200,o)},t.prototype.translateRowRangeToItemRange=function(e,t){var o=this.itemRangeByRow;return[o[e][0],o[t][1]]},t.prototype.render=function(){var e=this,t=this.itemRangeByRow;t.length=0;var o=[],i=this.getRowHeight(),r=this.props,a=r.containerClass,l=r.enableMaxHeightGrouping,c=r.numThresholdRows,u=r.scrollDeltaThreshold,d=r.sectionStartIndices,p=r.sectionLabels,h=r.totalNumItems;if(d&&d.count()>0)return this.rowHeights=[],d.forEach(function(r,a){var s=h;a!==d.count()-1&&(s=d.get(a+1)),e.rowHeights.push(32);var l=s-r,c=Math.ceil(l/e.state.tilesPerRow),u=p.get(a),m=n.createElement("div",{className:"tile-section-header"},u);o.push(m),t.push([r,r]);for(var f=0;f<c;f++){var g=r+f*e.state.tilesPerRow,_=Math.min(g+e.state.tilesPerRow,s),T=[g,_];o.push(T),t.push(T),e.rowHeights.push(i)}}),n.createElement(s.CulledList,{enableMaxHeightGrouping:l,items:o,listItemHeight:this.rowHeights,itemBuffer:c,className:a,renderRow:this.renderRow,scrollThreshold:u,onRangeInView:this.handleRangeInView});for(var m=Math.ceil(h/this.state.tilesPerRow),f=0;f<m;f++){var g=f*this.state.tilesPerRow,_=Math.min(g+this.state.tilesPerRow,h),T=[g,_];o.push(T),t.push(T)}return n.createElement(s.CulledList,{enableMaxHeightGrouping:l,items:o,listItemHeight:i,itemBuffer:c,className:a,renderRow:this.renderRow,scrollThreshold:u,onRangeInView:this.handleRangeInView})},t.defaultProps={enableMaxHeightGrouping:!1,numThresholdRows:10,tilePadding:16,tileHeight:160,maxTileWidth:160,labelHeight:40,logTileLoading:!1,scrollDeltaThreshold:1,showLabels:!0,getTileItem:function(e,t){return null},handleTTI:function(){}},t})(n.PureComponent);t.InfiniteTileGrid=h}),define("modules/clean/react/maestro/tile_grid_logger",["require","exports","external/immutable","modules/clean/js_client_stopwatch","modules/core/browser"],function(e,t,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e,t,n,i){var r=this;this.recordTileError=function(e){var t=Math.floor(e/r.numTilesPerPage);r.pagesWithThumbErrors.has(t)||(r.pagesWithThumbErrors=r.pagesWithThumbErrors.add(t))},this.recordTileLoaded=function(e,t,o){if(o){if(r.thumbsLoaded.has(e))return;r.thumbsLoaded=r.thumbsLoaded.add(e)}else{if(r.iconsLoaded.has(e))return;r.iconsLoaded=r.iconsLoaded.add(e)}var n=!1;n=r.numTiles%r.numTilesPerPage===0?e>=r.numTiles-r.numTilesPerPage:e>=r.numTiles-r.numTiles%r.numTilesPerPage;var i=r.numTilesPerPage;if(n){var a=r.numTiles%r.numTilesPerPage;0!==a&&(i=a)}var s=Math.floor(e/r.numTilesPerPage);if(o||!t){var l=r.numTilesFinalizedByPage,c=l.get(s)||0;r.numTilesFinalizedByPage=l.set(s,c+1)}if(0===s&&r.handleTTI){!(r.iconsLoaded.has(e)&&r.thumbsLoaded.has(e))&&(r.numTilesLoadedOnFirstPage++,r.numTilesLoadedOnFirstPage===i&&r.handleTTI())}o&&(r.pagesWithThumbs.has(s)||(r.pagesWithThumbs=r.pagesWithThumbs.add(s)),r.anyThumbLoadedTimeByPage.get(s)||(r.anyThumbLoadedTimeByPage=r.anyThumbLoadedTimeByPage.set(s,r.getTimeNow())),r.numTilesFinalizedByPage.get(s)===i&&(r.allThumbsLoadedTimeByPage=r.allThumbsLoadedTimeByPage.set(s,r.getTimeNow())))},this.pruneTrackedPages=function(){r.startTimeByPage.entrySeq().forEach(function(e){var t=e[0],o=e[1];!r.pagesToLog.has(t)&&!r.pagesCompletedLogging.has(t)&&r.getTimeNow()-o>2e3&&(r.startTimeByPage=r.startTimeByPage.delete(t))})},this.logCompletedPages=function(){r.pagesToLog.forEach(function(e){var t=r.startTimeByPage.get(e),o=Math.max(r.allThumbsLoadedTimeByPage.get(e),t),n=Math.max(r.anyThumbLoadedTimeByPage.get(e),t);return o&&!r.pagesWithThumbs.has(e)?void r.handlePageCompletedLogging(e):r.pagesWithThumbErrors.has(e)?void r.handlePageCompletedLogging(e):void(t&&o&&n&&(r.logPerfStats(e,t,n,o),r.handlePageCompletedLogging(e)))})},this.numTiles=e,this.numTilesPerPage=t,this.numTilesFinalizedByPage=o.List(),this.numTilesLoadedOnFirstPage=0,this.iconsLoaded=o.Set(),this.thumbsLoaded=o.Set(),this.startTimeByPage=o.Map(),this.allThumbsLoadedTimeByPage=o.Map(),this.anyThumbLoadedTimeByPage=o.Map(),this.pagesWithThumbErrors=o.Set(),this.pagesWithThumbs=o.Set(),this.pagesCompletedLogging=o.Set(),this.pagesToLog=o.Set(),this.handleTTI=i}return e.prototype.getTimeNow=function(){var e=i.performance(),t=-1;return e&&e.now&&(t=e.now()),t},e.prototype.updateNumTiles=function(e){this.numTiles>=e||(this.numTiles=e)},e.prototype.handlePageCompletedLogging=function(e){this.pagesCompletedLogging=this.pagesCompletedLogging.add(e),this.pagesToLog=this.pagesToLog.delete(e),this.startTimeByPage=this.startTimeByPage.delete(e),this.anyThumbLoadedTimeByPage=this.anyThumbLoadedTimeByPage.delete(e),this.allThumbsLoadedTimeByPage=this.allThumbsLoadedTimeByPage.delete(e)},e.logThumbLoadError=function(){n.JSStopwatch.recordTrace("visual_browse_thumb_load_error",{stopwatchName:"infinite_tile_grid_logging",traceTime:0})},e.logThumbRTT=function(e){n.JSStopwatch.recordTrace("visual_browse_thumb_rtt",{stopwatchName:"infinite_tile_grid_logging",traceTime:e})},e.prototype.logPerfStats=function(e,t,o,i){n.JSStopwatch.recordTrace("loaded_any_thumbs_page_"+e,{stopwatchName:"infinite_tile_grid_logging",traceTime:o-t}),n.JSStopwatch.recordTrace("loaded_all_thumbs_page_"+e,{stopwatchName:"infinite_tile_grid_logging",traceTime:i-t})},e})();t.InfiniteTileGridLogger=r}),function(){define("modules/clean/react/outside_event",["external/react","external/underscore","modules/clean/react/util"],function(e,t,o){var n,i,r,a,s;return s=o.mergeProps,a=e.createElement,e.DOM,r=function(o,n,i,r){var l,c,u;return l=null!=(u=o.displayName)?u:"UnnamedComponent",e.createClass({displayName:"Outside"+n+"Handled"+l,propTypes:(c={},c[""+i]=e.PropTypes.func,c[""+r]=e.PropTypes.func,c),componentDidMount:function(){return document.addEventListener(n,this._handleOutsideEvent,!1)},componentWillUnmount:function(){return document.removeEventListener(n,this._handleOutsideEvent,!1)},render:function(){var e,n;return n=s(t.omit(this.props,i,r,"children"),(e={},e[""+i]=this._handleInsideEvent,e)),a(o,n,this.props.children)},_handleOutsideEvent:function(e){var t;return"function"==typeof(t=this.props)[r]?t[r](e):void 0},_handleInsideEvent:function(e){var t,o;return e.stopPropagation(),"function"==typeof(t=e.nativeEvent).stopImmediatePropagation&&t.stopImmediatePropagation(),"function"==typeof(o=this.props)[i]?o[i](e):void 0}})},n=r("div","click","onClick","onOutsideClick"),i=r("div","mousedown","onMouseDown","onOutsideMouseDown"),{OutsideClickHandler:n,OutsideMouseDownHandler:i,addOutsideEventHandling:r}})}.call(this),define("modules/clean/react/selection",["require","exports","tslib","external/immutable"],function(e,t,o,n){"use strict";function i(e,t){return new r({selected:e?n.OrderedSet(e):n.OrderedSet(),anchor:t||(e?e[0]:null)})}Object.defineProperty(t,"__esModule",{value:!0});var r=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t})(n.Record({selected:null,anchor:null},"Selection"));t.Selection=r,t.createSelection=i}),define("modules/clean/sharing/browse_exports",["require","exports","tslib","modules/core/browser","modules/clean/sharing/gating_util","modules/clean/sharing/async_share_modal_util","modules/clean/sharing/public_folder/public_folder","modules/clean/sharing/wizard/async_wizard_modals"],function(e,t,o,n,i,r,a,s){"use strict";function l(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];e(["modules/clean/sharing/shared_content_link_sync_utils"],function(e){return e.mountSharedFolder.apply(e,t)})}function c(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(o){return[2,new Promise(function(o,n){e(["modules/clean/sharing/ui_util"],function(e){o(e.genContentManagerBridgeUri.apply(void 0,t))},n)})]})})}function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.__awaiter(this,void 0,void 0,function(){var t;return o.__generator(this,function(o){switch(o.label){case 0:return[4,c.apply(void 0,e)];case 1:return t=o.sent(),n.open_tab(t.toString()),[2]}})})}function d(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];e(["modules/clean/sharing/cdm_new_folder_modal"],function(e){e.showCdmNewFolderModal.apply(e,t)})}Object.defineProperty(t,"__esModule",{value:!0}),t.asyncMountSharedFolder=l,t.asyncGoToContentManagerForPath=u,t.asyncShowCdmNewFolderModal=d,t.GoldenGate=i.GoldenGate,t.asyncShowShareModal=r.asyncShowShareModal,t.asyncShowNewFolderShareModal=r.asyncShowNewFolderShareModal,t.asyncShowPrefilledShareModal=r.asyncShowPrefilledShareModal,t.asyncShowSharedContentLinkSyncModal=r.asyncShowSharedContentLinkSyncModal,t.makePublicFolderLink=a.makePublicFolderLink,t.shouldUsePublicFolderSharing=a.shouldUsePublicFolderSharing,t.showPublicFolderLinkModal=a.showPublicFolderLinkModal,t.asyncShowShareAFolderWizardModal=s.asyncShowShareAFolderWizardModal}),define("modules/clean/sharing/constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.PUBLIC=1]="PUBLIC",e[e.TEAM_ONLY=2]="TEAM_ONLY",e[e.PASSWORD=3]="PASSWORD",e[e.ONLY_YOU=99]="ONLY_YOU"})(t.SHMODEL_LINK_TOKEN_VISIBILITY||(t.SHMODEL_LINK_TOKEN_VISIBILITY={})),t.MEMBER_ACTION={LEAVE_A_COPY:"leave_a_copy",MAKE_EDITOR:"make_editor",MAKE_OWNER:"make_owner",MAKE_VIEWER:"make_viewer",MAKE_VIEWER_NO_COMMENT:"make_viewer_no_comment",REMOVE:"remove",ALL:["leave_a_copy","make_editor","make_owner","make_viewer","make_viewer_no_comment","remove"]},t.SNIPPET_SIZES={FILENAME:22,DISPLAY_NAME:26,EMAIL:30,OUT_OF_QUOTA_FOLDER_NAME:15},t.VALIDATE_PATH_PERMISSIONS={change_options:"canChangeOptions",disable_viewer_info:"disableViewerInfo",enable_viewer_info:"enableViewerInfo",invite_editor:"canInviteEditor",invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",unshare:"canUnshareFolder",relinquish_membership:"canRelinquishMembership"},t.VALIDATE_PATH_PERMISSIONS_CONFIDENTIAL_AWARE={change_options:"canChangeOptions",disable_viewer_info:"disableViewerInfo",enable_viewer_info:"enableViewerInfo",invite_editor:"canInviteEditor",invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",unshare:"canUnshareFolder",update_confidentiality:"canUpdateConfidentiality",relinquish_membership:"canRelinquishMembership"},t.ALPHA_FOLDER_METADATA_PERMISSIONS={change_options:"canChangeOptions",disable_viewer_info:"disableViewerInfo",edit_contents:"canEditContents",enable_viewer_info:"enableViewerInfo",invite_editor:"canInviteEditor",invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",leave_a_copy:"leaveACopy",relinquish_membership:"canRelinquishMembership",remove_download_policy:"removeDownloadPolicy",set_download_policy:"setDownloadPolicy",unmount:"canUnmountFolder",unshare:"canUnshareFolder",update_confidentiality:"canUpdateConfidentiality"},t.ALPHA_FILE_METADATA_PERMISSIONS={change_options:"canChangeOptions",disable_viewer_info:"disableViewerInfo",enable_viewer_info:"enableViewerInfo",invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",relinquish_membership:"canRelinquishMembership",remove_download_policy:"removeDownloadPolicy",set_download_policy:"setDownloadPolicy",unshare:"unshare"},t.FILE_METADATA_PERMISSIONS={invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",relinquish_membership:"canRelinquishMembership",unshare:"unshare"},t.SHARE_ACTION_ORIGIN_TYPE={BROWSE_FILE_ACTIONS:"BROWSE_FILE_ACTIONS",BROWSE_FILE_ROW:"BROWSE_FILE_ROW",BROWSE_GLOBAL_ACTIONS:"BROWSE_GLOBAL_ACTIONS",BROWSE_SHARED_FOLDER_BANNER:"BROWSE_SHARED_FOLDER_BANNER",CONTENT_MANAGER:"CONTENT_MANAGER",DESKTOP_CLIENT:"DESKTOP_CLIENT",EVENTS_PAGE:"EVENTS_PAGE",FILE_ROW_SHARE_MENU:"FILE_ROW_SHARE_MENU",GRANT_ACCESS:"GRANT_ACCESS",LEGACY_BROWSE:"LEGACY_BROWSE",LINKS_PAGE:"LINKS_PAGE",NOTIFICATION_WEB:"NOTIFICATION_WEB",OFFICE_INTEGRATION:"OFFICE_INTEGRATION",OUT_OF_QUOTA_MODAL:"OUT_OF_QUOTA_MODAL",PARENT_FOLDER_MODAL:"PARENT_FOLDER_MODAL",PREVIEW_PAGE:"PREVIEW_PAGE",PREVIEW_PAGE_FACEPILE:"PREVIEW_PAGE_FACEPILE",RECENTS:"RECENTS",SHARE:"SHARE",SHARE_LINK_MODAL:"SHARE_LINK_MODAL",SYNC_MODAL:"SYNC_MODAL",WIZARD:"WIZARD"},t.TOKEN_LINK_TYPE={SHARED_LINK:"s",SHARED_CONTENT_LINK:"c"}}),define("modules/clean/sharing/gating_util",["require","exports","modules/constants/sharing"],function(e,t,o){"use strict";function n(e){return o.TRUELINK.NO_COMMENT_ENABLED&&!!(null!=e?o.TRUELINK.NO_COMMENT_ENABLED[e.id]:void 0)}Object.defineProperty(t,"__esModule",{value:!0}),t.GoldenGate={canSetFolderConfidential:function(e){return Boolean(o.GOLDEN_GATE.CAN_SET_FOLDER_CONFIDENTIAL[e])},hasNewOwnershipModel:function(e){return Boolean(o.GOLDEN_GATE.HAS_NEW_OWNERSHIP_MODEL[e])},hasContentManagerAndSuperAdmin:function(e){return Boolean(o.GOLDEN_GATE.HAS_CONTENT_MANAGER_AND_SUPER_ADMIN[e])},hasContentManagerActionsDisabled:function(e){return Boolean(o.GOLDEN_GATE.HAS_CONTENT_MANAGER_ACTIONS_DISABLED[e])},hasContentManagerCdm:function(e){return Boolean(o.GOLDEN_GATE.HAS_CONTENT_MANAGER_CDM[e])},hasContentManagerTSDSwitch:function(e){return Boolean(o.GOLDEN_GATE.HAS_CONTENT_MANAGER_TSD_SWITCH[e])},hasContentManagerFolderRestore:function(e){return Boolean(o.GOLDEN_GATE.CAN_RESTORE_FOLDERS_IN_CM[e])},SHARING_TOTAL_LIMIT:o.GOLDEN_GATE.SHARING_TOTAL_LIMIT},t.isUserNoCommentEnabled=n}),define("modules/clean/sharing/public_folder/public_folder",["require","exports","modules/core/uri","modules/constants/public_folder_constants"],function(e,t,o,n){"use strict";function i(e,t){if(e.publicAppToken)return t;if(!e.isPublicFolderEnabled)return null;var o=(e.publicFolderFqPath||"/public").toLowerCase(),n=t.toLowerCase();return n===o?"/":n.startsWith(o+"/")?t.substring(o.length):null}function r(e,t){return null!=i(e,t)}function a(e,t,r,a){if(a)return null;var s,l=i(t,r);if(s=n.SHOULD_REDIRECT_URL?"u"+e+".dl.dropboxusercontent.com":"dl.dropboxusercontent.com",null!=l){var c=new o({scheme:"https",authority:s});return t.publicAppToken?(c.setPath("/spa/"+t.publicAppToken+l+"/data"),c.toString()):(c.setPath("/u/"+e+l),c.toString())}return null}function s(t){return new Promise(function(o,n){e(["external/react","modules/clean/react/modal","modules/clean/sharing/public_folder/modal"],function(e,n,i){var r=n.Modal,a=i.CopyPublicLinkModal;r.showInstance(e.createElement(a,{publicLink:t})),o()})})}Object.defineProperty(t,"__esModule",{value:!0}),t.shouldUsePublicFolderSharing=r,t.makePublicFolderLink=a,t.showPublicFolderLinkModal=s});
//# sourceMappingURL=pkg-browse-and-photos.min.js-vflLkBiZl.map