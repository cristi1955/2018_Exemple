define("modules/clean/react/home/api",["require","exports","tslib","modules/clean/ajax","external/underscore","modules/clean/api_v2/client","modules/core/exception","modules/clean/web_timing_logger","modules/clean/react/home/util/experiment_hook"],function(e,t,r,i,n,o,a,s,d){"use strict";var c=this;Object.defineProperty(t,"__esModule",{value:!0});var u=Promise.resolve({});t.makeRequest=function(e,t){void 0===t&&(t={});var n,o=function(n,o){(t.isBackground?i.SilentBackgroundRequest:i.WebRequest)(r.__assign({dataType:"json",success:n,error:function(r,i,n){if("abort"!==i){var s=e&&e.url||"no url",c=n?": '"+n+"'":"";a.reportStack("makeRequest to '"+s+"' failed - "+i+c,{severity:a.SEVERITY.NONCRITICAL,exc_extra:{errorThrown:n,textStatus:i,requestParams:e,requestOptions:t,runningExperiments:d.getRunningExperiments(),status:r.status,"exclog.exc_group":"homeapi:"+i+":"+n+":"+s}}),o(Error(n+" ("+s+")"))}}},e))};return t.useQueue?(n=new Promise(function(e,t){u.finally(function(){o(e,t)})}),u=n):n=new Promise(function(e,t){o(e,t)}),n};var p={},l=n.throttle(function(){n.size(p)>1&&a.reportStack("Multiple role activities",{severity:a.SEVERITY.NONCRITICAL,exc_extra:p}),n.each(p,function(e,r){t.makeRequest({url:"/home_feed/log_activities",type:"POST",data:{role:r,activities_json:JSON.stringify(n.pluck(e,"json")),send_ts:Date.now(),page_start_ts:window.performance&&window.performance.timing?window.performance.timing.navigationStart||window.performance.timing.fetchStart:void 0}},{isBackground:!0}).then(function(){return e.forEach(function(e){return e.resolve()})},function(){return e.forEach(function(e){return e.reject()})})}),p={}},1e3,{leading:!0,trailing:!0});t.logHomeActivity=function(e){var t=e.role,i=e.eventName,o=e.extra;return new Promise(function(e,a){return r.__awaiter(c,void 0,void 0,function(){return r.__generator(this,function(r){switch(r.label){case 0:return p[t]=p[t]||[],p[t].push({json:{event_name:i,event_time:Date.now(),extra:n.mapObject(o||{},function(e){return String(e)})},resolve:e,reject:a}),[4,s.waitForTTI()];case 1:return r.sent(),l(),[2]}})})})},t.setSectionVisibility=function(e,t,r){return(new o.ApiV2Client).rpc(e,"home/set_section_visibility",{section:t,visible:r})},t.createPaperDoc=function(e){return(new o.ApiV2Client).upload(e,"paper/docs/create",{import_format:"plain_text"},"")}}),define("modules/clean/react/home/starred/constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredResourceActionTypes={LOADING_INITIAL:"HOME_STARRED_LOADING_INITIAL",LOADING_ALL:"HOME_STARRED_LOADING_ALL",LOAD_SUCCESS:"HOME_STARRED_LOAD_SUCCESS",LOAD_FAILURE:"HOME_STARRED_LOAD_FAILURE",HIDE_EMPTY_SECTION:"HOME_STARRED_HIDE_EMPTY_SECTION"},t.NOT_PAPER_USER_ERROR="not_paper_user",t.StarredLoggingTypes={CLICK_STAR:"click_star",CLICK_UNSTAR:"click_unstar"},t.StarredLoadingTypes={INITIAL:"INITIAL",ALL:"ALL"},t.NUM_INITIAL_ITEMS=16}),define("modules/clean/react/home/util/experiment_hook",["require","exports"],function(e,t){"use strict";function r(e,t){this[e]=t}function i(e){o=e}function n(){return o}Object.defineProperty(t,"__esModule",{value:!0}),t.experimentOverride=r;var o={};t.setRunningExperiments=i,t.getRunningExperiments=n}),define("modules/clean/react/starred/actions",["require","exports","modules/clean/flux/dispatcher","modules/clean/react/starred/constants","modules/clean/react/starred/api","modules/clean/react/starred/model"],function(e,t,r,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(){}return e.fetchStatuses=function(t,a,s){return void 0===s&&(s=!1),s||e.markAsLoading(a),n.fetchStatuses(t,a).then(function(e){r.dispatch({type:i.StarredActionTypes.SET_STATUS,starredStatuses:o.statusResultsToStarredStatuses(e)})}).catch(function(e){return r.dispatch({type:i.StarredActionTypes.LOAD_FAILURE,idTypePairs:a}),Promise.reject(e)})},e.markAsLoading=function(e){r.dispatch({type:i.StarredActionTypes.LOADING,idTypePairs:e})},e.renameExternalResource=function(e,t,o){r.dispatch({type:i.StarredActionTypes.RENAME_EXTERNAL_RESOURCE,id:e,name:o});var a=n.updateExternalResource(e,o,!0);return a.catch(function(n){throw r.dispatch({type:i.StarredActionTypes.RENAME_EXTERNAL_RESOURCE,id:e,name:t}),n}),a},e.update=function(e,t,o,a,s,d){var c={id:t,type:o};r.dispatch({type:i.StarredActionTypes.LOADING,idTypePairs:[c]});var u,p;if(o===i.IdTypes.EXTERNAL_RESOURCE_ID){if(null===s||void 0===s)throw new TypeError("Name of external resource cannot be null/undefined");p=n.updateExternalResource(t,s,a,d)}else p=n.update(e,t,o,a);return p.then(function(){return u=a}).catch(function(e){throw u=!a,e}).finally(function(){r.dispatch({type:i.StarredActionTypes.SET_STATUS,starredStatuses:[{idTypePair:{id:t,type:o},starred:u}]});var e={url:t,name:s,isStarred:a};window.chrome&&window.chrome.runtime.sendMessage(i.StarExtensionId_PROD,e)}),p},e})();t.StarredActions=a}),define("modules/clean/react/starred/api",["require","exports","modules/clean/ajax"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e,t){var i=function(i,n){r.WebRequest({url:e,type:"POST",dataType:"json",data:t,success:i,error:function(e,t,r){return n(Error(r))}})};return new Promise(function(e,t){i(e,t)})};t.fetchStatuses=function(e,t){return i("/starred/get_status",{role:e,resources_json:JSON.stringify(t)})},t.update=function(e,t,r,n){return i("/starred/update",{role:e,resource_id:t,id_type:r,is_starred:n})},t.updateExternalResource=function(e,t,r,n){return i("/starred/update_external_resource",{url:e,name:t,is_starred:r,favicon_url:n})}}),define("modules/clean/react/starred/constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredLoadingState={LOADING:"LOADING",LOAD_SUCCESS:"LOAD_SUCCESS",LOAD_FAILED:"LOAD_FAILED"},t.StarredActionTypes={LOADING:"STARRED_LOADING",SET_STATUS:"STARRED_SET_STATUS",LOAD_FAILURE:"STARRED_LOAD_FAILURE",RENAME_EXTERNAL_RESOURCE:"STARRED_RENAME_EXTERNAL_RESOURCE"},t.IdTypes={ENCODED_FILE_OBJ_ID:"ENCODED_FILE_OBJ_ID",EXTERNAL_RESOURCE_ID:"EXTERNAL_RESOURCE_ID",PAPER_ID_PATH:"PAPER_ID_PATH"},t.StarExtensionId_DEV="bkoifdjjfabbedgjlkmkcabdpajmmlhd",t.StarExtensionId_PROD="hjdobpfegefofikebjlabkpjlndkfefg"}),define("modules/clean/react/starred/id_type_pair",["require","exports"],function(e,t){"use strict";function r(e){return e.type+":"+e.id}function i(e){return e.slice(e.indexOf(":")+1)}Object.defineProperty(t,"__esModule",{value:!0}),t.idTypePairToString=r,t.idFromIdTypePairString=i}),define("modules/clean/react/starred/model",["require","exports"],function(e,t){"use strict";function r(e){return e.map(function(e){var t=e.id,r=e.type,i=e.is_starred,n=e.canonical_id,o=e.canonical_id_type,a={idTypePair:{id:t,type:r},starred:i};return n&&o&&(a.canonicalIdTypePair={id:n,type:o}),a})}Object.defineProperty(t,"__esModule",{value:!0}),t.statusResultsToStarredStatuses=r}),define("modules/clean/react/starred/star",["require","exports","tslib","external/classnames","external/react","modules/clean/react/starred/starred_activity_logger","modules/clean/react/css","modules/clean/react/starred/actions","modules/clean/react/starred/store","modules/clean/react/title_bubble","modules/core/i18n","modules/core/notify","external/spectrum/icon_star"],function(e,t,r,i,n,o,a,s,d,c,u,p,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=(function(e){function t(t){var r=e.call(this,t)||this;return r.onStoreUpdate=function(){var e=r.getStateFromStore();r.setState(e)},r.onClick=function(e){if(e.stopPropagation(),e.preventDefault(),!r.state.isLoading){var t=!r.state.isStarred;t?o.starredActivityLogger.logClickStar(r.props.id,r.props.idType,r.props.role):o.starredActivityLogger.logClickUnstar(r.props.id,r.props.idType,r.props.role),r.props.onStarClick&&r.props.onStarClick(t),s.StarredActions.update(r.props.role,r.props.id,r.props.idType,t,r.props.itemName).catch(function(e){var i;i=r.props.itemName?t?u._("There was a problem starring %(item_name)s").format({item_name:r.props.itemName}):u._("There was a problem unstarring %(item_name)s").format({item_name:r.props.itemName}):t?u._("There was a problem starring your selection"):u._("There was a problem unstarring your selection"),p.error(i)})}},r.state=r.getStateFromStore(),r.removeStoreListener=d.StarredStore.addListener(r.onStoreUpdate),r}return r.__extends(t,e),t.prototype.componentWillUnmount=function(){this.removeStoreListener&&this.removeStoreListener()},t.prototype.componentWillReceiveProps=function(e){this.props.id===e.id&&this.props.idType===e.idType||this.setState(this.getStateFromStore(e))},t.prototype.getStateFromStore=function(e){void 0===e&&(e=this.props);var t={id:e.id,type:e.idType};return{isLoading:d.StarredStore.getIsLoading(t),isStarred:d.StarredStore.getIsStarred(t)}},t.prototype.getTooltipContent=function(){return this.state.isStarred?u._("Remove from Starred"):u._("Add to Starred")},t.prototype.render=function(){if(void 0===this.state.isStarred)return null;var e={star__toggle:!0,"star__toggle--starred":this.state.isStarred,"star__toggle--unstarred":!this.state.isStarred,"star__toggle--loading":this.state.isLoading};return n.createElement(c,{content:this.getTooltipContent(),position:this.props.tooltipPosition},n.createElement("button",{className:i(e),role:"button","aria-pressed":this.state.isStarred,"aria-label":"Star",onClick:this.onClick,onDoubleClick:this.onClick},n.createElement(l.IconStar,{selected:this.state.isStarred||this.state.isLoading})))},t.displayName="Star",t.defaultProps={tooltipPosition:c.POSITIONS.TOP},t})(n.PureComponent);t.Star=a(S,["/static/css/starred/star-vfl_TTD8D.css"])}),define("modules/clean/react/starred/starred_activity_logger",["require","exports","modules/clean/react/home/api","modules/clean/react/home/starred/constants"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}return e.prototype.logClickStar=function(e,t,n){return r.logHomeActivity({eventName:i.StarredLoggingTypes.CLICK_STAR,role:n,extra:{resource_id:e,id_type:t}})},e.prototype.logClickUnstar=function(e,t,n){return r.logHomeActivity({eventName:i.StarredLoggingTypes.CLICK_UNSTAR,role:n,extra:{resource_id:e,id_type:t}})},e})();t.StarredActivityLogger=n,t.starredActivityLogger=new n}),define("modules/clean/react/starred/store",["require","exports","tslib","external/underscore","modules/clean/flux/dispatcher","modules/clean/flux/flux_store","modules/clean/react/starred/constants","modules/clean/react/home/starred/constants","modules/clean/react/starred/id_type_pair"],function(e,t,r,i,n,o,a,s,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){var t=e.call(this,n)||this;return t.idsToLoadingState={},t.idsToStarred={},t}return r.__extends(t,e),t.prototype.getLoadingStates=function(){return this.idsToLoadingState},t.prototype.hasIdTypePair=function(e){return this.idsToLoadingState.hasOwnProperty(d.idTypePairToString(e))},t.prototype.getLoadingState=function(e){return this.idsToLoadingState[d.idTypePairToString(e)]},t.prototype.getIsStarred=function(e){return this.idsToStarred[d.idTypePairToString(e)]},t.prototype.getAllStarredPairStrings=function(){return i.keys(i.pick(this.idsToStarred,function(e){return e}))},t.prototype.getIsLoading=function(e){return this.getLoadingState(e)===a.StarredLoadingState.LOADING},t.prototype.onLoading=function(e){var t={};e.forEach(function(e){return t[d.idTypePairToString(e)]=a.StarredLoadingState.LOADING}),this.idsToLoadingState=r.__assign({},this.idsToLoadingState,t)},t.prototype.onSetStatus=function(e){void 0===e&&(e=[]);var t={},i={};e.forEach(function(e){var r=d.idTypePairToString(e.idTypePair);t[r]=a.StarredLoadingState.LOAD_SUCCESS,i[r]=e.starred}),this.idsToLoadingState=r.__assign({},this.idsToLoadingState,t),this.idsToStarred=r.__assign({},this.idsToStarred,i)},t.prototype.onLoadFailure=function(e){var t=this,i={};e.forEach(function(e){var r=d.idTypePairToString(e),n=t.idsToLoadingState[r];void 0!==n&&n!==a.StarredLoadingState.LOADING||(i[r]=a.StarredLoadingState.LOAD_FAILED)}),this.idsToLoadingState=r.__assign({},this.idsToLoadingState,i)},t.prototype.__onDispatch=function(e){var t=e.action;switch(t.type){case a.StarredActionTypes.LOADING:this.onLoading(t.idTypePairs);break;case a.StarredActionTypes.SET_STATUS:case s.StarredResourceActionTypes.LOAD_SUCCESS:this.onSetStatus(t.starredStatuses);break;case a.StarredActionTypes.LOAD_FAILURE:this.onLoadFailure(t.idTypePairs);break;default:return}this.__emitChange()},t})(o);t._StarredStoreClass=c,t.StarredStore=new c});
//# sourceMappingURL=pkg-starred.min.js-vflLcVcu6.map