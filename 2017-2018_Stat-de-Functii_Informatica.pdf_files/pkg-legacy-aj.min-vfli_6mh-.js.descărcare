(function(){define("modules/clean/avatar/group_avatar",["external/react","modules/core/user_i18n","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar_with_color","modules/clean/avatar/size","modules/clean/static_urls"],function(e,t,s,r,o,n){var i,a,u;return i=o.VALID_AVATAR_DIMENSIONS,u=n.static_url,a=e.createElement,e.createClass({displayName:"GroupAvatar",propTypes:{dimension:e.PropTypes.oneOf(i).isRequired,group:e.PropTypes.object.isRequired,optionalClass:e.PropTypes.string},render:function(){var e;return e={dimension:this.props.dimension,photoUrl:this.props.group.is_team_group?u("/static/images/icons/team_32-vflk8mBzO.png"):void 0,shape:"SQUARE",name:this.props.group.name,optionalClass:this.props.optionalClass,defaultAvatar:a(r,{dimension:this.props.dimension,initials:t.getInitials(this.props.group.name).toUpperCase(),name:this.props.group.name,shape:"SQUARE",optionalClass:this.props.optionalClass})},a(s,e)}})})}).call(this),function(){define("modules/clean/groups/add_group_members_modal",["jquery","external/react","modules/core/i18n","modules/core/notify","modules/clean/ajax","modules/clean/react/modal","modules/clean/groups/group_members_form","modules/clean/groups/utils","modules/clean/viewer"],function(e,t,s,r,o,n,i,a,u){var l,p,m,c,d,h;return p=s._,d=s.ungettext,l=n.Modal,m=t.DOM,c=t.PropTypes,h=u.get_viewer(),t.createClass({displayName:"AddGroupMembersModal",propTypes:{group:c.object,insideAdminConsole:c.bool,onGroupChanged:c.func},getInitialState:function(){return{canProceed:!1,submitting:!1}},componentDidMount:function(){return e(".contacts-tokenizer-input").select()},_canProceed:function(){var e,t;return(null!=(e=this.refs.members)?e.areAllContactsValid():void 0)&&!(null!=(t=this.refs.members)?t.isEmpty():void 0)},onClickAddMembers:function(e){return e.preventDefault(),this.refs.members.getFinalData((function(e){return function(t){var s,n;if(n=t.emails,s=e._canProceed(),e.setState({canProceed:s}),s)return e.setState({submitting:!0}),o.WebRequest({url:"/groups_ajax/add_users_to_group",data:{members:JSON.stringify(n),group_id:e.props.group.id},subject_user:h.work_user,complete:function(){if(e.isMounted())return e.setState({submitting:!1})},success:function(t){return t=JSON.parse(t),r.success(d("Adding member...","Adding members...",n.length)),l.close(),e.props.onGroupChanged(!0,null)},error:function(t){if(a.isGroupDeleted(t))return l.close(),a.redirectToGroupsPage(e.props.insideAdminConsole)}})}})(this))},onMembersFormChange:function(){return this.setState({canProceed:this._canProceed()})},render:function(){return t.createElement(l,{title:p("Add members to “%(group_name)s”").format({group_name:this.props.group.name}),className:"no-scroll-modal",acceptButtonText:p("Add members"),dismissButtonText:p("Cancel"),onAccept:this.onClickAddMembers,acceptButtonDisabled:!this.state.canProceed,submitting:this.state.submitting,ref:"modal"},t.createElement(i,{ref:"members",group:this.props.group,onChange:this.onMembersFormChange,errorMessageSpaceFixed:!1,includeCustomMessage:!1,emailPlaceholder:p("Add names or emails"),disallowGroupMembers:!0}),m.label({},m.br({}),p("Giving new members access to all of this group’s shared folders might take a little while.")))}})})}.call(this),function(){define("modules/clean/groups/create_group_modal",["external/react","modules/core/i18n","modules/clean/ajax","modules/clean/react/modal","modules/clean/react/input","modules/clean/react/tooltip","modules/clean/viewer","modules/clean/groups/group_members_form","modules/clean/groups/utils","modules/constants/teams","modules/core/browser"],function(e,t,s,r,o,n,i,a,u,l,p){var m,c,d,h,g,f,_,b,v,w;return f=t._,d=r.Modal,h=n.Tooltip,g=n.TooltipPosition,c=l.GROUP_JOIN_POLICY_REQUEST_TO_JOIN,m=l.GROUP_JOIN_POLICY_OPEN,_=e.createElement,b=e.DOM,v=e.PropTypes,w=i.get_viewer(),e.createClass({displayName:"CreateGroupModal",propTypes:{teamName:v.string,isLimitedTeam:v.bool,canHaveAdminUi:v.bool,insideAdminConsole:v.bool,enhancedGroupsEnabled:v.bool,groupJoinPolicyEnabled:v.bool,onCreateCallback:v.func},getInitialState:function(){return{createGroupFolderChecked:!1,groupName:"",groupDescription:"",submitting:!1,errors:null,isAdminManaged:!0,joinableChecked:!1}},groupNameIsValid:function(){return this.state.groupName.length<=u.MAX_GROUP_NAME_LEN},groupDescriptionIsValid:function(){return this.state.groupDescription.length<=u.MAX_GROUP_DESCRIPTION_LEN},getLocalNameError:function(){if(!this.groupNameIsValid())return{message_text:f("The group name should be under %(max_len)d characters").format({max_len:u.MAX_GROUP_NAME_LEN})}},getLocalDescriptionError:function(){if(!this.groupDescriptionIsValid())return{message_text:f("The group description should be under %(max_len)d characters").format({max_len:u.MAX_GROUP_DESCRIPTION_LEN})}},getViewerMember:function(){return{name:w.display_name,email:w.work_email,is_owner:this.props.isLimitedTeam||!this.props.canHaveAdminUi||!this.state.isAdminManaged}},canProceed:function(){var e,t;return e=!this.state.submitting&&""!==this.state.groupName.trim()&&this.groupNameIsValid(),this.props.enhancedGroupsEnabled&&(e=e&&(null!=(t=this.refs.members)?t.areAllContactsValid():void 0)),e},onWillDismiss:function(e){if(!this.props.insideAdminConsole)return p.set_hash("groups")},onClickCreate:function(e){var t,r,o;if(null!=e&&e.preventDefault(),this.canProceed())return this.setState({submitting:!0}),r=this.state.joinableChecked?m:c,o=(function(e){return function(t){return s.WebRequest({url:"/groups_ajax/make_new_group_with_users",data:{name:e.state.groupName,description:e.state.groupDescription,members:JSON.stringify(t),create_folder:e.state.createGroupFolderChecked,is_admin_managed:e.isAdminManagedSelected(),group_join_policy:r},subject_user:w.work_user,error:function(t,s,r){return e.setState({submitting:!1,errors:(function(){try{return JSON.parse(r)}catch(e){}})()})},success:function(t){var s,r;return t=JSON.parse(t),r=e.props.insideAdminConsole?"/"+t.data.id:"groups/"+t.data.id,p.set_hash(r),"function"==typeof(s=e.props).onCreateCallback&&s.onCreateCallback(),d.close()}})}})(this),t=[this.getViewerMember()],this.props.enhancedGroupsEnabled?this.refs.members.getFinalData(function(e){return o(t.concat(e.emails))}):o(t)},onChangeGroupType:function(e){return this.setState({isAdminManaged:"true"===e.target.value})},onMembersFormChange:function(){return this.setState({canProceed:this.canProceed()})},renderGroupTypeSelect:function(){return b.div({className:"group-type"},b.label({className:"tooltip-label group-kind-label"},f("What kind of group is it?"),e.createElement(h,{position:g.RIGHT,tooltip_contents:f("In company-managed groups, admins are responsible for adding and removing members. In user-managed groups, users approve new members, and existing members can leave whenever they like."),tooltip_classname:"group-kind-tooltip-bubble"},b.img({src:"/static/images/sprites/teams/tool_tip_icon-vflUvSKa8.png",alt:f("More information")}))),b.div({className:"group-type-selection"},b.label({htmlFor:"admin-managed-radio",className:"label-text"},b.input({type:"radio",name:"group-type-radio",id:"admin-managed-radio",defaultChecked:this.state.isAdminManaged,onChange:this.onChangeGroupType,value:!0}),f("Company-managed group")),b.br({}),b.label({htmlFor:"member-managed-radio",className:"label-text"},b.input({type:"radio",name:"group-type-radio",id:"member-managed-radio",defaultChecked:!this.state.isAdminManaged,onChange:this.onChangeGroupType,value:!1}),f("User-managed group"))))},canBeAdminManaged:function(){return!this.props.isLimitedTeam&&this.props.canHaveAdminUi},isAdminManagedSelected:function(){return this.canBeAdminManaged()&&this.state.isAdminManaged},_renderEnhancedGroupsCreateModalContent:function(){return b.form({onSubmit:this.onClickCreate},b.label({className:"label-description"},f("Group info")),e.createElement(o.text,{className:"group-name-input",placeholder:f("Name this group"),onChange:(function(e){return function(t){return e.setState({groupName:t.target.value})}})(this),autofocus:!0,"error-after":!1,error:this.getLocalNameError()}),e.createElement(o.textarea,{className:"group-description-input",placeholder:f("Add an optional description"),onChange:(function(e){return function(t){return e.setState({groupDescription:t.target.value})}})(this),autofocus:!1,"error-after":!0,error:this.getLocalDescriptionError()}),b.div({className:"group-members"},b.label({className:"label-description"},f("Members (optional)")),_(a,{ref:"members",onChange:this.onMembersFormChange,errorMessageSpaceFixed:!1,includeCustomMessage:!1,emailPlaceholder:f("Enter names or emails"),disallowGroupMembers:!1,disallowCurrentUser:!0})),b.div({className:"group-folder-container"},b.div({className:"create-group-folder"},b.input({type:"checkbox",onChange:(function(e){return function(t){return e.setState({createGroupFolderChecked:t.target.checked})}})(this)}),b.label({},f("Create a shared folder for this group"))),this.props.groupJoinPolicyEnabled?b.div({className:"join-policy"},b.input({type:"checkbox",onChange:(function(e){return function(t){return e.setState({joinableChecked:t.target.checked})}})(this),disabled:this.isAdminManagedSelected()}),b.label({},f("Allow anyone at %(team_name)s to join").format({team_name:this.props.teamName})),this.isAdminManagedSelected()?b.label({className:"disable-join-policy-message"},f(" Only permitted for user-managed groups.")):void 0):void 0),this.canBeAdminManaged()?this.renderGroupTypeSelect():void 0)},_renderCreateModalContent:function(){return b.form({onSubmit:this.onClickCreate},b.label({className:"label-description"},f("Group name")),e.createElement(o.text,{className:"group-name-input",placeholder:f("Marketing, Design, etc.",{comment:"These are example group names."}),onChange:(function(e){return function(t){return e.setState({groupName:t.target.value})}})(this),autofocus:!0,error:this.getLocalNameError()}),this.canBeAdminManaged()?this.renderGroupTypeSelect():void 0)},render:function(){return _(d,{title:f("Create a new group"),className:this.props.enhancedGroupsEnabled?"create-group-modal-enhanced":"create-group-modal",acceptButtonText:f("Create"),acceptButtonDisabled:!this.canProceed(),dismissButtonText:f("Cancel"),onAccept:this.onClickCreate,onDismissCompleted:this.onWillDismiss,submitting:this.state.submitting},this.props.enhancedGroupsEnabled?this._renderEnhancedGroupsCreateModalContent():this._renderCreateModalContent())}})})}.call(this),function(){var e=function(e,t){return(+e%(t=+t)+t)%t};define("modules/clean/groups/group_member_list",["external/underscore","external/classnames","external/react","modules/core/i18n","modules/core/user_i18n","modules/core/notify","modules/clean/ajax","modules/clean/viewer","modules/clean/react/button","modules/clean/react/table","modules/clean/react/sprite","modules/clean/react/bubble_menu","modules/clean/react/dbox_app_promo","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar_with_color","modules/clean/groups/simple_modals","modules/clean/groups/utils","modules/clean/static_urls"],function(t,s,r,o,n,i,a,u,l,p,m,c,d,h,g,f,_,b){var v,w,y,M,C,T,N,S,A,D,R,E,G,P,k,I;return T=o._,k=o.ungettext,w=c.BubbleMenu,y=c.BubbleMenuItem,v=d.Actionable,D=f.showLeaveGroupModal,G=f.showRemoveUserModal,E=f.showRemoveOwnerPermissionsModal,R=f.showMakeOwnerModal,P=b.static_url,S=r.DOM,A=r.PropTypes,I=u.get_viewer(),N=function(e,t){var s,r,o;r={};for(o in e)s=e[o],r[o]=s.bind(t);return r},M=r.createClass({displayName:"MemberList",propTypes:{group:A.object,canHaveAdminUi:A.bool,onGroupChanged:A.func,isMaestroDesign:A.bool,insideAdminConsole:A.bool},viewerIsOwner:function(){return this.props.group.is_owner},canManageGroup:function(){return!this.props.group.is_team_group&&(this.props.canHaveAdminUi||this.viewerIsOwner())},onRemoveUserSuccess:function(e){return this.removeMemberUser(e),this.refs.members.forceRefresh(),this.props.onGroupChanged(!1,this.props.group)},onClickRemoveUser:function(e){return e.user_id===I.work_user.id?D(this.props.group,this.props.insideAdminConsole,!1,function(){}):G(this.props.group,this.props.insideAdminConsole,e,this.onRemoveUserSuccess.bind(this))},onClickApproveJoinReq:function(e){return a.WebRequest({url:"/groups_ajax/approve",data:{group_id:this.props.group.id,requesting_user_id:e.user_id},subject_user:I.work_user,success:(function(t){return function(s){return i.success(T("Request approved.")),t.convertPendingUserToMemberLocally(e),t.refs.members.forceRefresh(),t.props.onGroupChanged(!1,t.props.group)}})(this),error:(function(e){return function(t){if(_.isGroupDeleted(t))return _.redirectToGroupsPage(e.props.insideAdminConsole)}})(this)})},onClickRemoveJoinReq:function(e){return a.WebRequest({url:"/groups_ajax/remove",data:{group_id:this.props.group.id,requesting_user_id:e.user_id},subject_user:I.work_user,success:(function(t){return function(s){return i.success(T("Request removed.")),t.removePendingUser(e),t.refs.members.forceRefresh()}})(this),error:(function(e){return function(t){if(_.isGroupDeleted(t))return _.redirectToGroupsPage(e.props.insideAdminConsole)}})(this)})},removeMemberUser:function(e){var s;if(s=t.indexOf(this.props.group.users,e),s>-1)return this.props.group.users.splice(s,1),this.props.group.user_count-=1,this.props.group.owners=this.props.group.owners.filter(function(t){return t.email!==e.email})},removePendingUser:function(e){var s;if(s=t.indexOf(this.props.group.pending_req_users,e),s>-1)return this.props.group.pending_req_users.splice(s,1)},convertPendingUserToMemberLocally:function(e){return this.removePendingUser(e),e.localized_joined_ts=T("Just now"),e.is_pending=!1,this.props.group.users.unshift(e),this.props.group.user_count+=1},renderSettingsForPendingMember:function(e){var t,s,o;return this.props.isMaestroDesign?(s=String.fromCharCode("176"),o=S.button({className:"settings-button"},s+s+s),S.div({className:"approve-options-container u-mar-top-xxs"},r.createElement(l.button,{importance:"secondary",className:"approve-join-req-button",onClick:this.onClickApproveJoinReq.bind(this,e)},T("Approve")),r.createElement(w,{targetButton:o,position:w.POSITIONS.BOTTOM_LEFT,shouldShowArrow:!1,verticalDisplacement:-3,items:[r.createElement(y,{onClick:this.onClickRemoveJoinReq.bind(this,e)},T("Remove request"))]}))):(t=S.button({className:"remove-request-button",onClick:this.onClickRemoveJoinReq.bind(this,e)},S.img({src:"/static/images/x-vflYKfRuL.png",alt:T("Remove join request")})),S.span({className:"pending-request-buttons"},r.createElement(v,{handler:this.onClickApproveJoinReq.bind(this,e)},S.button({className:"button-secondary button-small action-button approve-join-req-button"},T("Approve"))),t))},renderSettingsForMember:function(e){var t,s,o;return this.props.group.is_admin_managed?S.button({className:"remove-user-button",onClick:this.onClickRemoveUser.bind(this,e)},S.img({src:P("/static/images/x-vflYKfRuL.png"),alt:T("Remove user")})):(this.props.isMaestroDesign?(t=String.fromCharCode("176"),s=S.button({className:"settings-button"},t+t+t)):s=S.button({className:"settings-button"},r.createElement(m,{group:"web",name:"gear",alt:T("Member settings")})),o=[r.createElement(y,{onClick:this.onClickRemoveUser.bind(this,e)},T("Remove user"))],e.is_owner?o.push(r.createElement(y,{onClick:E.bind(this,this.props.group,this.props.insideAdminConsole,e,this.props.onGroupChanged)},T("Remove manager permissions"))):e.can_be_owner&&o.push(r.createElement(y,{onClick:R.bind(this,this.props.group,this.props.insideAdminConsole,e,this.props.onGroupChanged)},T("Make manager"))),r.createElement(w,{targetButton:s,position:w.POSITIONS.BOTTOM_LEFT,shouldShowArrow:!1,verticalDisplacement:-5,items:o}))},localSortUsers:function(e,s){var r,o,n,i,a;return a=this.props.group.users.slice(0),r={},t.zip("áéíóú","aeiou").map(function(e){return this[e[0]]=e[1]},r),n=function(e,t){return e.sort(function(e,s){var o,n;return o=e[t],n=s[t],"name"===t&&(o=e[t].replace(/([\xe1\xe9\xed\xf3\xfa])/g,function(e){return r[e]}).toLowerCase(),n=s[t].replace(/([\xe1\xe9\xed\xf3\xfa])/g,function(e){return r[e]}).toLowerCase()),o<n?-1:o>n?1:0})},i=e.sortColumn,"localized_joined_ts"===i&&(i="joined_ts"),"status"===i&&(i="is_owner"),n(a,i),e.sortDir===p.DESC_DIR&&a.reverse(),o=this.buildMemberList(this.props.group.pending_req_users,a),s(null,{rows:o,total:o.length})},buildMemberList:function(e,t){return this.canManageGroup()?e.concat(t):t},columnTypes:{displayName:function(e){return{field:"name",header:T("Name"),classes:{"display-name-column":!0},width:e,render:(function(e){return function(t){var o;return o=s({"u-mar-right-s":!0,"u-mar-left-xs":!e.props.isMaestroDesign,"u-mar-left-s":e.props.isMaestroDesign}),[r.createElement(h,{dimension:e.props.isMaestroDesign?32:24,photoUrl:t.photo_url,optionalClass:o,defaultAvatar:r.createElement(g,{dimension:e.props.isMaestroDesign?32:24,initials:n.getInitials(t.name||t.email),name:t.name,shape:"CIRCLE",optionalClass:o})}),S.span({className:e.props.isMaestroDesign?"user-info":"user-name"},S.span({className:s("user-name-part",{pending:t.is_pending,"user-info__text":e.props.isMaestroDesign})},t.name?t.name:"-"),e.props.isMaestroDesign?S.div({className:"user-info__subtext"},t.email):S.span({className:"user-status"},t.is_owner?" · "+T("Manager"):t.is_pending?" · "+T("Pending"):void 0))]}})(this)}},userEmail:function(e){return{field:"email",header:T("Email"),classes:{"email-column":!0},width:e,render:function(e){return S.span({className:"user-email"},S.span({className:s({pending:e.is_pending})},e.email))}}},userStatus:function(e){return{field:"status",header:T("Status"),classes:{"user-status-column":!0},width:e,initialSortDir:p.DESC_DIR,render:function(e){return T(e.is_owner?"Manager":e.is_pending?"Pending":"Member")}}},joinedDate:function(e){return{field:"localized_joined_ts",header:T("Joined"),width:e,render:(function(e){return function(t){return e.props.isMaestroDesign&&t.is_pending?S.span({className:"pending-request-buttons"},r.createElement(v,{handler:e.onClickApproveJoinReq.bind(e,t)},S.button({className:"button-secondary button-small action-button approve-join-req-button"},T("Approve")))):t.localized_joined_ts}})(this)}},settings:function(e){return{width:e,classes:{"settings-column":!0},sortable:!1,render:(function(e){return function(t){return e.canManageGroup()?t.is_pending?e.renderSettingsForPendingMember(t):e.renderSettingsForMember(t):""}})(this)}}},componentWillMount:function(){return this.columnTypes=N(this.columnTypes,this)},tableRowClasses:function(e){return this.props.isMaestroDesign&&e.is_pending?{"pending-member-row":!0}:{}},renderMemberTable:function(){var e;return this.buildMemberList(this.props.group.pending_req_users,this.props.group.users),e=this.props.isMaestroDesign?this.canManageGroup?[this.columnTypes.displayName("50%"),this.columnTypes.userStatus("25%"),this.columnTypes.settings("25%")]:[this.columnTypes.displayName("50%"),this.columnTypes.userStatus("50%")]:this.canManageGroup?[this.columnTypes.displayName(300),this.columnTypes.userEmail(250),this.columnTypes.joinedDate(147),this.columnTypes.settings(103)]:[this.columnTypes.displayName(300),this.columnTypes.userEmail(250),this.columnTypes.joinedDate(250)],r.createElement(p,{ref:"members",columns:e,initialSortColumn:this.props.isMaestroDesign?1:0,emptyMessage:T("This group has no members."),rowsPerPage:1e6,onRequestData:this.localSortUsers,classes:{"grey-style":!0},rowClasses:this.tableRowClasses})},render:function(){return S.div({className:"member-list-container"},S.div({className:"group-user-info"},!this.props.isMaestroDesign||this.props.insideAdminConsole?S.div({className:"member-count"},k("%(n)d member","%(n)d members",this.props.group.user_count).format({n:this.props.group.user_count})):void 0),this.renderMemberTable())}}),C=r.createClass({displayName:"MemberListPaginated",propTypes:{group:A.object,canHaveAdminUi:A.bool,onGroupChanged:A.func,isMaestroDesign:A.bool,insideAdminConsole:A.bool,search_query:A.string},viewerIsOwner:function(){return this.props.group.is_owner},canManageGroup:function(){return!this.props.group.is_team_group&&(this.props.canHaveAdminUi||this.viewerIsOwner())},onRemoveUserSuccess:function(t){var s;return s=this.props.group.user_count+this.props.group.pending_req_count-1,0!==e(s,_.MAX_ROWS_PER_PAGE)||this.props.isMaestroDesign?this.refs.members.forceRefresh():this.props.onGroupChanged(!0,this.props.group)},onClickRemoveUser:function(e){return e.user_id===I.work_user.id?D(this.props.group,this.props.insideAdminConsole,!1,function(){}):G(this.props.group,this.props.insideAdminConsole,e,this.onRemoveUserSuccess.bind(this))},onClickApproveJoinReq:function(e){return a.WebRequest({url:"/groups_ajax/approve",data:{group_id:this.props.group.id,requesting_user_id:e.user_id},subject_user:I.work_user,success:(function(e){return function(t){return i.success(T("Request approved.")),e.refs.members.forceRefresh()}})(this),error:(function(e){return function(t){if(_.isGroupDeleted(t))return _.redirectToGroupsPage(e.props.insideAdminConsole)}})(this)})},onClickRemoveJoinReq:function(e){return a.WebRequest({url:"/groups_ajax/remove",data:{group_id:this.props.group.id,requesting_user_id:e.user_id},subject_user:I.work_user,success:(function(e){return function(t){return i.success(T("Request removed.")),e.refs.members.forceRefresh()}})(this),error:(function(e){return function(t){if(_.isGroupDeleted(t))return _.redirectToGroupsPage(e.props.insideAdminConsole)}})(this)})},renderSettingsForPendingMember:function(e){var t,s,o;return this.props.isMaestroDesign?(s=String.fromCharCode("176"),o=S.button({className:"settings-button"},s+s+s),S.div({className:"approve-options-container u-mar-top-xxs"},r.createElement(l.button,{importance:"secondary",className:"approve-join-req-button",onClick:this.onClickApproveJoinReq.bind(this,e)},T("Approve")),r.createElement(w,{targetButton:o,position:w.POSITIONS.BOTTOM_LEFT,shouldShowArrow:!1,verticalDisplacement:-3,items:[r.createElement(y,{onClick:this.onClickRemoveJoinReq.bind(this,e)},T("Remove request"))]}))):(t=S.button({className:"remove-request-button",onClick:this.onClickRemoveJoinReq.bind(this,e)},S.img({src:"/static/images/x-vflYKfRuL.png",alt:T("Remove join request")})),S.span({className:"pending-request-buttons"},r.createElement(v,{handler:this.onClickApproveJoinReq.bind(this,e)},S.button({className:"button-secondary button-small action-button approve-join-req-button"},T("Approve"))),t))},renderSettingsForMember:function(e){var t,s,o;return this.props.group.is_admin_managed?S.button({className:"remove-user-button",onClick:this.onClickRemoveUser.bind(this,e)},S.img({src:"/static/images/x-vflYKfRuL.png",alt:T("Remove user")})):(this.props.isMaestroDesign?(t=String.fromCharCode("176"),s=S.button({className:"settings-button"},t+t+t)):s=S.button({className:"settings-button"},r.createElement(m,{group:"web",name:"gear",alt:T("Member settings")})),o=[r.createElement(y,{onClick:this.onClickRemoveUser.bind(this,e)},T("Remove user"))],e.is_owner?o.push(r.createElement(y,{onClick:E.bind(this,this.props.group,this.props.insideAdminConsole,e,this.props.onGroupChanged)},T("Remove manager permissions"))):e.can_be_owner&&o.push(r.createElement(y,{onClick:R.bind(this,this.props.group,this.props.insideAdminConsole,e,this.props.onGroupChanged)},T("Make manager"))),r.createElement(w,{targetButton:s,position:w.POSITIONS.BOTTOM_LEFT,shouldShowArrow:!1,verticalDisplacement:-5,items:o}))},columnTypes:{displayName:function(e){return{field:"display_name",header:T("Name"),classes:{"display-name-column":!0},width:e,sortable:!this.props.search_query,render:(function(e){return function(t){var o;return o=s({"u-mar-right-s":!0,"u-mar-left-xs":!e.props.isMaestroDesign,"u-mar-left-s":e.props.isMaestroDesign}),[r.createElement(h,{dimension:e.props.isMaestroDesign?32:24,photoUrl:t.photo_url,optionalClass:o,defaultAvatar:r.createElement(g,{dimension:e.props.isMaestroDesign?32:24,initials:n.getInitials(t.name||t.email),name:t.name,shape:"CIRCLE",optionalClass:o})}),S.span({className:e.props.isMaestroDesign?"user-info":"user-name"},S.span({className:s("user-name-part",{pending:t.is_pending,"user-info__text":e.props.isMaestroDesign})},t.name?t.name:"-"),e.props.isMaestroDesign?S.div({className:"user-info__subtext"},t.email):S.span({className:"user-status"},t.is_owner?" · "+T("Manager"):t.is_pending?" · "+T("Pending"):void 0))]}})(this)}},userEmail:function(e){return{field:"email",header:T("Email"),classes:{"email-column":!0},width:e,sortable:!this.props.search_query,render:function(e){return S.span({className:"user-email"},S.span({className:s({pending:e.is_pending})},e.email))}}},userStatus:function(e){return{field:"member_type",header:T("Status"),classes:{"user-status-column":!0},width:e,initialSortDir:p.DESC_DIR,sortable:!this.props.search_query,render:function(e){return T(e.is_owner?"Manager":e.is_pending?"Pending":"Member")}}},joinedDate:function(e){return{field:"localized_joined_ts",header:T("Joined"),width:e,sortable:!this.props.search_query,render:(function(e){return function(t){return e.props.isMaestroDesign&&t.is_pending?S.span({className:"pending-request-buttons"},r.createElement(v,{handler:e.onClickApproveJoinReq.bind(e,t)},S.button({className:"button-secondary button-small action-button approve-join-req-button"},T("Approve")))):t.localized_joined_ts}})(this)}},settings:function(e){return{width:e,classes:{"settings-column":!0},sortable:!1,render:(function(e){return function(t){return e.canManageGroup()?t.is_pending?e.renderSettingsForPendingMember(t):e.renderSettingsForMember(t):""}})(this)}}},componentWillMount:function(){return this.columnTypes=N(this.columnTypes,this)},tableRowClasses:function(e){return this.props.isMaestroDesign&&e.is_pending?{"pending-member-row":!0}:{}},getGroupMembers:function(e,t){return a.WebRequest({url:"/groups_ajax/get_group_info",data:{group_id:this.props.group.id,offset:e.offset,limit:e.limit,sort_column:e.sortColumn,sort_direction:e.sortDir,search_query:this.props.search_query},subject_user:I.work_user,success:(function(e){return function(s){var r;return s=JSON.parse(s),r=s.data.pending_req_users.concat(s.data.users),t(null,{rows:r,total:s.data.user_count+s.data.pending_req_count}),e.props.onGroupChanged(!1,s.data)}})(this),error:(function(e){return function(t){return _.redirectToGroupsPage(e.props.insideAdminConsole)}})(this)})},renderMemberTable:function(){var e,t;return t=this.props.group.pending_req_users.concat(this.props.group.users),e=this.props.isMaestroDesign?this.canManageGroup?[this.columnTypes.displayName("50%"),this.columnTypes.userStatus("25%"),this.columnTypes.settings("25%")]:[this.columnTypes.displayName("50%"),this.columnTypes.userStatus("50%")]:this.canManageGroup?[this.columnTypes.displayName(300),this.columnTypes.userEmail(250),this.columnTypes.joinedDate(147),this.columnTypes.settings(103)]:[this.columnTypes.displayName(300),this.columnTypes.userEmail(250),this.columnTypes.joinedDate(250)],r.createElement(p,{ref:"members",columns:e,initialData:{rows:t,total:this.props.group.user_count+this.props.group.pending_req_count},initialSortColumn:0,emptyMessage:T(this.props.search_query?"No members found":"This group has no members."),rowsPerPage:_.MAX_ROWS_PER_PAGE,paginatorClasses:this.props.isMaestroDesign?"u-mar-top-xs":"",infiniteScroll:this.props.isMaestroDesign,classes:{"grey-style":!0},rowClasses:this.tableRowClasses,rowsPerRequestForInfiniteScroll:_.MAX_ROWS_TO_FETCH_FROM_SERVER,onRequestData:this.getGroupMembers})},render:function(){return S.div({className:"member-list-container"},S.div({className:"group-user-info"},this.props.isMaestroDesign&&!this.props.insideAdminConsole||this.props.search_query?void 0:S.div({className:"member-count"},k("%(n)d member","%(n)d members",this.props.group.user_count).format({n:this.props.group.user_count}))),this.renderMemberTable(),this.props.search_query&&this.props.group.has_more?S.div({className:"more-search-results"},T("We found more members than we can display. Don’t see who you’re looking for? Try narrowing your search.")):void 0)}}),{MemberList:M,MemberListPaginated:C}})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,s=this.length;t<s;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/groups/group_members_form",["external/underscore","external/classnames","external/react","modules/core/exception","modules/core/i18n","modules/core/notify","modules/clean/ajax","modules/clean/contacts/contact","modules/clean/contacts/contact_token_state","modules/clean/contacts/tokenizer","modules/clean/contacts/types","modules/clean/react/input","modules/clean/viewer"],function(t,s,r,o,n,i,a,u,l,p,m,c,d){var h,g,f,_,b,v,w;return o.assert,_=n._,h=u.Contact,g=l.ContactTokenState,f=p.ContactsTokenizer,w=d.get_viewer(),b=r.DOM,v=r.PropTypes,r.createClass({displayName:"GroupMembersForm",propTypes:{group:v.object,populatedContacts:v.arrayOf(v.instanceOf(h)),customClass:v.string,onChange:v.func,emailPlaceholder:v.string,messagePlaceholder:v.string,errorMessageSpaceFixed:v.bool,emailCheckerStore:v.object,includeCustomMessage:v.bool,disallowGroupMembers:v.bool,disallowCurrentUser:v.bool},getDefaultProps:function(){return{customClass:"",populatedContacts:[],emailPlaceholder:_("Name or email"),messagePlaceholder:_("Add a message (optional)"),includeCustomMessage:!0,disallowGroupMembers:!1,disallowCurrentUser:!1}},getInitialState:function(){var e;return{errorMessage:null,groupUsersEmails:function(){var t,s,r,o;for(r=this.props.group.users,o=[],t=0,s=r.length;t<s;t++)e=r[t],o.push(e.email);return o}.call(this)}},fetchEmailsOfUsersInGroup:function(){return a.WebRequest({url:"/groups_ajax/get_emails_of_users_in_group",data:{group_id:this.props.group.id},subject_user:w.work_user,success:(function(e){return function(t){if(e.isMounted()&&(t=JSON.parse(t),t.data.emails.length>0))return e.setState({groupUsersEmails:t.data.emails})}})(this),error:function(){return i.error(_("There was a problem please reopen the add-member window"))}})},componentWillMount:function(){if(this.fetchEmailsOfUsersInGroup(),this.props.populatedContacts.length>0)return this._updateErrorMessage()},getContacts:function(){return this.refs.tokenizer.getContacts()},getFinalData:function(e){var s,r,o,n;return this.refs.tokenizer.tokenizeAll(),s=this.getContacts(),this.props.includeCustomMessage&&(r=this.refs.message.getValue()),o=t.filter(s,function(e){return e.type===m.EMAIL}),n=t.map(o,function(e){return{email:e.email,is_owner:!1}}),this._updateErrorMessage(),e({emails:n,custom_message:r})},areAllContactsValid:function(){var e;return e=this.refs.tokenizer.serializeInputData().tokens,0===e.length||t.all(e,(function(e){return function(t){return e._validateContact(t).state===g.ok}})(this))},isEmpty:function(){var e,t,s;return e=this.refs.tokenizer.serializeInputData(),t=e.tokens,s=e.value,0===t.length&&0===s.length},_validateContact:function(t){var s,r;return r={state:g.ok},t.invalid?r={state:g.invalid,msg:_("One or more names or email addresses you entered are invalid.")}:this.props.disallowGroupMembers&&(s=t.email,e.call(this.state.groupUsersEmails,s)>=0)?r={state:g.invalid,msg:_("Member already exists in the group.")}:t.on_team||(r={state:g.invalid,msg:_("This person isn’t on your team")}),r},_updateErrorMessage:function(){var e,t,s,r,o,n,i;for(o=this.refs.tokenizer.serializeInputData().tokens,t=0,s=o.length;t<s;t++)if(e=o[t],n=this._validateContact(e),i=n.state,r=n.msg,i!==g.ok)return void this.setState({errorMessage:r});return this.setState({errorMessage:null})},onContentsChange:function(){var e;return this._updateErrorMessage(),"function"==typeof(e=this.props).onChange?e.onChange():void 0},render:function(){var t,o;return t={"add-group-members-form":!0,"error-message-fixed":this.props.errorMessageSpaceFixed,"has-custom-message":this.props.includeCustomMessage},this.props.customClass&&(t[this.props.customClass]=!0),o=(function(t){return function(s){var r,o;return r=s.type===m.EMAIL&&s.team&&(s.dbx_team_id===w.team_dbtid||s.dbx_team_id===w.work_user.team_dbtid),
t.props.disallowGroupMembers&&(r=r&&(o=s.email,e.call(t.state.groupUsersEmails,o)<0)),t.props.disallowCurrentUser&&(r=r&&s.email!==w.work_user.email),Boolean(r)}})(this),b.div({className:s(t)},b.div({className:"error-message"},this.state.errorMessage),r.createElement(f,{ref:"tokenizer",user:w.work_user,placeholder:this.props.emailPlaceholder,onContentsChange:this.onContentsChange,autofocus:!0,populatedInputData:{tokens:this.props.populatedContacts,value:""},customContactValidator:this._validateContact,customContactFilter:o}),this.props.includeCustomMessage?r.createElement(c.textarea,{ref:"message",className:"custom-message","disable-errors":!0,"aria-label":"member emails",placeholder:this.props.messagePlaceholder}):void 0)}})})}.call(this),function(){define("modules/clean/groups/group_shared_content_list",["external/react","modules/core/i18n","modules/core/browser","modules/clean/ajax","modules/clean/viewer","modules/clean/react/browse/models","modules/clean/react/table"],function(e,t,s,r,o,n,i){var a,u,l,p,m;return a=t._,n.File,u=e.createElement,l=e.DOM,p=e.PropTypes,m=o.get_viewer(),e.createClass({displayName:"GroupSharedContentList",propTypes:{groupId:p.string},getGroupSharedContentData:function(e,t){return r.WebRequest({url:"/groups_ajax/get_shared_content_data_for_group_paginated",data:{group_id:this.props.groupId,offset:e.offset,limit:e.limit,sort_column:e.sortColumn,sort_direction:e.sortDir},subject_user:m.work_user,success:function(e){return e=JSON.parse(e),t(null,{rows:e.data.content,total:e.data.total})}})},columnTypes:{name:function(e){return{field:"name",header:a("Name"),classes:{"display-name-column":!0},width:e,render:function(e){return l.span({className:"groups-shared-content-name"},e.filename)}}},lastChanged:function(e){return{field:"last_changed",header:a("Last changed"),classes:{"last-changed-column":!0},width:e,render:function(e){return l.span({},e.last_changed)}}},size:function(e){return{field:"used",header:a("Size"),classes:{"size-column":!0},width:e,render:function(e){return l.span({},e.used)}}}},render:function(){return l.div({className:"shared-content-list-container"},l.div({className:"content-header"},a("Files")),u(i,{ref:"sharedContent",columns:[this.columnTypes.name(400),this.columnTypes.lastChanged(200),this.columnTypes.size(200)],emptyMessage:a("This group has no shared content yet."),onRequestData:this.getGroupSharedContentData,classes:{"grey-style":!0,"clickable-rows":!0},rowClasses:{"shared-content-row":!0},onRowClicked:function(e){return s.redirect(e.href)}}))}})})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,s=this.length;t<s;t++)if(t in this&&this[t]===e)return t;return-1},t=[].slice;define("modules/clean/groups/groups_page",["jquery","external/classnames","external/react","external/spectrum/dropdown_menu","external/spectrum/vertically_fixed","modules/clean/ajax","modules/clean/components/loading_indicator","modules/clean/css","modules/clean/pagelet_logger","modules/clean/react/sprite","modules/clean/react/table","modules/clean/react/input","modules/clean/avatar/group_avatar","modules/clean/groups/search_input","modules/clean/react_format","modules/clean/react/tooltip","modules/clean/static_urls","modules/clean/viewer","modules/constants/teams","modules/core/browser","modules/core/i18n","modules/core/notify","modules/clean/web_timing_logger","modules/clean/teams/admin/maestro/admin_console_maestro_view_no_upload_button","modules/clean/acf/components/breadcrumbs","modules/clean/groups/utils","modules/clean/deferred_loader","require"],function(s,r,o,n,i,a,u,l,p,m,c,d,h,g,f,_,b,v,w,y,M,C,T,N,S,A,D,R){var E,G,P,k,I,x,L,O,q,U,j,B,F,H,J,W,V,z,Q,Y,X,K,Z,$,ee,te;return P=n.DropdownMenu,k=n.DropdownMenuButton,q=n.Menu,U=n.MenuItem,J=i.VerticallyFixed,j=p.PageletLogger,Z=f.reactFormat,F=_.Tooltip,H=_.TooltipPosition,ee=b.static_url,I=w.GROUP_JOIN_POLICY_OPEN,W=M._,E=N.AdminConsoleMaestroViewNoUploadButton,G=S.default,Y=D.deferredLoader,z=o.createElement,Q=o.DOM,K=o.PropTypes,B=d.text,te=v.get_viewer(),V=function(e,t){var s,r,o;r={};for(o in e)s=e[o],r[o]=s.bind(t);return r},x=o.createClass({displayName:"GroupsList",propTypes:{title:K.string,emptyMessage:K.element,maxRows:K.number,onRequestData:K.func,infiniteScroll:K.bool,rowsPerRequestForInfiniteScroll:K.number,showJoinReqButtons:K.bool,showPendingCountForOwners:K.bool,canViewGroupDetails:K.bool,teamName:K.string,insideAdminConsole:K.bool,onTotalGroupsChange:K.func,searchQuery:K.string,canHaveAdminUi:K.bool,enhancedGroupsEnabled:K.bool,groupJoinPolicyEnabled:K.bool,nameColumn:K.string,isMaestroDesign:K.bool,showActionsInSidebar:K.bool},columnTypes:{displayName:function(e){return{field:"name",header:this.props.nameColumn||W("Name"),classes:{"group-name-column":!0},width:e,render:(function(e){return function(t){return Q.span({className:"group-name-column__content"},z(h,{group:t,dimension:e.props.isMaestroDesign?32:24,optionalClass:r({"u-mar-right-s":!0,"u-mar-left-s":e.props.isMaestroDesign,"u-mar-left-xs":!e.props.isMaestroDesign})}),Q.span({className:"group-name-column__name"},t.name))}})(this)}},members:function(t){return{field:"user_count",header:W("Members"),width:t,initialSortDir:c.DESC_DIR,render:(function(t){return function(s){var r;return t.props.showPendingCountForOwners&&0!==s.join_req_pending_count&&(r=te.work_user.id,e.call(s.owner_user_ids,r)>=0)?s.user_count+" • "+s.join_req_pending_count+" "+W("pending"):s.user_count}})(this)}},owners:function(e){return{field:"owners",header:W(this.props.isMaestroDesign?"Managers":"Managed by"),classes:{"managed-by-column":!0},width:e,render:(function(e){return function(t){return t.is_team_group?Q.label({className:"tooltip-label no-manager-label"},W("No manager"),o.createElement(F,{position:H.RIGHT,tooltip_contents:W("This group was created automatically."),tooltip_classname:"no-manager-tooltip-bubble"},Q.button({className:"sprite-button"},z(m,{group:"web",name:"info",alt:W("This group was created automatically.")})))):Q.span({className:"managed-by-column__content"},function(){if(t.is_admin_managed)return this.props.teamName;switch(t.owner_user_names.length){case 0:return"-";case 1:return t.owner_user_names[0];case 2:return W("%(display_name)s and 1 other").format({display_name:t.owner_user_names[0]});default:return W("%(display_name)s and %(number)s others").format({display_name:t.owner_user_names[0],number:t.owner_user_names.length-1})}}.call(e))}})(this)}},joinRequests:function(e){return{width:e,classes:{"join-request-column":!0},sortable:!1,render:(function(e){return function(t){var s,o,n,i;return t.owner_user_ids.length>0&&!t.is_group_member?(n=t.waiting_for_join_req_approval,o=e.props.enhancedGroupsEnabled&&t.group_join_policy===I&&e.props.groupJoinPolicyEnabled,n?(i=W(o?"Joined":"Pending"),Q.div({className:"join-req-pending"},i)):(s=W(o?"Join":"Ask to join"),Q.button({className:r({"button-tertiary":!e.props.isMaestroDesign,"button-secondary":e.props.isMaestroDesign,"button-small action-button join-req-button":!0}),onClick:e.onClickJoinReq.bind(e,t),disabled:n},s))):""}})(this)}}},onClickJoinReq:function(e,t){return t.stopPropagation(),e.waiting_for_join_req_approval=!0,this.forceUpdate(),a.WebRequest({url:"/groups_ajax/make_group_join_request",data:{group_id:e.id},subject_user:te.work_user,success:function(t){return e.group_join_policy===I?(y.set_hash("groups/"+e.id),C.success(W("Group joined."))):C.success(W("Request sent."))}})},onRowClicked:function(e){if(this.props.canViewGroupDetails)return this.props.insideAdminConsole?window.location.hash="/"+e.id:e.is_group_member||this.props.canHaveAdminUi?window.location.hash="groups/"+e.id:C.warning(W("Groups can only be viewed by group members"))},componentWillMount:function(){return this.columnTypes=V(this.columnTypes,this)},componentDidMount:function(){if(this.props.insideAdminConsole)return T.mark_time_to_view(),T.mark_time_to_interactive()},render:function(){var e;return e=this.props.isMaestroDesign?this.props.showJoinReqButtons?[this.columnTypes.displayName("35%"),this.columnTypes.members("20%"),this.columnTypes.owners("25%"),this.columnTypes.joinRequests("20%")]:[this.columnTypes.displayName("35%"),this.columnTypes.members("20%"),this.columnTypes.owners("45%")]:this.props.showJoinReqButtons?[this.columnTypes.displayName(300),this.columnTypes.members(200),this.columnTypes.owners(200),this.columnTypes.joinRequests(100)]:[this.columnTypes.displayName(300),this.columnTypes.members(200),this.columnTypes.owners(300)],Q.div({className:"groups-list"},this.props.title?Q.h1({className:"table-name"},this.props.title):void 0,o.createElement(c,{columns:e,initialData:this.props.initialData,initialSortColumn:1,initialSortDir:c.DESC_DIR,emptyMessage:this.props.emptyMessage,rowsPerPage:this.props.maxRows,infiniteScroll:this.props.infiniteScroll,rowsPerRequestForInfiniteScroll:this.props.rowsPerRequestForInfiniteScroll,classes:{"grey-style":!0,"clickable-rows":this.props.canViewGroupDetails},rowClasses:{"group-row":!0},onRequestData:this.props.onRequestData,onRowClicked:this.onRowClicked,hideHeaderOnEmptyTable:this.props.insideAdminConsole&&!this.props.searchQuery,onTotalUpdated:this.props.onTotalGroupsChange,isMaestroDesign:this.props.isMaestroDesign&&!this.props.insideAdminConsole,loadingIndicator:ee("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),ref:"GroupsTable"}))},componentDidUpdate:function(e,t){if(e.onRequestData!==this.props.onRequestData||e.searchQuery!==this.props.searchQuery)return this.refs.GroupsTable.forceRefresh()}}),$=function(e,t,s,r,n){return n?Q.div({className:"team-admin-maestro-search__shadow"},z(J,{className:"team-admin-maestro-search-fixed"},Q.div({className:"maestro-search-outer-label"},W("Search groups")),Q.span({className:"team-admin-maestro-search"},Q.span,z(B,{ref:"memberSearchInput",name:"search-input",onChange:(function(t){return function(s){var r;return r=s.target.value,window.clearTimeout(t.searchTimeout),r.trim().length>0||0===r.length?t.searchTimeout=window.setTimeout(function(){return e(r)},500):s.target.value=""}})(this),onCloseClick:s,placeholder:W("Group name"),expandable:!1,compatiblePlaceholder:!0,closeOnBlur:!0,className:"team-admin-text-input","disable-errors":!0})))):Q.span({className:"group-search"},o.createElement(g,{placeholder:W("Search groups"),closeOnBlur:!0,onTriggerSearch:e,onEnterSearch:n?void 0:t,onExitSearch:s,onClearSearchQuery:t,expandable:!r}))},X=function(e,t,s){return a.WebRequest({url:e,data:t,subject_user:te.work_user,success:function(e){return e=JSON.parse(e),s(null,{rows:e.groups,total:e.total_groups})}})},O=o.createClass({displayName:"GroupsListPage",pageletLogger:new j("team",["GroupsListPage"]),propTypes:{canHaveAdminUi:K.bool,groupControlledByAdmin:K.bool,teamName:K.string,isLimitedTeam:K.bool,enhancedGroupsEnabled:K.bool,groupJoinPolicyEnabled:K.bool,groupsTabFirst:K.bool,isMaestroDesign:K.bool,infiniteScroll:K.bool,showActionsInSidebar:K.bool,fetchDataStormcrowOn:K.bool},getInitialState:function(){return{searchQuery:null,tablesVisible:!0,myGroups:[],myGroupsTotal:0,teamGroups:[],teamGroupsTotal:0,groupsPrefetch:!1}},componentWillMount:function(){var e,t;if((!this.props.fetchDataStormcrowOn||this.props.groupsTabFirst)&&(window.__REGISTER_MY_GROUPS_PRELOAD_HANDLER&&(this.state.groupsPrefetch=!0,t=(function(e){return function(t){var s;try{return s=JSON.parse(t),e.setState({myGroups:s.groups,myGroupsTotal:s.total_groups})}catch(e){return e,C.error(W("An error occured. Please reload the page."))}}})(this),e=function(){return C.error(W("An error occured. Please reload the page."))},window.__REGISTER_MY_GROUPS_PRELOAD_HANDLER(t,e),delete window.__REGISTER_MY_GROUPS_PRELOAD_HANDLER),window.__REGISTER_TEAM_GROUPS_PRELOAD_HANDLER))return t=(function(e){return function(t){var s;try{return s=JSON.parse(t),e.setState({teamGroups:s.groups,teamGroupsTotal:s.total_groups}),T.log_js_modules_fetched_data_required_for_tti()}catch(e){return e,C.error(W("An error occured. Please reload the page."))}}})(this),e=function(){return C.error(W("An error occured. Please reload the page."))},window.__REGISTER_TEAM_GROUPS_PRELOAD_HANDLER(t,e),delete window.__REGISTER_TEAM_GROUPS_PRELOAD_HANDLER},componentDidMount:function(){return this.checkAndMarkTTI()},componentDidUpdate:function(){return this.checkAndMarkTTI()},checkAndMarkTTI:function(){if(this.props.groupsTabFirst&&(0!==this.state.myGroupsTotal&&0!==this.state.teamGroupsTotal||!this.props.fetchDataStormcrowOn))return this.pageletLogger.componentReady(this.constructor.displayName)},getGroupsDataAndMarkTTI:function(e,s,r){var o;return o=(function(e){return function(){var s;return s=1<=arguments.length?t.call(arguments,0):[],e.checkAndMarkTTI(),r.apply(null,s)}})(this),X(e,s,o)},getMyGroupsData:function(e,t){var s,r;return r="/groups_ajax/get_groups_for_user_paginated",s={offset:e.offset,limit:e.limit,sort_column:e.sortColumn,sort_direction:e.sortDir},this.getGroupsDataAndMarkTTI(r,s,t)},getOtherGroupsData:function(e,t){var s,r;return r="/groups_ajax/get_groups_for_team_paginated",s={offset:e.offset,limit:e.limit,sort_column:e.sortColumn,sort_direction:e.sortDir,exclude_actors_groups:!this.props.isMaestroDesign||""},this.getGroupsDataAndMarkTTI(r,s,t)},getSearchGroupsResults:function(e,t){var s,r;return r="/groups_ajax/get_groups_for_team_paginated",s={offset:e.offset,limit:e.limit,sort_column:e.sortColumn,sort_direction:e.sortDir,only_company_managed:!1,search_query:this.state.searchQuery},X(r,s,t)},onCreateClicked:function(){var e;return e=Y.getResolvedItems(["CreateGroupModal","Modal"]),e.promise.then((function(e){return function(t){var s,r;return s=t.CreateGroupModal,r=t.Modal,r.showInstance(o.createElement(s,{teamName:e.props.teamName,isLimitedTeam:e.props.isLimitedTeam,canHaveAdminUi:e.props.canHaveAdminUi,insideAdminConsole:!1,enhancedGroupsEnabled:e.props.enhancedGroupsEnabled,groupJoinPolicyEnabled:e.props.groupJoinPolicyEnabled}))}})(this))},onTriggerSearch:function(e){return this.props.isMaestroDesign&&!e?this.setState({searchQuery:null,tablesVisible:!0}):this.setState({searchQuery:e,tablesVisible:!0})},onExitSearch:function(){return this.setState({searchQuery:null,tablesVisible:!0})},onFreshSearch:function(){return this.props.isMaestroDesign?this.setState({searchQuery:null}):this.setState({tablesVisible:!1})},render:function(){return Q.div({className:"groups-page"},Q.div({className:r({"page-heading-buttons":!this.props.showActionsInSidebar},{clearfix:this.props.isMaestroDesign})},this.props.isMaestroDesign?Q.div({className:"tab-page-description u-mar-top-s u-mar-bottom-m"},W("Create groups to share with many people at once.")):void 0,$(this.onTriggerSearch,this.onFreshSearch,this.onExitSearch,this.props.isMaestroDesign,this.props.showActionsInSidebar),this.props.isMaestroDesign||!this.props.canHaveAdminUi&&this.props.groupControlledByAdmin?void 0:Q.button({className:"button-primary action-button create-group-button",onClick:this.onCreateClicked},W("Create group"))),this.renderMyGroupsList(),this.renderMoreGroupsList(),this.renderSearchGroupsList())},renderMyGroupsList:function(){var e;if(this.state.tablesVisible&&null===this.state.searchQuery&&(!this.props.fetchDataStormcrowOn||this.props.groupsTabFirst))return 0===this.state.myGroupsTotal&&this.state.groupsPrefetch?z(u,{style:u.LoadingIndicatorStyle.BLUE_SPINNER,className:"member-list-loading-spinner"}):(e=this.state.groupsPrefetch?{rows:this.state.myGroups,total:this.state.myGroupsTotal}:void 0,Q.div({className:r("my-groups-list",{"u-mar-top-m":this.props.isMaestroDesign})},o.createElement(x,{title:this.props.isMaestroDesign?void 0:W("My groups"),emptyMessage:Q.span({},Z(W("You’re not a member of any groups yet. You can join groups from the <b>%(group_section)s</b> section below.<br />You can also start a new group by clicking <b>Create group</b>.",{comment:"'More groups' and 'Create group' should be same translation as those strings elsewhere on this page"}),{b:Q.b(),br:Q.br(),group_section:W(this.props.isMaestroDesign?"All groups":"More groups")})),initialData:e,maxRows:this.props.infiniteScroll?1e4:5,onRequestData:this.getMyGroupsData,showJoinReqButtons:!1,showPendingCountForOwners:!0,canViewGroupDetails:!0,teamName:this.props.teamName,insideAdminConsole:!1,canHaveAdminUi:this.props.canHaveAdminUi,enhancedGroupsEnabled:this.props.enhancedGroupsEnabled,groupJoinPolicyEnabled:this.props.groupJoinPolicyEnabled,isMaestroDesign:this.props.isMaestroDesign,nameColumn:this.props.isMaestroDesign?W("My groups"):void 0,showActionsInSidebar:this.props.showActionsInSidebar})))},renderMoreGroupsList:function(){var e,t;if(this.state.tablesVisible&&null===this.state.searchQuery&&(!this.props.fetchDataStormcrowOn||this.props.groupsTabFirst))return 0===this.state.teamGroupsTotal&&this.state.groupsPrefetch?z(u,{style:u.LoadingIndicatorStyle.BLUE_SPINNER,className:"member-list-loading-spinner"}):(e=this.state.groupsPrefetch?{rows:this.state.teamGroups,total:this.state.teamGroupsTotal}:void 0,t=this.state.groupsPrefetch?15:A.MAX_ROWS_TO_FETCH_FROM_SERVER,Q.div({className:r("more-groups-list",{"u-mar-top-m":this.props.isMaestroDesign})},o.createElement(x,{title:this.props.isMaestroDesign?void 0:W("More groups"),emptyMessage:Q.span({},W("There are no groups for you to join. You can start a new group by clicking "),Q.b({},W("Create group")),W(".")),initialData:e,maxRows:10,infiniteScroll:this.props.infiniteScroll,rowsPerRequestForInfiniteScroll:t,onRequestData:this.getOtherGroupsData,showJoinReqButtons:!this.props.canHaveAdminUi,showPendingCountForOwners:!1,canViewGroupDetails:this.props.canHaveAdminUi,teamName:this.props.teamName,insideAdminConsole:!1,canHaveAdminUi:this.props.canHaveAdminUi,enhancedGroupsEnabled:this.props.enhancedGroupsEnabled,groupJoinPolicyEnabled:this.props.groupJoinPolicyEnabled,isMaestroDesign:this.props.isMaestroDesign,nameColumn:this.props.isMaestroDesign?W("All groups"):void 0,showActionsInSidebar:this.props.showActionsInSidebar})))},renderSearchGroupsList:function(){if(this.state.tablesVisible&&null!==this.state.searchQuery)return Q.div({className:r("more-groups-list",{"u-mar-top-s":this.props.isMaestroDesign})},o.createElement(x,{title:this.props.isMaestroDesign?"":W("Groups"),emptyMessage:Q.div({className:"empty-groups-search-results"},W("No groups found")),maxRows:A.MAX_ROWS_PER_PAGE,infiniteScroll:this.props.infiniteScroll,rowsPerRequestForInfiniteScroll:A.MAX_ROWS_TO_FETCH_FROM_SERVER,onRequestData:this.getSearchGroupsResults,showJoinReqButtons:!this.props.canHaveAdminUi,showPendingCountForOwners:!0,canViewGroupDetails:!0,teamName:this.props.teamName,insideAdminConsole:!1,searchQuery:this.state.searchQuery,canHaveAdminUi:this.props.canHaveAdminUi,groupJoinPolicyEnabled:this.props.groupJoinPolicyEnabled,isMaestroDesign:this.props.isMaestroDesign,showActionsInSidebar:this.props.showActionsInSidebar}))}}),L=o.createClass({displayName:"GroupsListForAdminsPage",propTypes:{teamName:K.string,enhancedGroupsEnabled:K.bool,groupJoinPolicyEnabled:K.bool,filterValue:K.string,onUserFilterChange:K.func},getInitialState:function(){return{hasGroups:!1,searchQuery:null,tableVisible:!0}},getGroupsData:function(e,t){return a.WebRequest({url:"/groups_ajax/get_groups_for_team_paginated",data:{offset:e.offset,limit:e.limit,sort_column:e.sortColumn,sort_direction:e.sortDir,only_company_managed:!1,search_query:this.state.searchQuery},subject_user:te.work_user,success:function(e){return e=JSON.parse(e),t(null,{rows:e.groups,total:e.total_groups})}})},getCompanyManagedGroupsData:function(e,t){return a.WebRequest({url:"/groups_ajax/get_groups_for_team_paginated",data:{offset:e.offset,limit:e.limit,sort_column:e.sortColumn,sort_direction:e.sortDir,only_company_managed:!0,search_query:this.state.searchQuery},subject_user:te.work_user,success:function(e){return e=JSON.parse(e),t(null,{rows:e.groups,total:e.total_groups})}})},onCreateClicked:function(){var e;return e=Y.getResolvedItems(["CreateGroupModal","Modal"]),e.promise.then((function(e){return function(t){var s,r;return s=t.CreateGroupModal,r=t.Modal,r.showInstance(o.createElement(s,{teamName:e.props.teamName,isLimitedTeam:!1,canHaveAdminUi:!0,insideAdminConsole:!0,enhancedGroupsEnabled:e.props.enhancedGroupsEnabled,groupJoinPolicyEnabled:e.props.groupJoinPolicyEnabled}))}})(this))},render:function(){return Q.div({className:"groups-page"},this.renderFindPanel(),this.renderGroupsList())},renderFindPanel:function(){if(this.state.hasGroups>0||"company_managed_groups"===this.props.filterValue||null!==this.state.searchQuery)return Q.span({className:"group-find-panel"},$(this.onTriggerSearch,this.hideTable,this.onExitSearch,!1,!0))},renderGroupsList:function(){var e,t;if(this.state.tableVisible)return t="all_groups"===this.props.filterValue?this.getGroupsData:this.getCompanyManagedGroupsData,e=this.getEmptyMessage(),Q.div({className:"more-groups-list"},o.createElement(x,{title:null,emptyMessage:e,maxRows:A.MAX_ROWS_PER_PAGE,infiniteScroll:!0,rowsPerRequestForInfiniteScroll:A.MAX_ROWS_TO_FETCH_FROM_SERVER,onRequestData:t,showJoinReqButtons:!1,showPendingCountForOwners:!0,canViewGroupDetails:!0,teamName:this.props.teamName,insideAdminConsole:!0,onTotalGroupsChange:this.onTotalGroupsChange,searchQuery:this.state.searchQuery,canHaveAdminUi:!0,enhancedGroupsEnabled:this.props.enhancedGroupsEnabled,showActionsInSidebar:!0,isMaestroDesign:this.props.isMaestroDesign}))},getEmptyMessage:function(){return"all_groups"===this.props.filterValue?null===this.state.searchQuery?Q.span({className:"admin-console-empty-message"},Q.div({className:"empty-groups-illustration"},Q.img({className:"empty-groups-image",src:"/static/images/groups/groups_empty_illustration-vflibL0ss.svg",alt:""})),Q.div({className:"empty-groups-view-header"},W("You don’t have any groups yet.")),Q.div({className:"empty-groups-desc"},W("Groups make it easier to share with common lists of people in your team."))):Q.div({className:"empty-groups-search-results"},W("No groups found")):null===this.state.searchQuery?Q.span({},W("You don’t have any company-managed groups currently. "),Q.a({href:"/help/7232",target:"_blank"},W("Learn more")),W(" about company-managed groups.")):Q.div({className:"empty-groups-search-results"},W("No company-managed groups found"))},onTotalGroupsChange:function(e){return this.setState({hasGroups:e>0})},onTriggerSearch:function(e){return this.setState({searchQuery:e,tableVisible:!0})},onExitSearch:function(){return this.setState({searchQuery:null,tableVisible:!0})},hideTable:function(){return this.setState({tableVisible:!1})}}),o.createClass({displayName:"GroupsPageContainer",propTypes:{canHaveAdminUi:K.bool,groupControlledByAdmin:K.bool,teamName:K.string,isLimitedTeam:K.bool,insideAdminConsole:K.bool,enhancedGroupsEnabled:K.bool,sharedContentListEnabled:K.bool,groupJoinPolicyEnabled:K.bool,groupsTabFirst:K.bool,isMaestroDesign:K.bool,infiniteScroll:K.bool,onNewSingleGroup:K.func,isFullPage:K.bool,showActionsInSidebar:K.bool,fetchDataStormcrowOn:K.bool},getInitialState:function(){return{viewingGroupId:this.groupIdFromHash(),filterValue:"all_groups",singleGroupPageElement:null}},componentWillMount:function(){return T.waitForTTI().then((function(e){return function(){return e.requireSingleGroupPage(),e.requireModals()}})(this)),s(window).on("hashchange",(function(e){return function(){return e.onNewSingleGroup(null),e.setState({viewingGroupId:e.groupIdFromHash()})}})(this))},componentDidMount:function(){if(this.state.viewingGroupId&&this.props.insideAdminConsole)return this.requireSingleGroupPage(),this.requireModals()},requireSingleGroupPage:function(){if(!this.state.singleGroupPageElement)return R(["modules/clean/groups/single_group_page"],(function(e){return function(t){return e.setState({singleGroupPageElement:t})}})(this))},requireModals:function(){if(!this.state.modalsLoaded)return this.setState({modalsLoaded:!0}),R(["modules/clean/groups/simple_modals","modules/clean/groups/create_group_modal","modules/clean/react/modal"],(function(e){return function(t,s,r){var o,n,i,a;return n=t.showDeleteGroupModal,i=t.showLeaveGroupModal,a=t.showSwitchToAdminManagedGroupModal,o=r.Modal,e.setState({CreateGroupModalElement:s}),Y.setItems({showDeleteGroupModal:n,showLeaveGroupModal:i,showSwitchToAdminManagedGroupModal:a,CreateGroupModal:s,Modal:o})}})(this))},groupIdFromHash:function(){var e,t,r,o;return t=null!=(o=window.location.hash)?o.split("#").pop():void 0,this.props.isMaestroDesign||s("#sharing-tabs").length>0||this.props.insideAdminConsole?(r=null!=t?t.split("/"):void 0,e=null!=r?r[1]:void 0):e=t,null!=e&&""!==e?e:void 0},refreshGroup:function(){var e;return null!=(e=this.refs.single_group_page)?e.onGroupChanged(!0):void 0},showRenameGroupModal:function(){var e;return null!=(e=this.refs.single_group_page)?e.showRenameGroupModal():void 0},showAddMembersModal:function(){var e;return null!=(e=this.refs.single_group_page)?e.showAddMembersModal():void 0},onUserFilterChange:function(e,t){return this.setState({filterValue:t})},shouldRenderCreateGroupButton:function(){var e;return e=!this.props.isMaestroDesign&&(this.props.canHaveAdminUi||!this.props.groupControlledByAdmin),this.props.insideAdminConsole||e},onNewSingleGroup:function(e){var t;return this.setState({singleGroup:e}),"function"==typeof(t=this.props).onNewSingleGroup?t.onNewSingleGroup(e):void 0},onCreateClicked:function(){var e,t,s,r;return r=!1,e=!0,s=!0,this.props.insideAdminConsole||(r=this.props.isLimitedTeam,e=this.props.canHaveAdminUi,s=!1),t=Y.getResolvedItems(["CreateGroupModal","Modal"]),t.promise.then((function(t){return function(n){var i,a;return i=n.CreateGroupModal,a=n.Modal,a.showInstance(o.createElement(i,{teamName:t.props.teamName,isLimitedTeam:r,canHaveAdminUi:e,insideAdminConsole:s,enhancedGroupsEnabled:t.props.enhancedGroupsEnabled,groupJoinPolicyEnabled:t.props.groupJoinPolicyEnabled}))}})(this))},getFilterOptions:function(){var e;return e=[],e.push({value:"all_groups",text:W("All groups"),selected_text:W("All groups")}),e.push({value:"company_managed_groups",text:W("Company-managed groups"),selected_text:W("Company-managed")}),e},getSidebarFilters:function(){var e,t;return t=this.getFilterOptions(),e=t.find((function(e){return function(t){return t.value===e.state.filterValue}})(this)).selected_text,Q.div({className:"groups-maestro-filter"},Q.div({className:"filter-label"},W("Group type",{comment:"Label for a dropdown that filters groups according to group type"})),z(P,{onSelection:this.onUserFilterChange.bind(this,this.state.filterValue)},z(k,{},e),z(q,{},t.map(function(e){return z(U,{value:e.value},Q.div({className:"filter-option"},Q.div({className:"filter-option-value"},e.text)))}))))},getSidebarButtonsGroups:function(){var e;return this.props.showActionsInSidebar?(e=void 0,this.shouldRenderCreateGroupButton()&&(e={displayName:W("Create group"),handleClick:this.onCreateClicked,disabled:!1}),{primaryMenuItem:e,primarySubnode:this.getSidebarFilters()}):null},showDeleteGroupModalDeferred:function(){var e;return e=Y.getResolvedItems(["showDeleteGroupModal"]),e.promise.then((function(e){return function(t){return t.showDeleteGroupModal(e.state.singleGroup,e.props.insideAdminConsole,!1,function(){})}})(this))},showLeaveGroupModalDeferred:function(){var e;return e=Y.getResolvedItems(["showLeaveGroupModal"]),e.promise.then((function(e){return function(t){return t.showLeaveGroupModal(e.state.singleGroup,e.props.insideAdminConsole,!1,function(){})}})(this))},showSwitchToAdminManagedGroupModalDeferred:function(){var e;return e=Y.getResolvedItems(["showSwitchToAdminManagedGroupModal"]),e.promise.then((function(e){return function(t){return t.showSwitchToAdminManagedGroupModal(e.state.singleGroup,e.props.insideAdminConsole,e.refs.single_group_page.onAdminManaged)}})(this))},getSidebarOwnerGroup:function(){var e,t,s;return s=this.refs.single_group_page,e={displayName:W("Add members"),handleClick:s.showAddMembersModal,disabled:!1},t=[],this.viewerIsMember()&&t.push({displayName:W("Leave group"),handleClick:this.showLeaveGroupModalDeferred,disabled:!1,iconName:"leave-group"}),t.push({displayName:W("Delete group"),handleClick:this.showDeleteGroupModalDeferred,disabled:!1,iconName:"delete-group"}),this.props.canHaveAdminUi&&!this.props.isLimitedTeam&&(this.state.singleGroup.is_admin_managed?t.push({displayName:W("Make user-managed"),handleClick:s.showSwitchToMemberManagedGroupModal,disabled:!1,iconName:"make-user-managed-group"}):t.push({displayName:W("Make company-managed"),handleClick:this.showSwitchToAdminManagedGroupModalDeferred,disabled:!1,iconName:"make-company-managed-group"})),t.push({displayName:W("Edit group"),handleClick:s.showUpdateGroupModal,disabled:!1,iconName:"edit-group"}),{primaryMenuItem:e,secondaryMenuItems:t}},getSidebarNonOwnerGroup:function(){var e;return e={displayName:W("Leave group"),handleClick:this.showLeaveGroupModalDeferred,disabled:!1},{primaryMenuItem:e}},viewerIsOwner:function(){var e;return null!=(e=this.state.singleGroup)?e.is_owner:void 0},viewerIsMember:function(){var e,t,s,r,o,n;if(null!=(s=this.state.singleGroup)?s.paginated:void 0)return this.state.singleGroup.is_member;for(o=null!=(r=this.state.singleGroup)?r.users:void 0,e=0,t=o.length;e<t;e++)if(n=o[e],n.user_id===te.work_user.id)return!0;return!1},getSidebarButtonsSingleGroup:function(){if(null!=this.state.singleGroup&&!this.state.singleGroup.is_team_group){if(this.props.canHaveAdminUi)return this.getSidebarOwnerGroup();if(!this.state.singleGroup.is_admin_managed){if(this.viewerIsOwner())return this.getSidebarOwnerGroup();if(this.viewerIsMember()&&!this.props.groupControlledByAdmin)return this.renderNonOwnerMemberButtons()}}},getSidebarButtons:function(){return null!=this.state.viewingGroupId?this.getSidebarButtonsSingleGroup():this.getSidebarButtonsGroups()},renderBreadcrumbs:function(){var e,t;return t=this.props.insideAdminConsole?"#/":"#groups",e=[{name:W("Groups"),url:t}],this.state.singleGroup&&e.push({name:this.state.singleGroup.name}),z(G,{items:e})},renderPagelet:function(){var e,t;return e=null!=this.state.viewingGroupId&&this.props.showActionsInSidebar?this.renderBreadcrumbs():W("Groups"),t=this.props.showActionsInSidebar?this.getSidebarButtons():null,z(E,{header:e,sidebar:t},this.renderPage())},renderPage:function(){return Q.div({className:"team_admin_panel"},Q.div({className:r("groups",{"sidebar-actions":this.props.showActionsInSidebar})},this.renderContent()))},renderContent:function(){return null==this.state.viewingGroupId?this.props.insideAdminConsole?o.createElement(L,{teamName:this.props.teamName,enhancedGroupsEnabled:this.props.enhancedGroupsEnabled,groupJoinPolicyEnabled:this.props.groupJoinPolicyEnabled,filterValue:this.state.filterValue,onUserFilterChange:this.onUserFilterChange,isMaestroDesign:this.props.isMaestroDesign}):o.createElement(O,{canHaveAdminUi:this.props.canHaveAdminUi,groupControlledByAdmin:this.props.groupControlledByAdmin,teamName:this.props.teamName,isLimitedTeam:this.props.isLimitedTeam,enhancedGroupsEnabled:this.props.enhancedGroupsEnabled,groupJoinPolicyEnabled:this.props.groupJoinPolicyEnabled,groupsTabFirst:this.props.groupsTabFirst,isMaestroDesign:this.props.isMaestroDesign,infiniteScroll:this.props.infiniteScroll,showActionsInSidebar:this.props.isMaestroDesign&&this.props.showActionsInSidebar,fetchDataStormcrowOn:this.props.fetchDataStormcrowOn}):"newgroup"!==this.state.viewingGroupId?this.state.singleGroupPageElement?o.createElement(this.state.singleGroupPageElement,{ref:"single_group_page",groupId:this.state.viewingGroupId,canHaveAdminUi:this.props.canHaveAdminUi,teamName:this.props.teamName,groupControlledByAdmin:this.props.groupControlledByAdmin,isLimitedTeam:this.props.isLimitedTeam,insideAdminConsole:this.props.insideAdminConsole,enhancedGroupsEnabled:this.props.enhancedGroupsEnabled,sharedContentListEnabled:this.props.sharedContentListEnabled,groupJoinPolicyEnabled:this.props.groupJoinPolicyEnabled,isMaestroDesign:this.props.isMaestroDesign,showActionsInSidebar:this.props.isMaestroDesign&&this.props.showActionsInSidebar,
onNewGroupFetched:this.onNewSingleGroup}):z(u,{style:u.LoadingIndicatorStyle.BLUE_SPINNER}):this.state.CreateGroupModalElement?o.createElement(this.state.CreateGroupModalElement,{teamName:this.props.teamName,isLimitedTeam:this.props.isLimitedTeam,canHaveAdminUi:this.props.canHaveAdminUi,insideAdminConsole:this.props.insideAdminConsole,enhancedGroupsEnabled:this.props.enhancedGroupsEnabled,groupJoinPolicyEnabled:this.props.groupJoinPolicyEnabled}):void 0},render:function(){return l.require_css("/static/css/groups/react_groups-vflxGEBb9.css"),l.require_css("/static/css/react/table-vflx8DDXW.css"),this.props.isFullPage?this.renderPagelet():this.renderContent()}})})}.call(this),function(){define("modules/clean/groups/search_input",["external/react","modules/core/notify","modules/core/user_i18n","modules/clean/ajax","modules/clean/css","modules/clean/react/input"],function(e,t,s,r,o,n){var i;return i=e.PropTypes,e.createClass({displayName:"SearchInput",propTypes:{placeholder:i.string,onTriggerSearch:i.func,onEnterSearch:i.func,onExitSearch:i.func,onClearSearchQuery:i.func,expandable:i.bool,closeOnBlur:i.bool},render:function(){return o.require_css("/static/css/legacy_packages/components-vflfWNhxV.css"),e.createElement(n.text,{ref:"searchInput",name:"search-input",onChange:this.onUserTextChange,onFocus:this.onUserInputFocus,onCloseClick:this.onUserInputClose,placeholder:this.props.placeholder,expandable:this.props.expandable,closeOnBlur:this.props.closeOnBlur,expandedWidthOffset:0,animationDuration:0,"disable-errors":!0})},onUserTextChange:function(e){var t,s;return s=e.target.value,window.clearTimeout(this.searchTimeout),s.trim().length>0?this.searchTimeout=window.setTimeout((function(e){return function(){return e.props.onTriggerSearch(s)}})(this),500):"function"==typeof(t=this.props).onClearSearchQuery?t.onClearSearchQuery():void 0},onUserInputFocus:function(e){var t,s;if(s=e.target.value,0===s.trim().length)return"function"==typeof(t=this.props).onEnterSearch?t.onEnterSearch():void 0},onUserInputClose:function(e){var t;return this.refs.searchInput.setValue(""),window.clearTimeout(this.searchTimeout),"function"==typeof(t=this.props).onExitSearch?t.onExitSearch():void 0}})})}.call(this),function(){define("modules/clean/groups/simple_modals",["external/react","external/purify","modules/core/i18n","modules/core/notify","modules/clean/ajax","modules/clean/groups/utils","modules/clean/viewer","modules/clean/react/modal"],function(e,t,s,r,o,n,i,a){var u,l,p,m,c,d,h,g,f;return l=s._,u=a.SimpleModal,f=i.get_viewer(),p=function(e,s,i,a){var p;return p=l("Deleting “%(group_name)s” will cause all of its members to lose access to folders that have been shared with the group. You will not be able to undo this. <br/><br/>It might take a little while for deleted groups to be removed from all their shared folders.<br/><br/> Are you sure you want to delete the group?").format({group_name:e.name}),u.show({title_text:l("Delete “%(group_name)s”?").format({group_name:e.name}),body_html:t.sanitize(p),confirm_text:l("Delete"),cancel_text:l("Cancel"),confirm_callback:function(){return o.WebRequest({url:"/groups_ajax/remove_group",data:{group_id:e.id},subject_user:f.work_user,success:function(e){return r.success(l("Deleting group...")),window.location.hash=i?"members":"groups","function"==typeof a?a():void 0},error:function(e){if(n.isGroupDeleted(e))return n.redirectToGroupsPage(s)}})}})},m=function(e,s,i,a){var p;return p=l("Leaving “%(group_name)s” will cause you to lose access to folders that have been shared with the group.<br/><br/> It might take a little while to remove you from all of the group’s shared folders.<br/><br/> Are you sure you want to leave the group?").format({group_name:e.name}),u.show({title_text:l("Leave “%(group_name)s”?").format({group_name:e.name}),body_html:t.sanitize(p),confirm_text:l("Leave"),cancel_text:l("Cancel"),confirm_callback:function(){return o.WebRequest({url:"/groups_ajax/remove_user_from_group",data:{group_id:e.id,user_id:f.work_user.id},subject_user:f.work_user,success:function(e){return r.success(l("Leaving group...")),window.location.hash=i?"members":"groups","function"==typeof a?a():void 0},error:function(e){if(n.isGroupDeleted(e))return n.redirectToGroupsPage(s)}})}})},h=function(e,s,i,a){var p,m;return m=i.name?i.name:i.email,p=l("Removing %(name)s will cause them to lose access to folders that have been shared with the group.<br/><br/> It might take a little while to remove members from all of this group’s shared folders.<br/><br/> Are you sure you want to do this?").format({name:m}),u.show({title_text:l("Remove %(name)s?").format({name:m}),body_html:t.sanitize(p),confirm_text:l("Remove"),cancel_text:l("Cancel"),confirm_callback:function(){return o.WebRequest({url:"/groups_ajax/remove_user_from_group",data:{group_id:e.id,user_id:i.user_id},subject_user:f.work_user,success:function(e){return r.success(l("Removing member...")),"function"==typeof a?a(i):void 0},error:function(e){if(n.isGroupDeleted(e))return n.redirectToGroupsPage(s)}})}})},d=function(e,s,r,i){var a;return a=l("%(name)s will no longer be able to add and remove managers, change group information, or delete the group.").format({name:r.name}),u.show({title_text:l("Remove manager permissions from %(name)s?").format({name:r.name}),body_html:t.sanitize(a),confirm_text:l("Remove manager permissions"),confirm_callback:(function(t){return function(){return o.WebRequest({url:"/groups_ajax/change_group_member_type",data:{group_id:e.id,user_id:r.user_id,is_owner:!1},subject_user:f.work_user,success:function(t){return r.is_owner=!1,e.owners=e.owners.filter(function(e){return e.email!==r.email}),r.user_id===f.work_user.id&&(e.is_owner=!1),i(!1,e)},error:function(e,r,o){if(t.setState({submitting:!1,errors:(function(){try{return JSON.parse(o)}catch(e){}})()}),n.isGroupDeleted(e))return n.redirectToGroupsPage(s)}})}})(this)})},c=function(e,s,r,i){var a;return a=l("%(name)s will be able to add and remove managers, and change group information. <br/>%(name)s will also be able to delete the group.").format({name:r.name}),u.show({title_text:l("Make %(name)s a manager?").format({name:r.name}),body_html:t.sanitize(a),confirm_text:l("Make manager"),confirm_callback:(function(t){return function(){return o.WebRequest({url:"/groups_ajax/change_group_member_type",data:{group_id:e.id,user_id:r.user_id,is_owner:!0},subject_user:f.work_user,success:function(t){var s;return r.is_owner=!0,s={name:r.name,email:r.email},e.owners.push(s),i(!1,e)},error:function(e,r,o){if(t.setState({submitting:!1,errors:(function(){try{return JSON.parse(o)}catch(e){}})()}),n.isGroupDeleted(e))return n.redirectToGroupsPage(s)}})}})(this)})},g=function(e,s,i){return u.show({title_text:l("Make company-managed?"),body_html:t.sanitize(l("This will become a company-managed group, and admins will be responsible for adding and removing members.")),confirm_text:l("Make company-managed"),cancel_text:l("Cancel"),confirm_callback:function(){return o.WebRequest({url:"/groups_ajax/change_to_admin_managed_type",data:{group_id:e.id},subject_user:f.work_user,success:function(t){return r.success(l("%(group_name)s is now company-managed").format({group_name:e.name})),i()},error:function(e){if(n.isGroupDeleted(e))return n.redirectToGroupsPage(s)}})}})},{showDeleteGroupModal:p,showLeaveGroupModal:m,showRemoveUserModal:h,showRemoveOwnerPermissionsModal:d,showMakeOwnerModal:c,showSwitchToAdminManagedGroupModal:g}})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,s=this.length;t<s;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/groups/single_group_page",["external/react","modules/core/i18n","modules/core/notify","modules/core/user_i18n","modules/clean/ajax","modules/clean/css","modules/clean/react/modal","modules/clean/react/button","modules/clean/avatar/group_avatar","modules/clean/react/image","modules/clean/react/input","modules/clean/react/sprite","modules/clean/react/bubble_menu","modules/clean/viewer","modules/clean/static_urls","modules/clean/groups/update_group_modal","modules/clean/groups/add_group_members_modal","modules/clean/groups/group_member_list","modules/clean/groups/group_shared_content_list","modules/clean/groups/simple_modals","modules/clean/groups/switch_to_member_managed_group_modal","modules/clean/groups/utils"],function(t,s,r,o,n,i,a,u,l,p,m,c,d,h,g,f,_,b,v,w,y,M){var C,T,N,S,A,D,R,E,G,P,k,I,x,L,O,q,U,j,B,F;return E=s._,A=a.Modal,C=d.BubbleMenu,T=d.BubbleMenuItem,B=g.static_url,N=b.MemberList,S=b.MemberListPaginated,U=w.showLeaveGroupModal,q=w.showDeleteGroupModal,j=w.showSwitchToAdminManagedGroupModal,P=t.DOM,O=t.PropTypes,G=t.createElement,R=m.text,F=h.get_viewer(),L=function(e){return e.isMaestroDesign&&!e.insideAdminConsole},x=function(e){return e.insideAdminConsole&&!e.isMaestroDesign},I=function(e){return e.isMaestroDesign&&e.insideAdminConsole&&!e.showActionsInSidebar},k=function(e){return e.isMaestroDesign&&e.insideAdminConsole&&e.showActionsInSidebar},D=t.createClass({displayName:"SingleGroupHeader",propTypes:{group:O.object,canHaveAdminUi:O.bool,teamName:O.string,onGroupChanged:O.func,groupControlledByAdmin:O.bool,isLimitedTeam:O.bool,insideAdminConsole:O.bool,enhancedGroupsEnabled:O.bool,groupJoinPolicyEnabled:O.bool,isMaestroDesign:O.bool,showActionsInSidebar:O.bool},viewerIsOwner:function(){return this.props.group.is_owner},viewerIsMember:function(){var e,t,s,r;if(this.props.group.paginated)return this.props.group.is_member;for(s=this.props.group.users,e=0,t=s.length;e<t;e++)if(r=s[e],r.user_id===F.work_user.id)return!0;return!1},showUpdateGroupModal:function(){return A.showInstance(t.createElement(f,{enhancedGroupsEnabled:this.props.enhancedGroupsEnabled,origGroupName:this.props.group.name,origGroupDescription:this.props.group.description,origGroupJoinPolicy:this.props.group.group_join_policy,groupId:this.props.group.id,isAdminManaged:this.props.group.is_admin_managed,insideAdminConsole:this.props.insideAdminConsole,onGroupChanged:this.props.onGroupChanged,groupJoinPolicyEnabled:this.props.groupJoinPolicyEnabled,teamName:this.props.teamName}))},showAddMembersModal:function(){return A.showInstance(t.createElement(_,{group:this.props.group,insideAdminConsole:this.props.insideAdminConsole,onGroupChanged:this.props.onGroupChanged}))},renderBackToGroups:function(){var e;return e=this.props.insideAdminConsole?"#/":"#groups",P.a({className:"back-to-groups-link",href:e},P.span({className:"back-arrow"},t.createElement(p,{src:B("/static/images/groups/back-vflek6neR.png"),srcHiRes:B("/static/images/groups/back@2x-vflsptBUj.png")})),E("Back to Groups"))},renderGroupInfo:function(){var e,t,s,r,o,n,i;if(this.props.group.is_team_group)e=E("This group was created automatically. To change who’s in the group, admins can add or remove members of %(team_name)s").format({team_name:this.props.teamName});else{if(this.props.group.is_admin_managed)n=this.props.teamName;else if(this.props.group.owners.length>0){for(o=[],i=this.props.group.owners,t=0,s=i.length;t<s;t++)r=i[t],o.push(r.name);n=o.join(", ")}else n="-";e=E("Managed by ")+n}return L(this.props)?[P.h2({className:"group-name"},E("Information")),P.h3({className:"group-managers u-mar-bottom-xs"},e)]:P.div({className:"current-location"},P.span({className:"group-info-container"},G(l,{group:this.props.group,dimension:48,optionalClass:"u-mar-right-s"})),P.span({className:"group-info"},P.span({className:"group-name-container"},P.span({className:"group-name"},this.props.group.name)),P.span({className:"group-managers"},e)),this.props.enhancedGroupsEnabled?this.renderDescription():void 0)},renderDescription:function(){var e;return e=this.props.group.description,P.div({className:"group-description"},P.div({className:"group-description-text"},e))},renderGroupActionsButton:function(){var e,s;return e=t.createElement(u.button,{className:"group-actions-button",importance:"secondary"},t.createElement(c,{group:"web",name:"more",alt:E("More actions")})),s=this.viewerIsMember()?[G(T,{onClick:U.bind(this,this.props.group,this.props.insideAdminConsole,!1,function(){})},E("Leave group")),G(T,{onClick:q.bind(this,this.props.group,this.props.insideAdminConsole,!1,function(){})},E("Delete group"))]:[G(T,{onClick:q.bind(this,this.props.group,this.props.insideAdminConsole,!1,function(){})},E("Delete group"))],this.props.canHaveAdminUi&&!this.props.isLimitedTeam&&(this.props.group.is_admin_managed?s.splice(0,0,G(T,{onClick:this.showSwitchToMemberManagedGroupModal},E("Make user-managed"))):s.splice(0,0,G(T,{onClick:j.bind(this,this.props.group,this.props.insideAdminConsole,this.onAdminManaged)},E("Make company-managed")))),s.splice(0,0,G(T,{onClick:this.showUpdateGroupModal},E("Edit group"))),t.createElement(C,{position:C.POSITIONS.BOTTOM_LEFT,targetButton:e,items:s,verticalDisplacement:-3})},onAdminManaged:function(){return this.props.onGroupChanged(!0,null)},onMemberManaged:function(t){var s,r,o,n,i,a,u,l;for(i=0,this.props.group.is_admin_managed=!1,this.props.group.owners=[],a=this.props.group.users,r=0,o=a.length;r<o;r++)l=a[r],u=l.email,e.call(t,u)>=0&&(l.is_owner=!0,this.props.group.owners.push(l),i+=1);return n=t.length,s=i<n,this.props.onGroupChanged(s,this.props.group)},showSwitchToMemberManagedGroupModal:function(){return A.showInstance(t.createElement(y,{group:this.props.group,onMemberManaged:this.onMemberManaged,insideAdminConsole:this.props.insideAdminConsole}))},renderOwnerButtons:function(){return P.span({className:"group-admin-controls"},t.createElement(u.button,{className:"add-members-button",importance:"primary",onClick:this.showAddMembersModal},E("Add members")),this.renderGroupActionsButton())},renderNonOwnerMemberButtons:function(){return t.createElement(u.button,{className:"leave-group-button",importance:"tertiary",onClick:U.bind(this,this.props.group,this.props.insideAdminConsole,!1,function(){})},E("Leave group"))},render:function(){return P.div({className:"single-group-header"},P.div({className:"group-header"},x(this.props)||I(this.props)?this.renderBackToGroups():void 0,this.renderGroupInfo()),this.props.showActionsInSidebar?void 0:P.div({className:"group-control-buttons"},this.props.group.is_team_group||!x(this.props)&&!I(this.props)?void 0:this.props.canHaveAdminUi?this.renderOwnerButtons():this.props.group.is_admin_managed?void 0:this.viewerIsOwner()?this.renderOwnerButtons():this.viewerIsMember()?this.props.groupControlledByAdmin?void 0:this.renderNonOwnerMemberButtons():void 0))}}),t.createClass({displayName:"SingleGroupPage",propTypes:{groupId:O.string,canHaveAdminUi:O.bool,teamName:O.string,groupControlledByAdmin:O.bool,isLimitedTeam:O.bool,insideAdminConsole:O.bool,enhancedGroupsEnabled:O.bool,sharedContentListEnabled:O.bool,groupJoinPolicyEnabled:O.bool,isMaestroDesign:O.bool,showActionsInSidebar:O.bool,onNewGroupFetched:O.func},getInitialState:function(){return{group:void 0}},componentWillMount:function(){return this.fetchGroup(this.props.groupId)},componentWillReceiveProps:function(e){if(this.props.groupId!==e.groupId)return this.props.group=void 0,this.fetchGroup(e.groupId)},fetchGroup:function(e,t,s,r,o){return null==t&&(t=0),null==s&&(s="display_name_lower"),null==r&&(r=1),null==o&&(o=null),this.setState({loading:!0,search_query:o}),n.WebRequest({url:"/groups_ajax/get_group_info",data:{group_id:e,offset:t,limit:M.MAX_ROWS_TO_FETCH_FROM_SERVER,sort_column:s,sort_direction:r,search_query:o},subject_user:F.work_user,success:(function(e){return function(t){var s;if(e.isMounted()){if(t=JSON.parse(t),e.state.search_query!==o)return;return e.setState({group:t.data,loading:!1}),"function"==typeof(s=e.props).onNewGroupFetched?s.onNewGroupFetched(t.data):void 0}}})(this),error:(function(e){return function(t){return M.redirectToGroupsPage(e.props.insideAdminConsole)}})(this)})},onUserTextChange:function(e){var t;return t=e.target.value,window.clearTimeout(this.searchTimeout),t.trim().length>0||0===t.length?this.searchTimeout=window.setTimeout((function(e){return function(){return t.length>0?e.fetchGroup(e.props.groupId,0,null,null,t):e.fetchGroup(e.props.groupId)}})(this),500):this.refs.memberSearchInput.setValue("")},renderSpinner:function(){return P.div({className:"groups-spinner"},t.createElement(p,{src:B("/static/images/icons/ajax-loading-small-blue-vflVk_QNP.gif"),srcHiRes:B("/static/images/icons/ajax-loading-small-blue@2x-vfl14X6Ll.gif"),alt:E("Loading")}))},onGroupChanged:function(e,t,s,r){var o;return null==s&&(s=null),null==r&&(r=null),e?this.fetchGroup(this.props.groupId,0,s,r,this.state.search_query):(this.setState({group:t}),"function"==typeof(o=this.props).onNewGroupFetched?o.onNewGroupFetched(t):void 0)},showRenameGroupModal:function(){var e;return null!=(e=this.refs.single_group_header)?e.showUpdateGroupModal():void 0},showAddMembersModal:function(){var e;return null!=(e=this.refs.single_group_header)?e.showAddMembersModal():void 0},showSwitchToMemberManagedGroupModal:function(){var e;return null!=(e=this.refs.single_group_header)?e.showSwitchToMemberManagedGroupModal():void 0},showUpdateGroupModal:function(){var e;return null!=(e=this.refs.single_group_header)?e.showUpdateGroupModal():void 0},onAdminManaged:function(){var e;return null!=(e=this.refs.single_group_header)?e.onAdminManaged():void 0},render:function(){return this.state.loading&&!this.state.group?this.renderSpinner():(i.require_css("/static/css/react/contacts_tokenizer-vflaf7P-F.css"),P.div({className:"single-group-view"},t.createElement(D,{ref:"single_group_header",group:this.state.group,canHaveAdminUi:this.props.canHaveAdminUi,teamName:this.props.teamName,onGroupChanged:this.onGroupChanged,groupControlledByAdmin:this.props.groupControlledByAdmin,isLimitedTeam:this.props.isLimitedTeam,insideAdminConsole:this.props.insideAdminConsole,enhancedGroupsEnabled:this.props.enhancedGroupsEnabled,groupJoinPolicyEnabled:this.props.groupJoinPolicyEnabled,isMaestroDesign:this.props.isMaestroDesign,showActionsInSidebar:this.props.showActionsInSidebar}),this.state.group.paginated?P.span({className:"team-admin-maestro-search"},P.div({className:"maestro-search-outer-label"},E("Search group members")),P.span({className:"member-maestro-find-panel"},G(R,{name:"search-input",ref:"memberSearchInput",onChange:this.onUserTextChange,placeholder:E("Name or email",{comment:"a placeholder in a search box, hints the user to search members by Name or email"}),"disable-errors":!0,compatiblePlaceholder:!0,className:"team-admin-text-input"}))):void 0,this.state.loading?this.renderSpinner():this.state.group.paginated?t.createElement(S,{group:this.state.group,canHaveAdminUi:this.props.canHaveAdminUi,onGroupChanged:this.onGroupChanged,isMaestroDesign:L(this.props)||k(this.props),insideAdminConsole:this.props.insideAdminConsole,search_query:this.state.search_query}):t.createElement(N,{group:this.state.group,canHaveAdminUi:this.props.canHaveAdminUi,onGroupChanged:this.onGroupChanged,isMaestroDesign:L(this.props)||k(this.props),insideAdminConsole:this.props.insideAdminConsole}),this.props.sharedContentListEnabled?t.createElement(v,{groupId:this.props.groupId}):void 0))}})})}.call(this),function(){define("modules/clean/groups/switch_to_member_managed_group_modal",["jquery","external/react","modules/core/i18n","modules/core/notify","modules/clean/ajax","modules/clean/groups/group_members_form","modules/clean/groups/utils","modules/clean/react/modal","modules/clean/viewer"],function(e,t,s,r,o,n,i,a,u){var l,p,m,c,d;return p=s._,l=a.Modal,m=t.DOM,c=t.PropTypes,d=u.get_viewer(),t.createClass({displayName:"SwitchToMemberManagedGroupModal",propTypes:{group:c.object,onMemberManaged:c.func,insideAdminConsole:c.bool},getInitialState:function(){return{canProceed:!0,submitting:!1}},componentDidMount:function(){return e(".contacts-tokenizer-input").select()},_canProceed:function(){var e;return null!=(e=this.refs.members)?e.areAllContactsValid():void 0},onSubmit:function(e){return e.preventDefault(),this.refs.members.getFinalData((function(e){return function(t){var s,n,a,u;if(n=t.emails,s=e._canProceed(),e.setState({canProceed:s}),s)return e.setState({submitting:!0}),a=e.props.group.name,u=e.props.onMemberManaged,o.WebRequest({url:"/groups_ajax/change_to_member_managed_type",data:{new_owners:JSON.stringify(n),group_id:e.props.group.id},subject_user:d.work_user,complete:function(){if(e.isMounted())return e.setState({submitting:!1})},success:function(e){var t,s;return r.success(p("%(group_name)s is now user-managed").format({group_name:a})),l.close(),s=(function(){var e,s,r;for(r=[],e=0,s=n.length;e<s;e++)t=n[e],r.push(t.email);return r})(),u(s)},error:function(t){if(i.isGroupDeleted(t))return l.close(),i.redirectToGroupsPage(e.props.insideAdminConsole)}})}})(this))},onMembersFormChange:function(){return this.setState({canProceed:this._canProceed()})},render:function(){return t.createElement(l,{title:p("Make user-managed?"),acceptButtonText:p("Make user-managed"),dismissButtonText:p("Cancel"),acceptButtonDisabled:!this.state.canProceed,submitting:this.state.submitting,onAccept:this.onSubmit,ref:"modal"},m.label({className:"label-description"},p("This will become a user-managed group, and the person you choose below will be responsible for approving new members. Group members can leave whenever they like.")),m.br({}),m.br({}),m.label({className:"label-description-secondary"},p("Who should manage this group?")),t.createElement(n,{ref:"members",group:this.props.group,onChange:this.onMembersFormChange,errorMessageSpaceFixed:!1,includeCustomMessage:!1,emailPlaceholder:p("Name or email address"),disallowGroupMembers:!1}))}})})}.call(this),function(){define("modules/clean/groups/update_group_modal",["external/react","modules/core/i18n","modules/clean/ajax","modules/clean/react/modal","modules/clean/react/input","modules/clean/viewer","modules/clean/groups/utils","modules/constants/teams"],function(e,t,s,r,o,n,i,a){var u,l,p,m,c,d,h;return m=t._,p=r.Modal,l=a.GROUP_JOIN_POLICY_REQUEST_TO_JOIN,u=a.GROUP_JOIN_POLICY_OPEN,c=e.DOM,d=e.PropTypes,h=n.get_viewer(),e.createClass({displayName:"UpdateGroupModal",propType:{enhancedGroupsEnabled:d.bool,groupId:d.string,origGroupName:d.string,origGroupDescription:d.string,onGroupChanged:d.func,isAdminManaged:d.bool,insideAdminConsole:d.bool,origGroupJoinPolicy:d.int,groupJoinPolicyEnabled:d.bool,teamName:d.string},getInitialState:function(){return{newGroupName:this.props.origGroupName,newGroupDescription:this.props.origGroupDescription,newGroupJoinPolicy:this.props.origGroupJoinPolicy,submitting:!1,errors:null}},groupNameIsValid:function(){return this.state.newGroupName.length<=i.MAX_GROUP_NAME_LEN},groupDescriptionIsValid:function(){return null===this.state.newGroupDescription||this.state.newGroupDescription.length<=i.MAX_GROUP_DESCRIPTION_LEN},canProceed:function(){return!this.state.submitting&&this.groupNameIsValid()&&this.groupDescriptionIsValid()},getLocalNameError:function(){if(!this.groupNameIsValid())return{message_text:m("The group name should be under %(max_len)d characters").format({max_len:i.MAX_GROUP_NAME_LEN})}},getLocalDescriptionError:function(){if(!this.groupDescriptionIsValid())return{message_text:m("The group description should be under %(max_len)d characters").format({max_len:i.MAX_GROUP_DESCRIPTION_LEN})}},onChangeGroupName:function(e){return this.setState({newGroupName:e.target.value})},onChangeGroupDescription:function(e){return this.setState({newGroupDescription:e.target.value})},onChangeJoinPolicy:function(e){var t;return t=e.target.checked?u:l,this.setState({newGroupJoinPolicy:t})},onSubmit:function(e){if(null!=e&&e.preventDefault(),this.canProceed()&&!this.state.submitting)return this.setState({submitting:!0}),s.WebRequest({url:"/groups_ajax/update_group",data:{group_id:this.props.groupId,new_name:this.state.newGroupName,new_description:this.state.newGroupDescription,new_join_policy:this.state.newGroupJoinPolicy},subject_user:h.work_user,success:(function(e){return function(t){return t=JSON.parse(t),p.close(),e.props.onGroupChanged(!0,null)}})(this),error:(function(e){return function(t,s,r){if(e.setState({submitting:!1,errors:(function(){try{return JSON.parse(r)}catch(e){}})()}),i.isGroupDeleted(t))return p.close(),i.redirectToGroupsPage(e.props.insideAdminConsole)}})(this)})},render:function(){var t,s,r,n,i;return t=m(this.props.enhancedGroupsEnabled?"Group name and description":"Group name"),e.createElement(p,{className:"update-group-modal",title:m("Edit ‘%(group_name)s’").format({group_name:this.props.origGroupName}),acceptButtonText:m("Save changes"),dismissButtonText:m("Cancel"),acceptButtonDisabled:!this.canProceed(),submitting:this.state.submitting,onAccept:this.onSubmit,autoClose:!1},c.form({onSubmit:this.onSubmit},c.label({className:"label-description"},t),e.createElement(o.text,{className:this.props.enhancedGroupsEnabled?"group-name-input-enhanced":"group-name-input",defaultValue:this.props.origGroupName,placeholder:"Group name",onChange:this.onChangeGroupName,autofocus:!0,"error-after":!1,error:this.getLocalNameError()||(null!=(s=this.state.errors)?s.new_name:void 0)||(null!=(r=this.state.errors)?r.full_name:void 0)}),this.props.enhancedGroupsEnabled?c.label({className:"label-description"},e.createElement(o.textarea,{className:"group-description-input",defaultValue:this.props.origGroupDescription,placeholder:m("Purpose or mission"),onChange:this.onChangeGroupDescription,autofocus:!0,"error-after":!0,error:this.getLocalDescriptionError()||(null!=(n=this.state.errors)?n.new_description:void 0)||(null!=(i=this.state.errors)?i.full_description:void 0)})):void 0,this.props.enhancedGroupsEnabled&&this.props.groupJoinPolicyEnabled?c.div({className:"join-policy u-mar-top-s"},c.input({type:"checkbox",defaultChecked:this.props.origGroupJoinPolicy,onChange:this.onChangeJoinPolicy,disabled:this.props.isAdminManaged}),c.label({},m("Allow anyone at %(team_name)s to join").format({team_name:this.props.teamName})),this.props.isAdminManaged?c.label({className:"disable-join-policy-message"},m(" Only permitted for user-managed groups.")):void 0):void 0))}})})}.call(this),function(){define("modules/clean/groups/utils",["modules/core/browser"],function(e){return(function(){function t(){}return t.MAX_GROUP_NAME_LEN=140,t.MAX_GROUP_DESCRIPTION_LEN=400,t.MAX_ROWS_PER_PAGE=15,t.MAX_ROWS_TO_FETCH_FROM_SERVER=50,t.isGroupDeleted=function(e){var t;return t=e.responseText,t.indexOf("group has been deleted")!==-1},t.redirectToGroupsPage=function(t){var s;return s=t?"/":"groups",e.set_hash(s)},t})()})}.call(this),function(){define("modules/clean/react/paginator",["external/classnames","external/react","external/underscore","modules/clean/react/sprite","modules/core/i18n"],function(e,t,s,r,o){var n,i,a;return i=o._,a=t.DOM,n=t.createClass({displayName:"PaginatorPageButton",propTypes:{enabled:t.PropTypes.bool,active:t.PropTypes.bool,onClick:t.PropTypes.func,optionalClass:t.PropTypes.string},render:function(){var t;return a.li({onClick:this.props.onClick},this.props.enabled?(t={"pagination-link":!0,active:this.props.active},a.a({href:"#",className:e(t,this.props.optionalClass)},this.props.children)):a.span({className:e("pagination-link disabled",this.props.optionalClass)},this.props.children))},getDefaultProps:function(){return{enabled:!0,active:!0,onClick:function(){},optionalClass:""}}}),t.createClass({displayName:"Paginator",propTypes:{max_visible_pages:t.PropTypes.number,onChangePage:t.PropTypes.func,num_pages:t.PropTypes.number,isMaestroDesign:t.PropTypes.bool,optionalClass:t.PropTypes.string},getDefaultProps:function(){return{max_visible_pages:9,num_pages:1,isMaestroDesign:!1}},getInitialState:function(){return{first_page:0,active_page:0}},render:function(){var s,o,u;return this.props.isMaestroDesign?(o=t.createElement(r,{group:"web",name:"chevron",alt:i("left-arrow"),className:"arrow-left-sprite"}),u=t.createElement(r,{group:"web",name:"chevron",alt:i("right-arrow")})):(o=a.span({className:"arrow arrow-left"},i("Previous")),u=a.span({className:"arrow arrow-right"},i("Next"))),a.div({className:"nav nav-inline"},a.ol({className:e("pagination",this.props.optionalClass)},this.need_arrows()?t.createElement(n,{optionalClass:"arrow-left-container",enabled:this.left_button_enabled(),onClick:this.left_clicked},o):void 0,function(){var e,r,o,i;for(o=this.current_visible_pages(),i=[],e=0,r=o.length;e<r;e++)s=o[e],i.push(t.createElement(n,{active:s===this.state.active_page,onClick:this.page_clicked.bind(this,s),key:s},""+(s+1)));return i}.call(this),this.need_arrows()?t.createElement(n,{optionalClass:"arrow-right-container",enabled:this.right_button_enabled(),onClick:this.right_clicked},u):void 0))},need_arrows:function(){return this.props.isMaestroDesign||this.props.num_pages>this.props.max_visible_pages},left_button_enabled:function(){return this.need_arrows()&&this.state.active_page>0},right_button_enabled:function(){return this.need_arrows()&&this.state.active_page<this.props.num_pages-1},current_visible_pages:function(){var e,t,r;return r=this.state.first_page,e=s.min([this.props.num_pages,this.state.first_page+this.props.max_visible_pages]),function(){t=[];for(var s=r;r<=e?s<e:s>e;r<=e?s++:s--)t.push(s);return t}.apply(this)},ensure_in_range:function(e,t,s){return Math.max(t,Math.min(s,e))},setActivePage:function(e){var t,s,r;e=this.ensure_in_range(e,0,this.props.num_pages-1),s=e-Math.floor(this.props.max_visible_pages/2),s=this.ensure_in_range(s,0,this.props.num_pages-this.props.max_visible_pages),r=s+this.props.max_visible_pages,e!==this.state.active_page&&"function"==typeof(t=this.props).onChangePage&&t.onChangePage(e),this.setState({first_page:s,last_page:r,active_page:e})},left_clicked:function(e){return e.preventDefault(),this.setActivePage(this.state.active_page-1)},right_clicked:function(e){return e.preventDefault(),this.setActivePage(this.state.active_page+1)},page_clicked:function(e,t){return t.preventDefault(),this.setActivePage(e)}})})}.call(this),function(){var e=[].slice;define("modules/clean/react/table",["external/classnames","external/react","jquery","external/lru","modules/core/i18n","modules/clean/react/paginator"],function(t,s,r,o,n,i){var a,u,l,p,m,c,d;return p=n._,c=s.DOM,d=s.PropTypes,m=function(){var s;return s=1<=arguments.length?e.call(arguments,0):[],t(r.extend.apply(r,[{}].concat(e.call(s))))},a=1,u=-1,l="—",s.createClass({displayName:"Table",propTypes:{columns:d.arrayOf(d.shape({field:d.string,header:d.node,width:d.oneOfType([d.number,d.string]),sortable:d.bool,initialSortDir:d.number,classes:d.object,render:d.func})),handleTableUpdated:d.func,onRequestData:d.func,onTotalUpdated:d.func,initialData:d.shape({total:d.number,rows:d.array}),initialDataLoading:d.bool,emptyMessage:d.node,classes:d.object,headerClasses:d.object,bodyClasses:d.object,rowClasses:d.oneOfType([d.object,d.func]),cellClasses:d.object,paginatorClasses:d.string,initialSortColumn:d.number,initialSortDir:d.number,rowsPerPage:d.number,infiniteScroll:d.bool,rowsPerRequestForInfiniteScroll:d.number,loadingIndicator:d.string,onRowClicked:d.func,hideHeaderOnEmptyTable:d.bool,isMaestroDesign:d.bool,staticRow:d.shape({field:d.string,rowClass:d.string,render:d.func,showOnAllPages:d.bool})},statics:{ASC_DIR:a,DESC_DIR:u},getDefaultProps:function(){return{initialSortColumn:0,initialSortDir:a,rowsPerPage:10,hideHeaderOnEmptyTable:!1}},getInitialState:function(){var e,t,s,r,o;return{total:null!=(e=null!=(t=this.props.initialData)?t.total:void 0)?e:0,rows:null!=(s=this.props.infiniteScroll?null!=(r=this.props.initialData)?r.rows:void 0:null!=(o=this.props.initialData)?o.rows.slice(0,this.props.rowsPerPage):void 0)?s:[],currentPage:0,sortColumn:this.props.initialSortColumn,sortDir:this.props.initialSortDir,loading:this.props.initialDataLoading}},componentWillMount:function(){var e;if(this.cache=new o(1e3),!(null!=(e=this.props.initialData)?e.rows:void 0)&&!this.state.loading)return this.refreshData()},componentDidMount:function(){if(this.props.infiniteScroll&&window.addEventListener("scroll",this.onScroll),this.props.handleTableUpdated&&!this.state.loading)return this.props.handleTableUpdated()},
componentDidUpdate:function(){if(this.props.handleTableUpdated&&!this.state.loading)return this.props.handleTableUpdated()},componentWillUnmount:function(){if(this.props.infiniteScroll)return window.removeEventListener("scroll",this.onScroll)},forceRefresh:function(){return this.cache.removeAll(),this.props.infiniteScroll?(window.scrollTo(0,0),this.refreshData(!0)):this.setState({rows:[]},this.refreshData)},onInitialDataLoaded:function(e){var t,s;return this.setState({loading:!1,total:null!=(t=null!=e?e.total:void 0)?t:0,rows:null!=(s=this.props.infiniteScroll?null!=e?e.rows:void 0:null!=e?e.rows.slice(0,this.props.rowsPerPage):void 0)?s:[]})},updateRows:function(e){return this.setState({rows:e(this.state.rows)})},refreshData:function(e){var t,s,r,o,n,i,a;if(null==e&&(e=!1),!(this.props.infiniteScroll&&this.state.rows.length>=this.state.total&&0!==this.state.total)||e)return a=e?[]:this.state.rows,this.setState({loading:!0}),n=this.props.infiniteScroll?{offset:a.length,limit:this.props.rowsPerRequestForInfiniteScroll,sortColumn:null!=(r=this.props.columns[this.state.sortColumn])?r.field:void 0,sortDir:this.state.sortDir}:{offset:this.state.currentPage*this.props.rowsPerPage,limit:this.props.rowsPerPage,sortColumn:null!=(o=this.props.columns[this.state.sortColumn])?o.field:void 0,sortDir:this.state.sortDir},t=JSON.stringify(n),(s=this.cache.get(t))?(this.props.infiniteScroll?this.setState({rows:a.concat(s.rows),total:s.total}):this.setState(s),void this.setState({loading:!1})):(null==this.requestId&&(this.requestId=0),i=++this.requestId,this.props.onRequestData(n,(function(e){return function(s,r,o){var n,u;if(null==s&&e.requestId===i)return u={rows:r.rows,total:r.total},e.cache.put(t,u),"function"==typeof(n=e.props).onTotalUpdated&&n.onTotalUpdated(u.total),e.props.infiniteScroll?e.setState({rows:a.concat(u.rows),total:u.total}):e.setState(u),(null!=o?o.displayLoading:void 0)?void 0:e.setState({loading:!1})}})(this)))},onColumnHeaderClick:function(e){var t,s;if(this.props.columns[e].sortable!==!1)return t=e===this.state.sortColumn?{sortDir:-this.state.sortDir}:{sortColumn:e,sortDir:null!=(s=this.props.columns[e].initialSortDir)?s:a},this.props.infiniteScroll&&(t.rows=[]),this.setState(t,(function(e){return function(){return e.refreshData()}})(this))},onChangePage:function(e){return this.setState({currentPage:e},this.refreshData)},onScroll:function(e){if(this.props.infiniteScroll)return window.innerHeight+Math.ceil(window.pageYOffset)>=document.body.offsetHeight?this.refreshData():void 0},renderStaticRow:function(){var e,t;return t=this.props.staticRow,e=t.showOnAllPages||0===this.state.currentPage,e?c.li({className:m(t.rowClass,{"table-row":!0}),key:"static-row-0"},c.span({className:m(this.props.cellClasses,{"table-cell":!0})},t.render())):null},render:function(){var e,t,r,o,n,d,h;return r=0===this.state.total&&!this.state.loading,c.div({className:m(this.props.classes,{"table-container":!0})},r&&this.props.hideHeaderOnEmptyTable?void 0:c.div({className:m(this.props.headerClasses,{"table-header":!0})},function(){var s,r,o,n;for(o=this.props.columns,n=[],e=s=0,r=o.length;s<r;e=++s)t=o[e],n.push(c.div({className:m(t.classes,this.props.cellClasses,{"table-column-header":!0,nonsortable:t.sortable===!1,sorted:t.sortable!==!1&&this.state.sortColumn===e}),style:{width:t.width},onClick:this.onColumnHeaderClick.bind(this,e),key:e},t.header,function(){if(t.sortable!==!1&&this.state.sortColumn===e)switch(this.state.sortDir){case a:return c.span({className:"sort-arrow sort-arrow-up"});case u:return c.span({className:"sort-arrow sort-arrow-down"})}}.call(this)));return n}.call(this)),r?c.div({className:"empty-message"},this.props.emptyMessage):this.state.rows.length>0?c.ol({className:m(this.props.bodyClasses,{"table-body":!0,loading:this.state.loading})},this.props.staticRow?this.renderStaticRow():void 0,function(){var s,r,o,i,a;for(o=this.state.rows,a=[],h=s=0,r=o.length;s<r;h=++s)n=o[h],d="function"==typeof this.props.rowClasses?this.props.rowClasses(n):this.props.rowClasses,a.push(c.li({className:m(d,{"table-row":!0}),key:h,onClick:null!=(i=this.props.onRowClicked)?i.bind(this,n):void 0},function(){var s,r,o,i,a,u;for(o=this.props.columns,u=[],e=s=0,r=o.length;s<r;e=++s)t=o[e],u.push(c.span({className:m(t.classes,this.props.cellClasses,{"table-cell":!0}),style:{width:t.width},key:e},null!=(i=null!=(a="function"==typeof t.render?t.render(n):void 0)?a:n[t.field])?i:c.span({className:"null-field"},l)));return u}.call(this)));return a}.call(this)):c.div({className:"spacer"}),this.state.loading?c.div({className:"loading-message"},this.props.loadingIndicator?c.img({src:this.props.loadingIndicator,alt:p("Loading...")}):p("Loading...")):void 0,!this.props.infiniteScroll&&this.state.total>this.props.rowsPerPage?(o=s.createElement(i,{num_pages:Math.ceil(this.state.total/this.props.rowsPerPage),onChangePage:this.onChangePage,isMaestroDesign:this.props.isMaestroDesign,optionalClass:this.props.paginatorClasses}),this.props.isMaestroDesign?c.div({className:"pagination-container"},o):o):void 0)}})})}.call(this),function(){define("modules/clean/teams/limited_team_settings_modal",["external/react","modules/core/browser","modules/clean/react/button","modules/core/i18n","modules/clean/ajax","modules/clean/analytics","modules/clean/react/input","modules/clean/react/modal","modules/clean/react/teams/modals/limited_team_upsell_modal_banner","modules/clean/teams/notes_link_policy_select","modules/clean/teams/request_membership_policy_select","modules/clean/teams/modals/delete_team_modal","modules/constants/trademark","modules/core/notify"],function(e,t,s,r,o,n,i,a,u,l,p,m,c,d){var h,g,f,_,b,v,w,y;return s.button,b=r._,_=n.TeamsWebActionsLogger,g=a.Modal,h=m.DeleteTeamModal,f=c.TRADEMARK_BUSINESS,w=e.DOM,v=e.createElement,y=e.PropTypes,e.createClass({mixins:[e.addons.LinkedStateMixin],displayName:"LimitedTeamSettingsModal",propTypes:{onUpdated:y.func,canChangeTeamName:y.bool.isRequired,canDeleteTeam:y.bool.isRequired,canSetTeamRequestMembershipPolicy:y.bool.isRequired,canChangeNotesLinkPolicy:y.bool,teamDomain:y.string.isRequired,teamId:y.number.isRequired,initialTeamName:y.string.isRequired,initialTeamFullName:y.string.isRequired,initialTeamRequestMembershipPolicy:y.number.isRequired,initialNotesLinkPolicy:y.number.isRequired},getInitialState:function(){return{submitting:!1,errors:{},teamName:this.props.initialTeamName,teamRequestMembershipPolicy:this.props.initialTeamRequestMembershipPolicy,notesLinkPolicy:this.props.initialNotesLinkPolicy}},_teamNameHasChanged:function(){return this.state.teamName.trim()!==this.props.initialTeamName},_teamPolicyHasChanged:function(){return this.state.teamRequestMembershipPolicy!==this.props.initialTeamRequestMembershipPolicy},_notesPolicyHasChanged:function(){return this.state.notesLinkPolicy!==this.props.initialNotesLinkPolicy},_canProceed:function(){return!this.state.submitting&&(""!==this.state.teamName.trim()&&this.props.canChangeTeamName&&this._teamNameHasChanged()||this.props.canSetTeamRequestMembershipPolicy&&this._teamPolicyHasChanged())||this.props.canChangeNotesLinkPolicy&&this._notesPolicyHasChanged()},_onAjaxError:function(){return this.setState({submitting:!1})},_onClickSave:function(e){var s,r,n;e.preventDefault(),this.setState({submitting:!0}),n=(function(e){return function(t){return e.state.teamName,e.props.canChangeTeamName&&e._teamNameHasChanged()?o.WebRequest({url:"/team/manage/rename",data:{team_id:e.props.teamId,orig_name:e.props.initialTeamName,orig_full_name:e.props.initialTeamFullName,new_name:e.state.teamName,full_name:e.state.teamName},error:function(t,s,r){try{e.setState({errors:JSON.parse(r)})}catch(t){e.setState({errors:r})}return d.error(b("There was a problem completing this request.")),e._onAjaxError()},success:t}):"function"==typeof t?t():void 0}})(this),r=(function(e){return function(t){return e.props.canSetTeamRequestMembershipPolicy&&e._teamPolicyHasChanged()?o.WebRequest({url:"/team/manage/set_request_membership_policy",data:{new_team_policy:e.state.teamRequestMembershipPolicy},error:e._onAjaxError,success:t}):"function"==typeof t?t():void 0}})(this),s=(function(e){return function(t){return e.props.canChangeNotesLinkPolicy&&e._notesPolicyHasChanged()?o.WebRequest({url:"/team/manage/set_paper_link_policy",data:{new_link_policy:e.state.notesLinkPolicy},error:e._onAjaxError,success:t}):"function"==typeof t?t():void 0}})(this),n((function(e){return function(){return r(function(){return s(function(){var s;"function"==typeof(s=e.props).onUpdated&&s.onUpdated(),t.reload()})})}})(this))},_onDismissModal:function(){_.log("canceled_update_team_settings")},_renderCTA:function(){return v(u,{upsellText:b("Looking for more advanced settings? Upgrade to get more security features and admin controls."),upgradeButtonText:b("Upgrade to %(trademark_business)s").format({trademark_business:f}),redirectQuery:{tk:"team_settings",_camp:"settings_modal"},redirectUrl:"/business"})},_renderTeamNameForm:function(){return[w.label({className:"limited-team-settings-modal-content__company-name-label",htmlFor:"limited-team-settings-modal-content__company-name-input"},b("Company name")),v(i.text,{label:b("Company or organization name"),className:"limited-team-settings-modal-content__company-name-input",id:"limited-team-settings-modal-content__company-name-input",valueLink:this.linkState("teamName"),error:this.state.errors.new_name})]},_renderMembershipApprovalPolicyForm:function(){return v(p,{teamDomain:this.props.teamDomain,valueLink:this.linkState("teamRequestMembershipPolicy")})},_renderNotesLinkPolicyForm:function(){return v(l,{teamDomain:this.props.teamDomain,valueLink:this.linkState("notesLinkPolicy")})},_renderDeleteTeamButton:function(){return w.div({className:"delete-team-button-section"},w.button({className:"delete-team-button button-tertiary",onClick:this._deleteTeam},b("Delete team")))},_deleteTeam:function(){return g.showInstance(v(h,{teamName:this.state.teamName,teamId:this.props.teamId}))},render:function(){return v(g,{title:b("Team settings"),acceptButtonText:b("Save settings"),dismissButtonText:b("Cancel"),onAccept:this._onClickSave,onDismiss:this._onDismissModal,acceptButtonDisabled:!this._canProceed(),submitting:this.state.submitting,altAction:this._renderCTA(),className:"limited-team-settings-modal",ref:"modal"},w.div({className:"limited-team-settings-modal-content"},this.props.canChangeTeamName?this._renderTeamNameForm():void 0,this.props.canSetTeamRequestMembershipPolicy?this._renderMembershipApprovalPolicyForm():void 0,this.props.canChangeNotesLinkPolicy?this._renderNotesLinkPolicyForm():void 0),this.props.canDeleteTeam?this._renderDeleteTeamButton():void 0)}})})}.call(this),function(){define("modules/clean/teams/limited_team_tooltip_runner",["jquery","external/underscore","external/react","external/react-dom","external/immutable","modules/core/browser","modules/core/i18n","modules/core/exception","modules/clean/ajax","modules/clean/react/bubble","modules/clean/react/css","modules/clean/react/sprite","modules/clean/react/button","modules/clean/static_urls"],function(e,t,s,r,o,n,i,a,u,l,p,m,c,d){var h,g,f,_,assert,b,v,w,y;return i._,assert=a.assert,y=d.static_url,v=s.DOM,b=s.createElement,w=s.PropTypes,f=o.Record({heading:"",body:"",buttonText:"",arrowDirection:null,cssSelector:"",imageHref:"",imageHrefHires:"",imageHeight:"",imageWidth:null,onButtonClick:null,onButtonClickImmediate:null}),g=function(e,s,r){var o,n;if(n=t(e.tooltipSpecs).keys(),t(e[s]).difference(n).length&&(o="Invalid prop "+s+" supplied to "+r+". All "+s+" values must exist in tooltipSpecs"),e[s]||(o="Prop "+s+" must be supplied to "+r+"."),o)return new Error(o)},_=s.createClass({BUBBLE_WIDTH:250,displayName:"LimitedTeamTooltipRunner",propTypes:{initialServerStep:w.number.isRequired,serverStepOffset:w.number.isRequired,tooltipSpecs:w.objectOf(w.instanceOf(f)).isRequired,tooltipSpecOrder:g,lastTooltipDismissedCb:w.func,onStepAdvancedCb:w.func},getInitialState:function(){return{currentStepNumber:this.props.initialServerStep-this.props.serverStepOffset,waitingForServerResponse:!1}},componentDidMount:function(){return"complete"===document.readyState?this._initBubbleTracking():e(window).load(this._initBubbleTracking)},componentDidUpdate:function(){return this._setBubbleLocation()},componentWillUnmount:function(){return e(window).off("resize",this._setBubbleLocation)},_initBubbleTracking:function(){return this._setBubbleLocation(),e(window).resize(this._setBubbleLocation)},_specForStepNumber:function(e){return this.props.tooltipSpecs[this.props.tooltipSpecOrder[e]]},_recordStepSeen:function(e){return u.WebRequest({url:"/team/onboarding_event",data:{stage:this.state.currentStepNumber+this.props.serverStepOffset},success:e})},_recordAndAdvance:function(){var e;if(!this.state.waitingForServerResponse)return this.setState({waitingForServerResponse:!0}),e=this._specForStepNumber(this.state.currentStepNumber),"function"==typeof e.onButtonClickImmediate&&e.onButtonClickImmediate(),this._recordStepSeen((function(t){return function(s){var r,o;return r=parseInt(JSON.parse(s).next_state),t.state.currentStepNumber===t.props.tooltipSpecOrder.length-1?t.props.lastTooltipDismissedCb(r):(o=function(){var e;return t.setState({currentStepNumber:r-t.props.serverStepOffset,waitingForServerResponse:!1}),"function"==typeof(e=t.props).onStepAdvancedCb?e.onStepAdvancedCb(r):void 0},e.onButtonClick?e.onButtonClick(o):o())}})(this))},_setBubbleLocation:function(){var t,s,o,n,i,a,u,p,m,c,d,h,g,f,_;if(g=this._specForStepNumber(this.state.currentStepNumber),assert((d=g.arrowDirection)===l.ARROW.TOP||d===l.ARROW.LEFT||d===l.ARROW.LEFT_TOP,"trying to setBubbleLocation with unsupported arrow direction. Please add code for computing bubble location"),t=e(".react-bubble-box__arrow-border"),o=e(g.cssSelector),o.length){switch(s=e(r.findDOMNode(this.refs.tooltipBubble)),h=o.offset(),a=s.offsetParent().offset(),m=h.left-a.left,c=h.top-a.top,p=function(e){return Math.floor(e.outerWidth()/2)},u=function(e){return Math.floor(e.outerHeight()/2)},g.arrowDirection){case l.ARROW.TOP:n=t.outerHeight(),n>40&&(n=18),f=m-p(s)+p(o),_=c+o.outerHeight()+n;break;case l.ARROW.LEFT:i=t.outerWidth(),i>40&&(i=18),f=m+o.outerWidth()+i,_=c-u(s)+u(o);break;case l.ARROW.LEFT_TOP:i=t.outerWidth(),i>40&&(i=18),f=m+o.outerWidth()+i,_=c-u(o)}return s.css({top:_,left:f,visibility:"visible"})}},render:function(){var e;return e=this._specForStepNumber(this.state.currentStepNumber),v.div({className:"limited-team-tooltips"},b(l,{ref:"tooltipBubble",arrow:e.arrowDirection,className:"limited-team-tooltips__bubble",style:{position:"absolute",width:this.BUBBLE_WIDTH,visibility:"hidden"}},v.div({className:"limited-team-tooltips__bubble-contents"},v.img({src:y(e.imageHref),srcHiRes:y(e.imageHrefHires||e.imageHref),className:"limited-team-tooltips__bubble-image",width:e.imageWidth||.84*this.BUBBLE_WIDTH,height:e.imageHeight,alt:""}),v.h2({},e.heading),v.p({},e.body),v.button({className:"button-primary limited-team-tooltips__bubble-button",onClick:this._recordAndAdvance},e.buttonText))))}}),h=p(_,["/static/css/react/bubble_box-vflpfsqHZ.css"]),{LimitedTeamTooltipRunner:h,TooltipSpec:f}})}.call(this),function(){define("modules/clean/teams/limited_team_tooltips",["external/react","modules/clean/react/bubble","modules/core/browser","modules/core/i18n","modules/clean/teams/limited_team_tooltip_runner"],function(e,t,s,r,o){var n,i,a,u,l;return a=r._,n=o.LimitedTeamTooltipRunner,i=o.TooltipSpec,u=e.createElement,l=e.PropTypes,e.createClass({displayName:"LimitedTeamTooltips",propTypes:{onboardingState:l.number.isRequired,lastTooltipDismissedCb:l.func,showPaperInNewTab:l.bool},getDefaultProps:function(){return{showPaperInNewTab:!0}},_getTooltipSpecs:function(){return{TEAM_TAB:new i({heading:a("Manage membership"),body:a("Invite people, remove members, and customize your work Dropbox here."),arrowDirection:t.ARROW.LEFT,buttonText:a("Next"),cssSelector:".team-nav-item",imageHref:"/static/images/teams/fastrak-rainbow/illo_tooltips_manage-vflXw6tGQ.png",imageHrefHires:"/static/images/teams/fastrak-rainbow/illo_tooltips_manage@2x-vflS2wbhg.png",imageHeight:130,onButtonClick:function(){return s.redirect("/team")}}),INVITE_MEMBERS:new i({heading:a("Invite more people"),body:a("Invite coworkers to join your work Dropbox here."),arrowDirection:t.ARROW.TOP,buttonText:a("Next"),cssSelector:".invite-button",imageHref:"/static/images/teams/fastrak-rainbow/illo_tooltips_invite-vflwGI3rs.png",imageHrefHires:"/static/images/teams/fastrak-rainbow/illo_tooltips_invite@2x-vflujxc7r.png",imageHeight:130}),GROUPS:new i({heading:a("Create and view groups"),body:a("Keep things organized by adding people to groups."),arrowDirection:t.ARROW.TOP,buttonText:a("Next"),cssSelector:"#tab_team-tab-groups",imageHref:"/static/images/teams/fastrak-rainbow/illo_tooltips_groups-vflUdtiBT.png",imageHrefHires:"/static/images/teams/fastrak-rainbow/illo_tooltips_groups@2x-vflYWShtX.png",imageHeight:130}),SETTINGS:new i({heading:a("Customize settings"),body:a("Update Paper sharing settings, change the name of your Dropbox, and more."),arrowDirection:t.ARROW.TOP,buttonText:a("Next"),cssSelector:".settings-button",imageHref:"/static/images/teams/fastrak-rainbow/illo_tooltips_settings-vflTnLAOr.png",imageHrefHires:"/static/images/teams/fastrak-rainbow/illo_tooltips_settings@2x-vflClprJl.png",imageHeight:130}),PAPER:new i({heading:a("Dropbox Paper"),body:a("Check out the best way to create and build on ideas with your team."),arrowDirection:t.ARROW.LEFT,buttonText:a("Next"),cssSelector:".composer-nav-item",imageHref:"/static/images/teams/fastrak-rainbow/illo_tooltips_paper-vflQyNMh5.png",imageHrefHires:"/static/images/teams/fastrak-rainbow/illo_tooltips_paper@2x-vfl7TJoJA.png",imageHeight:130,onButtonClickImmediate:(function(e){return function(){if(e.props.showPaperInNewTab)return s.open_tab("/paper")}})(this)})}},BUBBLE_INFO_ARRAY:["TEAM_TAB","INVITE_MEMBERS","GROUPS","SETTINGS","PAPER"],render:function(){return u(n,{initialServerStep:this.props.onboardingState,lastTooltipDismissedCb:this.props.lastTooltipDismissedCb,serverStepOffset:2,tooltipSpecs:this._getTooltipSpecs(),tooltipSpecOrder:this.BUBBLE_INFO_ARRAY})}})})}.call(this),function(){define("modules/clean/teams/modals/account_pair_suggest_modal",["external/react","modules/core/browser","modules/core/i18n","modules/core/uri","modules/clean/analytics","modules/clean/react/modal"],function(e,t,s,r,o,n){var i,a,u,l,p,m;return u=s._,a=o.TeamsWebActionsLogger,i=n.Modal,p=e.DOM,l=e.createElement,m=e.PropTypes,e.createClass({displayName:"AccountPairSuggestModal",propTypes:{suggested_email:m.string,current_email:m.string,cont:m.string},componentDidMount:function(){return a.log("account_pair_suggest_modal_shown")},_onContinue:function(){return t.redirect(new r({path:"/team/join/new_pair",query:this.props.cont?{cont:this.props.cont}:{}}))},render:function(){return l(i,{title:u("Connect your personal Dropbox"),acceptButtonText:u("Continue"),onAccept:this._onContinue,className:"account-pair-suggest-modal"},p.div({className:"account-pair-suggest-modal-content"},u("You can connect a personal Dropbox (%(suggested_email)s) with your new work Dropbox (%(current_email)s) to sync both Dropboxes to all your devices. You can easily switch between them without signing in and out, on both web and mobile.").format({suggested_email:this.props.suggested_email,current_email:this.props.current_email})))}})})}.call(this),function(){define("modules/clean/teams/modals/delete_team_modal",["external/react","modules/core/i18n","modules/core/notify","modules/core/browser","modules/clean/ajax","modules/clean/react/modal","modules/clean/viewer"],function(e,t,s,r,o,n,i){var a,u,l,p,m;return l=t._,u=n.Modal,e.DOM,p=e.PropTypes,m=i.get_viewer(),a=e.createClass({displayName:"DeleteTeamModal",propTypes:{teamName:p.string.isRequired,teamId:p.number.isRequired},getInitialState:function(){return{submitting:!1}},_teamDeleted:function(){return s.success(l("You successfully deleted the team.")),r.redirect("/home")},_onAccept:function(){return this.setState({submitting:!0}),o.WebRequest({url:"/team/manage/delete",data:{team_id:this.props.teamId,_subject_uid:m.work_user.id},complete:(function(e){return function(){return e._teamDeleted()}})(this),success:(function(e){return function(){return e._teamDeleted()}})(this)})},render:function(){var t;return t=l("The %(team_name)s team will be permanently deleted and all members will be removed. Your team’s folders will be converted to shared folders, nested shared folders will be flattened and your %(team_name)s groups will be deleted. Every member’s account will be converted to a personal Dropbox.").format({team_name:this.props.teamName}),e.createElement(u,{title:l("Delete team?"),acceptButtonText:l("Delete"),dismissButtonText:l("Cancel"),submitting:this.state.submitting,acceptButtonDisabled:this.state.submitting,dismissButtonDisabled:this.state.submitting,autoClose:!1,onAccept:this._onAccept},t)}}),{DeleteTeamModal:a}})}.call(this),function(){define("modules/clean/teams/modals/leave_team_modal",["external/react","modules/core/i18n","modules/core/notify","modules/core/browser","modules/clean/ajax","modules/clean/react/modal","modules/clean/viewer"],function(e,t,s,r,o,n,i){var a,u,l,p,m,c,d,h;return m=t._,p=n.Modal,c=e.DOM,d=e.PropTypes,h=i.get_viewer(),l=e.createClass({displayName:"LeaveTeamModal",propTypes:{teamName:d.string,canHaveAdminUi:d.bool},getInitialState:function(){return{submitting:!1}},onAccept:function(){return this.setState({submitting:!0}),o.WebRequest({url:"/team/manage/leave",data:{user_id:h.work_user.id},complete:(function(e){return function(){return e.setState({submitting:!1})}})(this),success:function(){return s.success(m("You left the team.")),r.redirect("/team")}})},render:function(){var t;return t=this.props.canHaveAdminUi?m("You’ll lose access to all %(team_name)s groups. Your account will be converted to a personal Dropbox.").format({team_name:this.props.teamName}):m("You’ll lose access to the %(team_name)s team folder and all %(team_name)s groups. Your account will be converted to a personal Dropbox.").format({team_name:this.props.teamName}),e.createElement(p,{title:m("Leave team?"),acceptButtonText:m("Leave team"),dismissButtonText:m("Cancel"),submitting:this.state.submitting,autoClose:!1,onAccept:this.onAccept},t)}}),a=e.createClass({displayName:"LeaveTeamAsSoleLimitedAdminWarningModal",propTypes:{teamName:d.string},render:function(){return e.createElement(p,{title:m("You must give admin permissions to someone else"),acceptButtonText:m("I understand"),submitting:!1,autoClose:!0},m("Since you’re the only admin of %(team_name)s, you need to give someone else on your team admin permissions before you leave the team. You can do this by clicking the gear icon to the right of a team member’s name and selecting “Give admin permissions”.").format({team_name:this.props.teamName}))}}),u=e.createClass({displayName:"LeaveTeamButton",propTypes:{teamName:d.string,showWarningOnLeaveTeam:d.bool,canHaveAdminUi:d.bool},showLeaveTeamModal:function(){return this.props.showWarningOnLeaveTeam?p.showInstance(e.createElement(a,{teamName:this.props.teamName})):p.showInstance(e.createElement(l,{teamName:this.props.teamName,canHaveAdminUi:this.props.canHaveAdminUi}))},render:function(){return c.button({className:"leave-team-button",onClick:this.showLeaveTeamModal},m("Leave team"))}}),{LeaveTeamModal:l,LeaveTeamAsSoleLimitedAdminWarningModal:a,LeaveTeamButton:u}})}.call(this),function(){define("modules/clean/teams/modals/remove_member_modal",["external/react","external/purify","modules/core/i18n","modules/core/notify","modules/clean/ajax","modules/clean/react/modal","modules/clean/teams/constants","modules/clean/react/select","modules/clean/react/sprite","modules/clean/react/teams/modals/limited_team_upsell_modal_banner","modules/clean/viewer","modules/clean/analytics","modules/constants/trademark"],function(e,t,s,r,o,n,i,a,u,l,p,m,c){var d,h,g,f,_,b,v,w,y,M;return b=s._,h=n.Modal,d=i.JOIN_STATES,_=m.TeamsWebActionsLogger,f=c.TRADEMARK_BUSINESS,w=e.DOM,y=e.PropTypes,v=e.createElement,M=p.get_viewer(),g=e.createClass({displayName:"RemoveMemberModal",propTypes:{teamName:y.string,showUpsellVariant:y.bool,user:y.object,onRemoved:y.func},getInitialState:function(){return{submitting:!1}},onAccept:function(){return _.log("teams_click_remove_member_confirm",{user_id:this._getSignedInUser().id,user_being_removed_id:this.props.user.user_id,user_being_removed_join_state:this.props.user.team_join_state,variant:this.props.showUpsellVariant?"VARIANT":"CONTROL",team_id:M.team_id}),this.setState({submitting:!0}),o.WebRequest({url:this.props.user.join_request_status?"/team/join_request/reject":"/team/manage/kick",data:{user_id:this.props.user.user_id},complete:(function(e){return function(){if(e.isMounted())return e.setState({submitting:!1})}})(this),success:(function(e){return function(){var t;return e.props.user.team_join_state===d.ACTIVE?r.success(b("Member removed.")):r.success(b("Pending member removed.")),h.close(),"function"==typeof(t=e.props).onRemoved?t.onRemoved():void 0}})(this)})},onShow:function(){return _.log("teams_seen_remove_member_modal",{user_id:this._getSignedInUser().id,user_being_removed_id:this.props.user.user_id,user_being_removed_join_state:this.props.user.team_join_state,variant:this.props.showUpsellVariant?"VARIANT":"CONTROL",team_id:M.team_id})},onDismiss:function(){return _.log("teams_click_remove_member_cancel",{user_id:this._getSignedInUser().id,user_being_removed_id:this.props.user.user_id,user_being_removed_join_state:this.props.user.team_join_state,variant:this.props.showUpsellVariant?"VARIANT":"CONTROL",team_id:M.team_id})},getNameToUse:function(e){return e.display_name?b("%(user_name)s (%(user_email)s)").format({user_name:e.display_name,user_email:e.email}):b("%(user_email)s").format({user_email:e.email})},_getSignedInUser:function(){return M.work_user||M.personal_user},_renderCTA:function(){return v(l,{upsellText:b("Unlock the options to remote wipe and transfer files by upgrading to %(trademark_business)s").format({trademark_business:f}),upgradeButtonText:b("Upgrade to %(trademark_business)s").format({trademark_business:f}),redirectQuery:{tk:"remove_member",_camp:"modal"}})},render:function(){var e,s;return s=this.props.user.team_join_state===d.ACTIVE,e=this._getSignedInUser(),v(h,{title:b(s?"Remove member?":"Remove pending member?"),acceptButtonText:b("Remove"),dismissButtonText:b("Cancel"),submitting:this.state.submitting,autoClose:!1,altAction:this.props.showUpsellVariant&&s?this._renderCTA():null,onAccept:this.onAccept,onShow:this.onShow,onDismiss:this.onDismiss},w.div({className:"remove-member-modal-section"},w.div({className:"remove-member-modal-description"},s?this.props.user.is_admin?b("%(user_presented_name)s will lose access to all %(team_name)s groups. %(user_first_name)s’s account will be converted to a personal Dropbox.").format({user_first_name:t.sanitize(this.props.user.fname),user_presented_name:t.sanitize(this.getNameToUse(this.props.user)),user_email:t.sanitize(this.props.user.email),team_name:t.sanitize(this.props.teamName)}):b("%(user_presented_name)s will lose access to the %(team_name)s team folder and be removed from all %(team_name)s groups. %(user_first_name)s’s account will be converted to a personal Dropbox.").format({user_first_name:t.sanitize(this.props.user.fname),user_presented_name:t.sanitize(this.getNameToUse(this.props.user)),user_email:t.sanitize(this.props.user.email),team_name:t.sanitize(this.props.teamName)}):b("%(user_presented_name)s will be removed from the members list. Any invitation or activation links you’ve sent will no longer work.").format({team_name:t.sanitize(this.props.teamName),user_presented_name:t.sanitize(this.getNameToUse(this.props.user))})),this.props.showUpsellVariant&&s?[w.div({className:"remove-member-modal-disabled-feature u-mar-top-m"},w.input({type:"checkbox",checked:!1,disabled:!0},b("Remote wipe this member’s %(team_name)s team files.").format({team_name:t.sanitize(this.props.teamName)}),w.a({className:"remove-member-modal-info",href:"/en/help/4227",target:"_blank"},v(u,{group:"web",name:"info"})))),w.div({className:"remove-member-modal-disabled-feature u-mar-top-m"},w.input({type:"checkbox",checked:!1,disabled:!0},b("Transfer this user’s files to"),w.a({className:"remove-member-modal-info",href:"/en/help/4228",target:"_blank"},v(u,{group:"web",name:"info"})))),v(a.input,{className:"remove-member-modal-transfer-files-select u-mar-top-xs u-mar-btm-m",value:0,"disable-errors":!0,isDisabled:!0},v(a.option,{value:0},e.display_name+" ("+e.email+")"))]:void 0))}}),{RemoveMemberModal:g}})}.call(this),function(){define("modules/clean/teams/modals/set_limited_admin_modals",["external/react","external/purify","modules/core/notify","modules/core/i18n","modules/clean/react_format","modules/clean/ajax","modules/clean/react/modal","modules/clean/teams/constants","modules/constants/trademark"],function(e,t,s,r,o,n,i,a,u){var l,p,m,c,d,h,g,f,_,b;return g=r._,b=o.reactFormat,m=i.Modal,l=a.ADMIN_ROLE,h=u.TRADEMARK_BUSINESS,f=e.DOM,_=e.PropTypes,p=e.createClass({displayName:"GiveLimitedAdminModal",propTypes:{targetUser:_.object,teamId:_.number,onSuccess:_.func},getInitialState:function(){return{submitting:!1}},onAccept:function(){return this.setState({submitting:!0}),n.WebRequest({url:"/account/team/set_admin_status",data:{team_id:this.props.teamId,user_id:this.props.targetUser.user_id,on:"yes",role:l.LIMITED},success:(function(e){return function(){return e.props.onSuccess(),m.close()}})(this),complete:(function(e){return function(){if(e.isMounted())return e.setState({submitting:!1})}})(this)})},render:function(){var t;return t=b(g("Are you sure you want to give admin permissions to %(user_name)s? All users with admin permissions will be able to upgrade this team to <businessLink>%(trademark_business)s</businessLink>."),{user_name:this.props.targetUser.display_name,trademark_business:h,businessLink:f.a({href:"/business"})}),e.createElement(m,{title:g("Change Admin Permissions for %(user_name)s").format({user_name:this.props.targetUser.display_name}),acceptButtonText:g("Confirm"),dismissButtonText:g("Cancel"),submitting:this.state.submitting,autoClose:!1,onAccept:this.onAccept},f.div({},t))}}),c=e.createClass({displayName:"RemoveLimitedAdminModal",propTypes:{targetUser:_.object,teamId:_.number,removingOwnPermissions:_.bool,onSuccess:_.func},getInitialState:function(){return{submitting:!1}},onAccept:function(){return this.setState({submitting:!0}),n.WebRequest({url:"/account/team/set_admin_status",data:{team_id:this.props.teamId,user_id:this.props.targetUser.user_id,on:"no",role:l.NONE},success:(function(e){return function(){return e.props.onSuccess(),m.close()}})(this),complete:(function(e){return function(){if(e.isMounted())return e.setState({submitting:!1})}})(this)})},render:function(){var t,s;return this.props.removingOwnPermissions?(s=g("Are you sure you no longer want admin permissions?"),t=g("If you remove your admin permissions, you’ll no longer be able to upgrade or delete your team, change team settings, or remove invited and existing users.")):(s=g("Remove admin permissions for %(user_name)s").format({user_name:this.props.targetUser.display_name}),t=b(g("%(user_name)s won’t be able to manage team settings, remove and un-invite users, or upgrade the team to <businessLink>%(trademark_business)s</businessLink>. Are you sure you want to continue?"),{user_name:this.props.targetUser.display_name,trademark_business:h,businessLink:f.a({href:"/business"})})),e.createElement(m,{title:s,acceptButtonText:g("Confirm"),dismissButtonText:g("Cancel"),submitting:this.state.submitting,autoClose:!1,onAccept:this.onAccept},f.div({},t))}}),d=e.createClass({displayName:"RemoveLimitedAdminWarningModal",render:function(){return e.createElement(m,{title:g("You must give admin permissions to someone else"),acceptButtonText:g("I understand"),submitting:!1,autoClose:!0
},g("In order to remove your admin permissions, you must first give admin permissions to someone else on your team. You can do this by clicking the gear icon to the right of a team member’s name and selecting “Give admin permissions”."))}}),{GiveLimitedAdminModal:p,RemoveLimitedAdminModal:c,RemoveLimitedAdminWarningModal:d}})}.call(this),function(){define("modules/clean/teams/notes_link_policy_select",["external/react","modules/core/i18n","modules/clean/react/select","modules/clean/teams/constants"],function(e,t,s,r){var o,n,i,a,u,l,p;return a=t._,i=r.NOTES_LINK_POLICY_VALUES,n=r.NOTES_LINK_POLICY_LABELS,u=e.createElement,l=e.DOM,p=e.PropTypes,o=[i.TEAM,i.PUBLIC],e.createClass({displayName:"NotesLinkPolicySelect",propTypes:{teamDomain:p.string.isRequired,defaultValue:p.oneOf(o).isRequired,valueLink:p.shape({value:p.oneOf(o).isRequired,requestChange:p.func.isRequired}),onChange:p.func},render:function(){var e;return l.div({className:"notes-link-policy-select"},l.div({className:"notes-link-policy-select__label-wrapper"},l.label({className:"notes-link-policy-select__label"},a("Who do you want to be able to open links to Paper docs by default?"))),u(s.input,{className:"notes-link-policy-select__select","disable-errors":!0,defaultValue:this.props.defaultValue,valueLink:this.props.valueLink,onChange:this.props.onChange},(function(){var t,r,i;for(i=[],t=0,r=o.length;t<r;t++)e=o[t],i.push(u(s.option,{value:e,key:e},n[e]));return i})()))}})})}.call(this),function(){define("modules/clean/teams/sign_up_for_team/desktop_client_install_modal",["external/react","jquery","modules/core/i18n","modules/core/browser","modules/core/uri","modules/clean/ajax","modules/clean/react/button","modules/clean/react/modal","modules/clean/react_format"],function(e,t,s,r,o,n,i,a,u){var l,p,m,c,d,h,g,f,_;return c=s._,m=n.WebRequest,d=i.button,p=a.Modal,_=u.reactFormat,g=e.DOM,h=e.createElement,f=e.PropTypes,l=e.createClass({displayName:"DesktopClientInstallModal",propTypes:{installPageInformation:f.object,unmountCallback:f.func,teamName:f.string},componentWillUnmount:function(){if(this.props.unmountCallback)return this.props.unmountCallback()},downloadClicked:function(e){return m({url:"/team_sign_up/log_event",data:{event:"onboarding_clicked_install_client"}}),r.redirect(e)},onlineURI:function(){return o({path:"/downloading",query:{os:this.props.installPageInformation.os}})},versionNo:function(){var e,t;return e=function(){switch(this.props.installPageInformation.os){case"lnx":return"Linux";case"win":return"Windows";case"mac":return"Mac"}}.call(this),t=this.props.installPageInformation.buildNo,c("%(client_version_number)s for %(platform)s",{comment:'version_number looks like "2.10.3", platform is "Windows" or "Mac" or "Linux"'}).format({client_version_number:t,platform:e})},renderTitle:function(){return g.h1({className:"desktop-client-install-modal__title u-mar-top-xl u-mar-bottom-m"},c("Download the Dropbox desktop app"))},renderText:function(){return g.p({className:"desktop-client-install-modal__text"},c("Get easy access to %(team)s files, right from your desktop").format({team:this.props.teamName}))},renderButton:function(){return h(d,{className:"desktop-client-install-modal__button u-mar-bottom-s",variant:"big",onClick:this.downloadClicked.bind(this,this.onlineURI())},c("Download for free"))},renderVersionNo:function(){return g.p({className:"desktop-client-install-modal__version-no u-mar-bottom-l u-font-meta"},this.versionNo())},renderOfflineLink:function(){return _(c("Or download the <installerLink>Offline Installer</installerLink>"),{installerLink:g.a({className:"desktop-client-install-modal__offline-install-link",href:"#"})})},render:function(){return h(p,{className:"desktop-client-install-modal",style:"clean",width:720,buttonComponent:g.span(),ref:"desktop-client-modal"},this.renderTitle(),this.renderText(),this.renderButton())}}),{DesktopClientInstallModal:l}})}.call(this),function(){define("modules/clean/teams/team_page",["jquery","external/classnames","external/react","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri","modules/core/user_i18n","modules/clean/ajax","modules/clean/analytics","modules/clean/components/loading_indicator","modules/clean/pagelet_logger","modules/clean/react/sprite","modules/clean/react/bubble_menu","modules/clean/react/table","modules/clean/react/title_bubble","modules/clean/avatar/avatar_with_default","modules/clean/avatar/group_avatar","modules/clean/avatar/initials_avatar_with_color","modules/clean/react/button","modules/clean/react/dbox_app_promo","modules/clean/static_urls","modules/clean/teams/constants","modules/clean/web_timing_logger","modules/clean/viewer","modules/clean/deferred_loader","require"],function(e,t,s,r,o,n,i,a,u,l,p,m,c,d,h,g,f,_,b,v,w,y,M,C,T,N,S){var A,D,R,E,G,P,k,I,x,L,O,q,U,j,B,F,H,J,W;return q=o._,x=l.TeamsWebActionsLogger,k=m.PageletLogger,R=d.BubbleMenu,E=d.BubbleMenuItem,D=w.Actionable,W=y.static_url,P=M.JOIN_STATES,L=M.USER_TYPES,G=M.JOIN_REQUEST_STATUS,A=M.ADMIN_ONBOARDING_STATES,F=N.deferredLoader,B=s.DOM,j=s.createElement,J=e.extend({},s.PropTypes),O={},O[L.PENDING_TEAM_ADMIN]=q("Team Admin"),O[L.PENDING_ACCOUNTS_ADMIN]=q("User Management Admin"),O[L.PENDING_SUPPORT_ADMIN]=q("Support Admin"),O[L.PENDING_MEMBER]=q("Member"),O[L.TEAM_ADMIN]=q("Team Admin"),O[L.ACCOUNTS_ADMIN]=q("User Management Admin"),O[L.SUPPORT_ADMIN]=q("Support Admin"),O[L.MEMBER]=q("Member"),O[L.SUSPENDED]=q("Suspended"),O[L.REMOVED]=q("Removed"),U=function(e,t){var s,r,o;r={};for(o in e)s=e[o],r[o]=s.bind(t);return r},H=function(e){return e.team_join_state===P.ACTIVE},I=s.createClass({displayName:"TeamPage",pageletLogger:new k("team",["TeamPage"]),propTypes:{members:J.array,totalMembers:J.number,totalRows:J.number,numJoinRequests:J.number,teamName:J.string,teamFullName:J.string,teamDomain:J.string,teamFolderPathName:J.string,teamRequestMembershipPolicy:J.number,isLimitedTeam:J.bool,notesLinkPolicy:J.number,canInviteMembers:J.bool,canManageTeamMembership:J.bool,canSuggestMembers:J.bool,canAccessAdminConsole:J.bool,canDeleteTeam:J.bool,canChangeTeamName:J.bool,canHaveAdminUi:J.bool,canSetTeamRequestMembershipPolicy:J.bool,canSetNotesLinkPolicy:J.bool,canHaveLimitedAdminSettings:J.bool,canManageLimitedAdmins:J.bool,viewerIsSoleAdmin:J.bool,hasSettingsDialog:J.bool,inviteMemberEmails:J.arrayOf(J.string),openInviteModal:J.bool,openSettingsModal:J.bool,openSuggestMembersModal:J.bool,adminOnboardingState:J.number,teamMembersLimit:J.number,mergedMembersAndGroups:J.bool,groupsTabFirst:J.bool,showUpsellVariant:J.bool,viewer:J.instanceOf(T),installPageInformation:J.object,showClientInstallModalAfterOnboarding:J.bool,isMaestroDesign:J.bool,infiniteScroll:J.bool,teamIsCdm:J.bool,fetchDataStormcrowOn:J.bool},getDefaultProps:function(){return{viewer:T.get_viewer(),showClientInstallModalAfterOnboarding:!1,isMaestroDesign:!1}},getInitialState:function(){return{totalMembersListLength:this.props.totalMembers,numJoinRequests:this.props.numJoinRequests,visibleMembers:this.props.members,managedUser:null,onboardingState:this.props.adminOnboardingState+1,showTable:!1}},_renderStorageUsed:function(e){var s,r,o;return this.props.isMaestroDesign&&null!=e.used_raw_bytes&&null!=e.quota_raw_bytes?(r=Math.round(100*e.used_raw_bytes/e.quota_raw_bytes),o=q("%(percent_used)s%").format({percent_used:r}),s=q("%(storage_used)s of %(quota)s used"),B.div({className:t("member-storage-used",{"over-quota-member":r>=100,"near-quota-member":r>=90&&r<100})},r>=90?B.span({className:"quota-alert"},String.fromCharCode("8226")):void 0,j(g,{content:s.format({storage_used:e.storage_used,quota:e.quota}),position:g.POSITIONS.BOTTOM,distanceFromTarget:8},B.div({},o)))):e.storage_used||"-"},columnTypes:{displayName:function(e,t,s){return{field:"display_name_lower",header:q("Name"),classes:{"display-name-column":!0},width:e,render:(function(e){return function(r){var o,n,i,u;return r.is_group?(n=r,[B.div({className:"avatar-wrapper"},j(_,{group:n,dimension:t,optionalClass:s})),B.div({className:"user-info"},B.p({className:"user-info__text"},n.display_name),B.p({className:"user-info__subtext"},n.is_team_group||n.is_admin_managed?e.props.teamName:n.owner_display_names.length<1?"":(i=n.owner_display_names[0],1===n.user_count?i:q("%(name)s and %(other_member_count)s more").format({name:i,other_member_count:n.user_count-1}))))]):(u=r,o=j(f,{dimension:t,photoUrl:u.account_photo_url,optionalClass:s,defaultAvatar:j(b,{dimension:t,name:u.display_name||u.email,initials:a.getInitials(u.display_name||u.email),shape:"CIRCLE",optionalClass:s})}),e.props.isMaestroDesign?[B.div({className:"avatar-wrapper"},o),B.div({className:"user-info"},B.p({className:"user-info__text"},u.display_name||q("Invited")),B.p({className:"user-info__subtext"},u.email))]:B.span({},o,B.span({className:"user-name"},u.display_name||q("Invited")),B.span({className:"user-email"},u.email)))}})(this)}},userType:function(e){return{field:"user_type",header:q("Status"),width:e,render:(function(e){return function(t){return B.span({className:"member-user-type"},function(){if(t.is_group)return q("Group");if(!this.props.isLimitedTeam&&!this.props.mergedMembersAndGroups)return O[t.user_type];if(t.is_admin)return q("Admin");if(t.join_request_status)switch(t.join_request_status){case G.PENDING:return q("Pending member");case G.APPROVED:return q("Approved")}else switch(t.team_join_state){case P.ACTIVE:return q("Member");case P.PENDING:return q("Invited");case P.SUSPENDED:return q("Suspended");case P.REMOVED:return q("Removed");default:return q("Invalid")}}.call(e))}})(this)}},storageUsed:function(e){var t;return t=q(this.props.isMaestroDesign?this.props.teamIsCdm?"Member folder usage":"Space used":"Usage"),{field:"storage_used",header:t,width:e,classes:{"storage-used-column":!0},initialSortDir:h.DESC_DIR,render:this._renderStorageUsed}},approveUser:function(e){return{width:e,classes:{"approve-request-column":!0},sortable:!1,render:(function(e){return function(t){var s;return s=t.join_request_status===G.PENDING,s&&e.props.canManageTeamMembership?j(D,{handler:e.onApproveRequest.bind(e,t)},j(v.button,{importance:"primary",className:"action-button approve-button"},q("Approve"))):""}})(this)}},adminManagement:function(e){return{width:e,classes:{"limited-admin-management-col":!0},sortable:!1,render:(function(e){return function(t){return t.is_group?"":e.props.canHaveLimitedAdminSettings?e.adminGear(t):e.removeUserButton(t)}})(this)}},joinedDate:function(e){return{field:"team_joined_utc_ts",header:q("Joined"),width:e,render:(function(e){return function(e){return e.joined||"—"}})(this)}},joinGroup:function(e){return{width:e,classes:{"join-group-col":!0},sortable:!1,render:(function(e){return function(t){var s;return!t.is_group||t.is_group_member||e.props.canHaveAdminUi||0===t.owner_display_names.length?"":(s=t.pending_group_req,s?B.button({className:"button-secondary button-small pending-group-button",disabled:!0},q("Membership pending")):B.button({className:"button-secondary button-small join-group-button",onClick:e.onClickJoinGroup.bind(e,t),disabled:s},q("Ask to join")))}})(this)}}},adminGear:function(e){var s,r,o;return this.props.isMaestroDesign?(s=String.fromCharCode("176"),r=B.button({className:t("limited-admin-settings-button",{"menu-open-for-button":this.state.managedUser===e})},s+s+s)):r=B.button({className:"limited-admin-settings-button"},j(c,{group:"web",name:"gear",alt:q("Member settings")})),o=[],e.user_id===this.props.viewer.work_user.id?this.props.canManageLimitedAdmins&&o.push(j(E,{onClick:this.onRemoveAdminPermission.bind(this,e)},q("Remove my admin permissions"))):(this.props.canManageTeamMembership&&o.push(j(E,{onClick:this.onRemoveMember.bind(this,e)},q("Remove member"))),this.props.canManageLimitedAdmins&&H(e)&&(e.is_admin?o.push(j(E,{onClick:this.onRemoveAdminPermission.bind(this,e)},q("Remove admin permissions"))):o.push(j(E,{onClick:this.onGiveAdminPermission.bind(this,e)},q("Make admin"))))),j(R,{position:R.POSITIONS.BOTTOM_LEFT,targetButton:r,items:o,shouldShowArrow:!1,verticalDisplacement:-4,onShowDropdown:(function(t){return function(){return t.setState({managedUser:e})}})(this),onHideDropdown:(function(e){return function(){return e.setState({managedUser:null})}})(this)})},removeUserButton:function(e){return e.user_id!==this.props.viewer.work_user.id&&this.props.canManageTeamMembership?B.a({className:"remove-user-button",onClick:this.onRemoveMember.bind(this,e)},B.img({src:"/static/images/x-vflYKfRuL.png"})):""},checkTTI:function(){if(!this.props.groupsTabFirst)return 0!==this.state.totalMembersListLength?this.pageletLogger.componentReady(this.constructor.displayName):void 0},componentWillMount:function(){var e,t;return this.columnTypes=U(this.columnTypes,this),this.props.fetchDataStormcrowOn&&this.props.groupsTabFirst?C.waitForTTI().then((function(e){return function(){return e.setState({showTable:!0})}})(this)):window.__REGISTER_TEAM_MEMBERS_PRELOAD_HANDLER?(t=(function(e){return function(t){var s;try{return s=JSON.parse(t),e.props.mergedMembersAndGroups&&C.log_js_modules_fetched_data_required_for_tti(),e.onTeamMembersUpdated(s.members,s.total_members,s.num_join_requests)}catch(e){return e,n.error(q("An error occured. Please reload the page."))}}})(this),e=function(){return n.error(q("An error occured. Please reload the page."))},window.__REGISTER_TEAM_MEMBERS_PRELOAD_HANDLER(t,e)):void 0},componentDidMount:function(){return this.checkTTI(),this.props.openInviteModal?this.showInviteModal(this.props.inviteMemberEmails):this.props.openSettingsModal?this.showSettingsModal():this.props.openSuggestMembersModal&&this.showSuggestMembersModal(),C.waitForTTI().then((function(e){return function(){if(!e.state.modalsLoaded)return e.setState({modalsLoaded:!0}),S(["modules/clean/react/modal","modules/clean/teams/limited_team_invite_modal","modules/clean/contacts/contact","modules/clean/contacts/types","modules/clean/teams/limited_team_settings_modal","modules/clean/teams/modals/remove_member_modal","modules/clean/teams/modals/leave_team_modal","modules/clean/teams/suggest_invites_modal","modules/clean/teams/sign_up_for_team/desktop_client_install_modal","modules/clean/teams/modals/set_limited_admin_modals","modules/clean/teams/limited_team_tooltips"],function(t,s,r,o,n,i,a,u,l,p,m){var c,d,h,g,f,_,b,v;return f=t.Modal,c=r.Contact,v=i.RemoveMemberModal,g=a.LeaveTeamModal,d=l.DesktopClientInstallModal,h=p.GiveLimitedAdminModal,_=p.RemoveLimitedAdminModal,b=p.RemoveLimitedAdminWarningModal,F.setItems({Modal:f,LimitedTeamInviteModal:s,Contact:c,ContactTypes:o,LimitedTeamSettingsModal:n,RemoveMemberModal:v,LeaveTeamModal:g,SuggestInvitesModal:u,DesktopClientInstallModal:d,GiveLimitedAdminModal:h,RemoveLimitedAdminModal:_,RemoveLimitedAdminWarningModal:b}),e.setState({LimitedTeamTooltipsElement:m})})}})(this))},componentDidUpdate:function(){return this.checkTTI()},tableRowClasses:function(e){return this.props.isMaestroDesign?e.is_group?this.props.canHaveAdminUi||e.is_group_member?{"clickable-group-row":!0}:{}:e.join_request_status===G.PENDING?{"pending-member-row":!0}:{}:{}},renderMemberTable:function(){var e,t,s,r,o;return this.props.isMaestroDesign?(t=32,e="u-mar-left-s u-mar-right-s"):(t=24,e="u-mar-right-xs"),s=this.props.isLimitedTeam?this.props.isMaestroDesign?this.props.canManageTeamMembership?[this.columnTypes.displayName("40%",t,e),this.columnTypes.userType("19%"),this.columnTypes.storageUsed("16%"),this.columnTypes.approveUser("15%"),this.columnTypes.adminManagement("10%")]:[this.columnTypes.displayName("50%",t,e),this.columnTypes.userType("22%"),this.columnTypes.joinGroup("28%")]:[this.columnTypes.displayName(390,t,e),this.columnTypes.userType(170),this.columnTypes.storageUsed(90),this.columnTypes.approveUser(98),this.columnTypes.adminManagement(50)]:this.props.isMaestroDesign?[this.columnTypes.displayName("50%",t,e),this.columnTypes.userType("20%"),this.columnTypes.joinGroup("30%")]:[this.columnTypes.displayName(400,t,e),this.columnTypes.userType(200),this.columnTypes.joinedDate(200)],this.props.fetchDataStormcrowOn?(r=void 0,o=this.state.showTable,this.props.groupsTabFirst||0!==this.state.totalMembersListLength&&(o=!0,r={rows:this.state.visibleMembers,total:this.state.totalMembersListLength}),o?j(h,{ref:"members",columns:s,initialData:r,initialSortColumn:1,rowsPerPage:20,emptyMessage:q("No members here"),isMaestroDesign:this.props.isMaestroDesign,infiniteScroll:this.props.infiniteScroll,rowsPerRequestForInfiniteScroll:50,classes:{"grey-style":!0},rowClasses:this.tableRowClasses,paginatorClasses:this.props.isMaestroDesign?"u-mar-top-xs":"",loadingIndicator:W("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),onRowClicked:this.onRowClicked,onRequestData:(function(e){return function(t,s){return u.WebRequest({url:"/team/manage/list",data:{offset:t.offset,limit:t.limit,sort_column:t.sortColumn,sort_direction:t.sortDir,include_groups:e.props.mergedMembersAndGroups?1:void 0},success:function(t){return t=JSON.parse(t),s(null,{rows:t.members,total:t.total_rows}),e.onTeamMembersUpdated(t.members,t.total_members,t.num_join_requests)}})}})(this)}):j(p,{style:p.LoadingIndicatorStyle.BLUE_SPINNER,className:"member-list-loading-spinner"})):0===this.state.totalMembersListLength?j(p,{style:p.LoadingIndicatorStyle.BLUE_SPINNER,className:"member-list-loading-spinner"}):j(h,{ref:"members",columns:s,initialData:{rows:this.state.visibleMembers,total:this.state.totalMembersListLength},initialSortColumn:1,rowsPerPage:20,emptyMessage:q("No members here"),isMaestroDesign:this.props.isMaestroDesign,infiniteScroll:this.props.infiniteScroll,rowsPerRequestForInfiniteScroll:50,classes:{"grey-style":!0},rowClasses:this.tableRowClasses,paginatorClasses:this.props.isMaestroDesign?"u-mar-top-xs":"",loadingIndicator:W("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),onRowClicked:this.onRowClicked,onRequestData:(function(e){return function(t,s){return u.WebRequest({url:"/team/manage/list",data:{offset:t.offset,limit:t.limit,sort_column:t.sortColumn,sort_direction:t.sortDir,include_groups:e.props.mergedMembersAndGroups?1:void 0},success:function(t){return t=JSON.parse(t),s(null,{rows:t.members,total:t.total_rows}),e.onTeamMembersUpdated(t.members,t.total_members,t.num_join_requests)}})}})(this)})},onRemoveMember:function(e){var t;return e.user_id===this.props.viewer.work_user.id?(t=F.getResolvedItems(["Modal","LeaveTeamModal"]),t.promise.then((function(e){return function(t){var s,r;return r=t.Modal,s=t.LeaveTeamModal,r.showInstance(j(s,{teamName:e.props.teamName}))}})(this))):e.join_request_status===G.PENDING?u.WebRequest({url:"/team/join_request/reject",data:{user_id:e.user_id},success:(function(e){return function(){return n.success(q("Membership request removed.")),e.refs.members.forceRefresh()}})(this)}):(t=F.getResolvedItems(["Modal","RemoveMemberModal"]),t.promise.then((function(t){return function(s){var o,n;return o=s.Modal,n=s.RemoveMemberModal,o.showInstance(j(n,{teamName:t.props.teamName,showUpsellVariant:t.props.showUpsellVariant,user:e,onRemoved:function(){return r.reload()}}))}})(this)))},onGiveAdminPermission:function(e){var t;return t=F.getResolvedItems(["Modal","GiveLimitedAdminModal"]),t.promise.then((function(t){return function(s){var o,n;return n=s.Modal,o=s.GiveLimitedAdminModal,n.showInstance(j(o,{targetUser:e,teamId:t.props.viewer.team_id,onSuccess:function(){return r.reload()}}))}})(this))},onRemoveAdminPermission:function(e){var t;return this.props.viewerIsSoleAdmin?(t=F.getResolvedItems(["Modal","RemoveLimitedAdminWarningModal"]),t.promise.then(function(e){var t,s;return t=e.Modal,s=e.RemoveLimitedAdminWarningModal,t.showInstance(j(s))})):(t=F.getResolvedItems(["Modal","RemoveLimitedAdminModal"]),t.promise.then((function(t){return function(s){var o,n,i;return o=s.Modal,n=s.RemoveLimitedAdminModal,i=t.props.viewer.work_user.id===e.user_id,o.showInstance(j(n,{targetUser:e,teamId:t.props.viewer.team_id,removingOwnPermissions:i,onSuccess:function(){return r.reload()}}))}})(this)))},onApproveRequest:function(e){return u.WebRequest({url:"/team/join_request/approve",data:{user_id:e.user_id},success:(function(e){return function(){return n.success(q("Membership request approved.")),e.refs.members.forceRefresh()}})(this)})},onInviteClicked:function(){return x.log("clicked_invite_members_cta",{},null,null,!1,x.LOG_CATEGORY.TEAM_INFO),this.showInviteModal()},onSuggestMembersClicked:function(){return x.log("clicked_suggest_members_cta"),this.showSuggestMembersModal()},onUpdateSettingsClicked:function(){return this.showSettingsModal()},onRowClicked:function(e){if(e.is_group&&(this.props.canHaveAdminUi||e.is_group_member))return window.location.hash="groups/"+e.group_id},onClickJoinGroup:function(e,t){return t.stopPropagation(),u.WebRequest({url:"/groups_ajax/make_group_join_request",data:{group_id:e.group_id},subject_user:this.props.viewer.work_user,success:(function(t){return function(){return e.pending_group_req=!0,t.forceUpdate(),n.success(q("Request sent."))}})(this)})},showInviteModal:function(e){var t,s;return null==e&&(e=[]),this.props.isLimitedTeam?(t=F.getResolvedItems(["Modal","LimitedTeamInviteModal","Contact","ContactTypes"]),t.promise.then((function(t){return function(s){var r,o,n,i;return i=s.Modal,n=s.LimitedTeamInviteModal,r=s.Contact,o=s.ContactTypes,i.showInstance(j(n,{onInvited:function(){return t.refs.members.forceRefresh()},populatedContacts:e.map(function(e){return new r({type:o.EMAIL,email:e})}),maxTeamSize:t.props.teamMembersLimit}))}})(this))):(s={},e.length>0&&btoa?s.invite_emails=btoa(e.join(",")):s.show_invite_members=1,r.redirect(i({path:"/team/admin/members",query:s})))},showSettingsModal:function(){var e;return e=F.getResolvedItems(["Modal","LimitedTeamSettingsModal"]),e.promise.then((function(e){return function(t){var s,r;return r=t.Modal,s=t.LimitedTeamSettingsModal,r.showInstance(j(s,{canChangeTeamName:e.props.canChangeTeamName,canDeleteTeam:e.props.canDeleteTeam,canSetTeamRequestMembershipPolicy:e.props.canSetTeamRequestMembershipPolicy,canChangeNotesLinkPolicy:e.props.canSetNotesLinkPolicy,teamDomain:e.props.teamDomain,teamId:e.props.viewer.team_id,initialTeamName:e.props.teamName,initialTeamFullName:e.props.teamFullName,initialTeamRequestMembershipPolicy:e.props.teamRequestMembershipPolicy,initialNotesLinkPolicy:e.props.notesLinkPolicy}))}})(this))},showSuggestMembersModal:function(){var e;return e=F.getResolvedItems(["Modal","SuggestInvitesModal"]),e.promise.then(function(e){var t,s;return t=e.Modal,s=e.SuggestInvitesModal,t.showInstance(j(s))})},onTeamMembersUpdated:function(e,t,s){return this.setState({totalMembersListLength:t,numJoinRequests:s,visibleMembers:e})},numRemainingInvites:function(){return this.props.teamMembersLimit-(this.state.totalMembersListLength-this.state.numJoinRequests)},forceRefresh:function(){return this.refs.members.forceRefresh()},onLastTooltipDismissed:function(e){var t;if(this.setState({onboardingState:e}),this.props.showClientInstallModalAfterOnboarding)return t=F.getResolvedItems(["Modal","DesktopClientInstallModal"]),t.promise.then((function(e){return function(t){var s,r;return r=t.Modal,s=t.DesktopClientInstallModal,r.showInstance(j(s,{installPageInformation:e.props.installPageInformation,teamName:e.props.teamName}))}})(this))},renderTooltips:function(){var e;if(A.TEAM_TAB_TOOLTIP<(e=this.state.onboardingState)&&e<A.DONE&&this.state.LimitedTeamTooltipsElement)return j(this.state.LimitedTeamTooltipsElement,{onboardingState:this.state.onboardingState,lastTooltipDismissedCb:this.onLastTooltipDismissed,showPaperInNewTab:!this.props.showClientInstallModalAfterOnboarding})},render:function(){return B.div({className:t("members-page",{"u-mar-top-l":this.props.isMaestroDesign})},this.props.isMaestroDesign?void 0:[B.div({className:"page-heading-buttons",key:"page-heading-buttons"},this.props.canInviteMembers?B.button({className:"button-primary action-button invite-button",onClick:this.onInviteClicked},q("Invite members")):this.props.canSuggestMembers?B.button({className:"button-primary action-button",onClick:this.onSuggestMembersClicked},q("Suggest team members")):void 0,this.props.hasSettingsDialog?B.button({className:"button-tertiary action-button settings-button",onClick:this.onUpdateSettingsClicked},q("Settings")):void 0,this.props.canAccessAdminConsole?B.button({className:"button-tertiary action-button",onClick:function(){return r.redirect("/team/admin/members")}},q("Manage")):void 0),B.div({className:"page-description",key:"page-description"},q("All your %(team_name)s team members.").format({team_name:this.props.teamName}))],this.renderMemberTable(),this.renderTooltips())}}),{TeamPage:I}})}.call(this);
//# sourceMappingURL=pkg-legacy-aj.min.js-vflxrusmN.map